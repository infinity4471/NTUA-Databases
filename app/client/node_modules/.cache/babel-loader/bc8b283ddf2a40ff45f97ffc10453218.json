{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nimport * as React from 'react';\nimport * as PropTypes from 'prop-types';\nimport { classNames, Keys, guid } from '@progress/kendo-react-common';\nimport { FloatingLabel } from '@progress/kendo-react-labels';\nimport ListContainer from '../common/ListContainer';\nimport List from '../common/List';\nimport TagList from './TagList';\nimport SearchBar from '../common/SearchBar';\nimport DropDownBase from '../common/DropDownBase';\nimport { ActiveDescendant } from './../common/settings';\nimport { itemIndexStartsWith, getItemValue, areSame, matchDataCollections, removeDataItems, isPresent, preventDefaultNonInputs } from '../common/utils';\nvar VALIDATION_MESSAGE = 'Please enter a valid value!';\n\nvar preventDefault = function (event) {\n  return event.preventDefault();\n};\n\nvar matchTags = function (tag1, tag2, key) {\n  if (!!tag1 !== !!tag2 || tag1.text !== tag2.text) {\n    return false;\n  }\n\n  return tag1 === tag2 || matchDataCollections(tag1.data, tag2.data, key);\n};\n\nvar isCustom = function (type) {\n  return type === FocusedItemType.CustomItem;\n};\n\nvar FocusedItemType;\n\n(function (FocusedItemType) {\n  FocusedItemType[FocusedItemType[\"None\"] = 0] = \"None\";\n  FocusedItemType[FocusedItemType[\"ListItem\"] = 1] = \"ListItem\";\n  FocusedItemType[FocusedItemType[\"CustomItem\"] = 2] = \"CustomItem\";\n})(FocusedItemType || (FocusedItemType = {}));\n/**\n * Represents the [KendoReact MultiSelect component]({% slug overview_multiselect %}).\n *\n * @example\n * ```jsx\n * class App extends React.Component {\n *    multiselect = null;\n *    render() {\n *       return (\n *          <div>\n *              <MultiSelect\n *                  data={[ \"Albania\", \"Andorra\", \"Austria\", \"Belarus\" ]}\n *                  ref={component => this.multiselect = component}\n *              />\n *              <button onClick={() => alert(this.multiselect.value)}>alert value</button>\n *          </div>\n *       );\n *    }\n * }\n * ReactDOM.render(<App />, document.querySelector('my-app'));\n * ```\n */\n\n\nvar MultiSelect =\n/** @class */\nfunction (_super) {\n  __extends(MultiSelect, _super);\n\n  function MultiSelect() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n    /**\n     * @hidden\n     */\n\n\n    _this.state = {\n      activedescendant: ActiveDescendant.PopupList\n    };\n    _this._valueItemsDuringOnChange = null;\n    _this._inputId = guid();\n    _this.base = new DropDownBase(_this);\n    _this._tags = [];\n    _this._skipFocusEvent = false;\n    /**\n     * @hidden\n     */\n\n    _this.focus = function () {\n      if (_this._input) {\n        _this._input.focus();\n      }\n    };\n    /**\n     * @hidden\n     */\n\n\n    _this.handleItemSelect = function (index, state) {\n      var _a = _this.props,\n          _b = _a.data,\n          data = _b === void 0 ? [] : _b,\n          dataItemKey = _a.dataItemKey,\n          virtual = _a.virtual;\n      var skip = virtual ? virtual.skip : 0;\n      var dataItem = data[index - skip];\n\n      var indexInValue = _this.value.findIndex(function (i) {\n        return areSame(i, dataItem, dataItemKey);\n      });\n\n      var newItems = [];\n\n      if (indexInValue !== -1) {\n        // item is already selected\n        newItems = _this.value;\n        newItems.splice(indexInValue, 1);\n      } else {\n        newItems = _this.value.concat([dataItem]);\n      }\n\n      var text = _this.props.filter !== undefined ? _this.props.filter : _this.state.text;\n\n      if (text) {\n        if (_this.state.text) {\n          state.data.text = '';\n        }\n\n        _this.base.filterChanged('', state);\n      }\n\n      if (_this.state.focusedIndex !== undefined) {\n        state.data.focusedIndex = undefined;\n      }\n\n      _this.triggerOnChange(newItems, state);\n\n      _this.base.triggerPageChangeCornerItems(dataItem, state);\n    };\n    /**\n     * @hidden\n     */\n\n\n    _this.onTagDelete = function (itemsToRemove, event) {\n      var opened = _this.props.opened !== undefined ? _this.props.opened : _this.state.opened;\n\n      var state = _this.base.initState();\n\n      state.syntheticEvent = event;\n\n      if (opened) {\n        _this.base.togglePopup(state);\n      }\n\n      if (!_this.state.focused) {\n        state.data.focused = true;\n      }\n\n      var selected = _this.value;\n      removeDataItems(selected, itemsToRemove, _this.props.dataItemKey);\n\n      _this.triggerOnChange(selected, state);\n\n      _this.applyState(state);\n    };\n    /**\n     * @hidden\n     */\n\n\n    _this.itemFocus = function (index, state) {\n      var _a = _this.props,\n          _b = _a.data,\n          data = _b === void 0 ? [] : _b,\n          allowCustom = _a.allowCustom,\n          virtual = _a.virtual;\n      var skip = virtual ? virtual.skip : 0;\n      var text = _this.props.filter !== undefined ? _this.props.filter : _this.state.text;\n\n      var focusedIndex = _this.getFocusedState().focusedIndex;\n\n      var customItem = allowCustom && text;\n      var nextFocusedItem = data[index - skip];\n\n      if (nextFocusedItem && focusedIndex !== index) {\n        if (_this.state.focusedIndex !== index) {\n          state.data.focusedIndex = index;\n          state.data.activedescendant = ActiveDescendant.PopupList;\n        }\n      } else if (customItem && index === -1) {\n        if (_this.state.focusedIndex !== undefined) {\n          state.data.focusedIndex = undefined;\n        }\n      }\n\n      _this.base.triggerPageChangeCornerItems(nextFocusedItem, state);\n    };\n\n    _this.searchbarRef = function (searchbar) {\n      var input = _this._input = searchbar && searchbar.input;\n\n      if (input && _this.state.focused) {\n        setTimeout(function () {\n          return input.focus();\n        }, 0);\n      }\n    };\n\n    _this.onChangeHandler = function (event) {\n      var state = _this.base.initState();\n\n      var value = event.currentTarget.value;\n      var opened = _this.props.opened !== undefined ? _this.props.opened : _this.state.opened;\n      state.syntheticEvent = event;\n\n      if (_this.props.filter === undefined) {\n        state.data.text = value;\n      }\n\n      state.data.focusedIndex = undefined;\n\n      if (!opened) {\n        _this.base.togglePopup(state);\n      }\n\n      _this.base.filterChanged(value, state);\n\n      _this.applyState(state);\n    };\n\n    _this.clearButtonClick = function (event) {\n      var opened = _this.props.opened !== undefined ? _this.props.opened : _this.state.opened;\n\n      var state = _this.base.initState();\n\n      state.syntheticEvent = event;\n      event.stopPropagation();\n\n      if (_this.value.length > 0) {\n        _this.triggerOnChange([], state);\n      }\n\n      if (_this.state.focusedIndex !== undefined) {\n        state.data.focusedIndex = undefined;\n      }\n\n      if (opened) {\n        _this.base.togglePopup(state);\n      }\n\n      var text = _this.props.filter !== undefined ? _this.props.filter : _this.state.text;\n\n      if (isPresent(text) && text !== '') {\n        _this.base.filterChanged('', state);\n      }\n\n      if (_this.state.text) {\n        state.data.text = '';\n      }\n\n      _this.applyState(state);\n    };\n\n    _this.onInputKeyDown = function (event) {\n      var keyCode = event.keyCode;\n      var text = _this.props.filter !== undefined ? _this.props.filter : _this.state.text;\n      var opened = _this.props.opened !== undefined ? _this.props.opened : _this.state.opened;\n\n      var focusedItem = _this.getFocusedState().focusedItem;\n\n      var state = _this.base.initState();\n\n      state.syntheticEvent = event;\n\n      if (!text && _this.value.length > 0 && (keyCode === Keys.left || keyCode === Keys.right || keyCode === Keys.home || keyCode === Keys.end || keyCode === Keys.delete || keyCode === Keys.backspace)) {\n        return _this.onTagsNavigate(event, state);\n      }\n\n      var togglePopup = function () {\n        event.preventDefault();\n\n        _this.base.togglePopup(state);\n\n        _this.applyState(state);\n      };\n\n      if (opened) {\n        if (event.altKey && keyCode === Keys.up) {\n          togglePopup();\n        } else if (keyCode === Keys.up || keyCode === Keys.down) {\n          event.preventDefault();\n\n          _this.onNavigate(state, keyCode);\n        } else if (keyCode === Keys.enter) {\n          event.preventDefault();\n\n          if (_this.props.allowCustom && text && focusedItem === null) {\n            _this.customItemSelect(event);\n          } else {\n            _this.selectFocusedItem(event);\n          }\n        } else if (keyCode === Keys.esc) {\n          togglePopup();\n        }\n      } else if (event.altKey && keyCode === Keys.down) {\n        togglePopup();\n      }\n    };\n\n    _this.renderListContainer = function () {\n      var base = _this.base;\n      var _a = _this.props,\n          header = _a.header,\n          footer = _a.footer,\n          allowCustom = _a.allowCustom,\n          dir = _a.dir;\n\n      var popupSettings = _this.base.getPopupSettings();\n\n      var opened = _this.props.opened !== undefined ? _this.props.opened : _this.state.opened;\n      var text = _this.props.filter !== undefined ? _this.props.filter : _this.state.text;\n      var virtual = _this.props.virtual !== undefined;\n      var popupWidth = popupSettings.width !== undefined ? popupSettings.width : base.popupWidth;\n      var listContainerProps = {\n        onMouseDown: preventDefault,\n        dir: dir !== undefined ? dir : base.dirCalculated,\n        onBlur: _this.handleBlur,\n        width: popupWidth,\n        popupSettings: {\n          className: classNames('k-list-container k-reset', popupSettings.className),\n          animate: popupSettings.animate,\n          anchor: _this.element || undefined,\n          show: opened,\n          open: _this.onPopupOpened,\n          close: _this.onPopupClosed,\n          appendTo: popupSettings.appendTo\n        }\n      };\n\n      var focusedType = _this.getFocusedState().focusedType;\n\n      var customItem = allowCustom && text && React.createElement(\"div\", {\n        className: \"k-list\",\n        key: \"customitem\",\n        onClick: _this.customItemSelect\n      }, React.createElement(\"div\", {\n        className: classNames('k-item k-custom-item', {\n          'k-state-focused': isCustom(focusedType)\n        })\n      }, text, React.createElement(\"span\", {\n        className: \"k-icon k-i-plus\",\n        style: {\n          float: 'right'\n        }\n      })));\n      return React.createElement(ListContainer, __assign({}, listContainerProps), virtual && header, _this.base.renderScrollWrapper(React.createElement(React.Fragment, null, !virtual && header, customItem, _this.renderList(), !virtual && footer, _this.base.renderScrollElement())), virtual && footer);\n    };\n\n    _this.renderList = function () {\n      var _a = _this.props,\n          _b = _a.data,\n          data = _b === void 0 ? [] : _b,\n          textField = _a.textField,\n          listNoDataRender = _a.listNoDataRender,\n          itemRender = _a.itemRender,\n          dataItemKey = _a.dataItemKey,\n          virtual = _a.virtual;\n      var vs = _this.base.vs;\n      var skip = virtual ? virtual.skip : 0;\n      var opened = _this.props.opened !== undefined ? _this.props.opened : _this.state.opened;\n\n      var focusedIndex = _this.getFocusedState().focusedIndex;\n\n      var popupSettings = _this.base.getPopupSettings();\n\n      var translate = \"translateY(\" + vs.translate + \"px)\";\n      return React.createElement(List, {\n        id: _this.base.listBoxId,\n        show: opened,\n        data: data.slice(),\n        focusedIndex: focusedIndex - skip,\n        value: _this.value,\n        textField: textField,\n        valueField: dataItemKey,\n        optionsGuid: _this.base.guid,\n        listRef: function (list) {\n          return vs.list = _this.base.list = list;\n        },\n        wrapperStyle: vs.enabled ? {\n          float: 'left',\n          width: '100%'\n        } : {\n          maxHeight: popupSettings.height\n        },\n        wrapperCssClass: vs.enabled ? undefined : 'k-list-scroller',\n        listStyle: vs.enabled ? {\n          transform: translate\n        } : undefined,\n        key: \"listKey\",\n        skip: skip,\n        onClick: _this.handleItemClick,\n        itemRender: itemRender,\n        noDataRender: listNoDataRender\n      });\n    };\n\n    _this.customItemSelect = function (event) {\n      var _a;\n\n      var itemText = _this.props.filter !== undefined ? _this.props.filter : _this.state.text;\n      var textField = _this.props.textField;\n\n      if (!itemText) {\n        return;\n      }\n\n      var state = _this.base.initState();\n\n      state.syntheticEvent = event;\n      var item = textField ? (_a = {}, _a[textField] = itemText, _a) : itemText;\n\n      if (_this.state.text !== undefined) {\n        state.data.text = '';\n      }\n\n      state.data.focusedIndex = undefined;\n\n      _this.base.filterChanged('', state);\n\n      var newItems = _this.value.concat([item]);\n\n      _this.triggerOnChange(newItems, state);\n\n      _this.base.togglePopup(state);\n\n      _this.applyState(state);\n    };\n\n    _this.handleWrapperClick = function (event) {\n      var opened = _this.props.opened !== undefined ? _this.props.opened : _this.state.opened;\n      var input = _this._input;\n\n      if (!opened && input) {\n        _this.focusElement(input);\n      }\n\n      var state = _this.base.initState();\n\n      state.syntheticEvent = event;\n\n      if (!_this.state.focused) {\n        state.events.push({\n          type: 'onFocus'\n        });\n        state.data.focused = true;\n      }\n\n      _this.base.togglePopup(state);\n\n      _this.applyState(state);\n    };\n\n    _this.handleItemClick = function (index, event) {\n      var state = _this.base.initState();\n\n      state.syntheticEvent = event;\n\n      _this.handleItemSelect(index, state);\n\n      if (_this.props.autoClose) {\n        _this.base.togglePopup(state);\n      }\n\n      _this.applyState(state);\n    };\n\n    _this.handleBlur = function (event) {\n      if (!_this.state.focused || _this._skipFocusEvent) {\n        return;\n      }\n\n      var opened = _this.props.opened !== undefined ? _this.props.opened : _this.state.opened;\n\n      var state = _this.base.initState();\n\n      var _a = _this.props,\n          allowCustom = _a.allowCustom,\n          filterable = _a.filterable;\n      state.syntheticEvent = event;\n      state.data.focused = false;\n      state.events.push({\n        type: 'onBlur'\n      });\n\n      if (opened) {\n        if (_this.state.opened) {\n          state.data.opened = false;\n        }\n\n        state.events.push({\n          type: 'onClose'\n        });\n      }\n\n      if (!allowCustom && !filterable && _this.state.text) {\n        state.data.text = '';\n      }\n\n      _this.applyState(state);\n    };\n\n    _this.handleFocus = function (event) {\n      if (_this._skipFocusEvent) {\n        return;\n      }\n\n      _this.base.handleFocus(event);\n    };\n\n    _this.onPopupOpened = function () {\n      if (_this._input && _this.state.focused) {\n        _this.focusElement(_this._input);\n      }\n    };\n\n    _this.onPopupClosed = function () {\n      if (_this.state.focused) {\n        setTimeout(function () {\n          if (_this.state.focused) {\n            _this.focusElement(_this._input);\n          }\n        }, 0);\n      }\n    };\n\n    _this.setValidity = function () {\n      if (_this._input && _this._input.setCustomValidity) {\n        _this._input.setCustomValidity(_this.validity.valid ? '' : _this.props.validationMessage || VALIDATION_MESSAGE);\n      }\n    };\n\n    return _this;\n  }\n\n  Object.defineProperty(MultiSelect.prototype, \"element\", {\n    /**\n     * @hidden\n     */\n    get: function () {\n      return this._element;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(MultiSelect.prototype, \"value\", {\n    /**\n     * Represents the value of the MultiSelect.\n     */\n    get: function () {\n      var result = [];\n\n      if (this._valueItemsDuringOnChange) {\n        result.push.apply(result, this._valueItemsDuringOnChange);\n      } else if (this.props.value) {\n        result.push.apply(result, this.props.value);\n      } else if (this.state.value) {\n        result.push.apply(result, this.state.value);\n      } else if (this.props.defaultValue) {\n        result.push.apply(result, this.props.defaultValue);\n      }\n\n      return result;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(MultiSelect.prototype, \"name\", {\n    /**\n     * Gets the `name` property of the MultiSelect.\n     */\n    get: function () {\n      return this.props.name;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(MultiSelect.prototype, \"validity\", {\n    /**\n     * Represents the validity state into which the MultiSelect is set.\n     */\n    get: function () {\n      var customError = this.props.validationMessage !== undefined;\n      var isValid = !this.required || this.value !== null && this.value.length > 0 && this.value !== undefined;\n      var valid = this.props.valid !== undefined ? this.props.valid : isValid;\n      return {\n        customError: customError,\n        valid: valid,\n        valueMissing: this.value === null\n      };\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(MultiSelect.prototype, \"required\", {\n    /**\n     * @hidden\n     */\n    get: function () {\n      return this.props.required !== undefined ? this.props.required : MultiSelect.defaultProps.required;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(MultiSelect.prototype, \"validityStyles\", {\n    get: function () {\n      return this.props.validityStyles !== undefined ? this.props.validityStyles : MultiSelect.defaultProps.validityStyles;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  /**\n   * @hidden\n   */\n\n  MultiSelect.prototype.componentDidUpdate = function (prevProps, prevState) {\n    var _a = this.props,\n        virtual = _a.virtual,\n        data = _a.data;\n    var skip = virtual ? virtual.skip : 0;\n    var prevTotal = prevProps.virtual ? prevProps.virtual.total : 0;\n    var opened = this.props.opened !== undefined ? this.props.opened : this.state.opened;\n    var prevOpened = prevProps.opened !== undefined ? prevProps.opened : prevState.opened;\n    var opening = !prevOpened && opened;\n    var closing = prevOpened && !opened;\n    var popupSettings = this.base.getPopupSettings();\n\n    if (!popupSettings.animate && closing) {\n      this.onPopupClosed();\n    }\n\n    if (virtual && virtual.total !== prevTotal) {\n      this.base.vs.calcScrollElementHeight();\n      this.base.vs.reset();\n    } else {\n      var _b = this.getFocusedState(),\n          focusedItem = _b.focusedItem,\n          focusedIndex = _b.focusedIndex;\n\n      var focusedItemChanged = focusedIndex !== undefined && prevState.focusedIndex !== focusedIndex;\n      var prevData = prevProps.data;\n\n      if (opening && virtual) {\n        this.base.scrollToVirtualItem(virtual, focusedIndex - skip);\n      } else if (opening && !virtual) {\n        this.base.scrollToItem(focusedIndex);\n      } else if (opened && prevOpened && focusedItem && (focusedItemChanged || prevData !== data)) {\n        this.base.scrollToItem(focusedIndex - skip);\n      }\n    }\n\n    this.setValidity();\n  };\n  /**\n   * @hidden\n   */\n\n\n  MultiSelect.prototype.componentDidMount = function () {\n    this.base.didMount();\n    this.setValidity();\n  };\n  /**\n   * @hidden\n   */\n\n\n  MultiSelect.prototype.onNavigate = function (state, keyCode) {\n    var _a = this.props,\n        allowCustom = _a.allowCustom,\n        _b = _a.data,\n        data = _b === void 0 ? [] : _b;\n    var opened = this.props.opened !== undefined ? this.props.opened : this.state.opened;\n    var text = this.props.filter !== undefined ? this.props.filter : this.state.text;\n\n    var _c = this.getFocusedState(),\n        focusedType = _c.focusedType,\n        focusedIndex = _c.focusedIndex;\n\n    var customItem = allowCustom && text;\n    var customItemFocused = isCustom(focusedType);\n    var base = this.base;\n    var vs = base.vs;\n\n    if (opened && keyCode === Keys.up && customItemFocused) {\n      if (this.state.focusedIndex !== undefined) {\n        state.data.focusedIndex = undefined;\n      }\n    } else {\n      var newFocused = base.navigation.navigate({\n        keyCode: keyCode,\n        current: focusedIndex,\n        max: (vs.enabled ? vs.total : data.length) - 1,\n        min: customItem ? -1 : 0\n      });\n\n      if (newFocused !== undefined) {\n        this.itemFocus(newFocused, state);\n      }\n    }\n\n    this.applyState(state);\n  };\n  /**\n   * @hidden\n   */\n\n\n  MultiSelect.prototype.render = function () {\n    var _this = this;\n\n    var _a = this.props,\n        style = _a.style,\n        className = _a.className,\n        label = _a.label,\n        dir = _a.dir,\n        disabled = _a.disabled,\n        tags = _a.tags,\n        textField = _a.textField,\n        dataItemKey = _a.dataItemKey,\n        virtual = _a.virtual;\n    var _b = this.state,\n        focused = _b.focused,\n        text = _b.text,\n        focusedTag = _b.focusedTag;\n    var vs = this.base.vs;\n    var id = this.props.id || this._inputId;\n    vs.enabled = virtual !== undefined;\n\n    if (virtual !== undefined) {\n      vs.skip = virtual.skip;\n      vs.total = virtual.total;\n      vs.pageSize = virtual.pageSize;\n    }\n\n    var tagsToRender = [];\n\n    if (tags === undefined) {\n      this.value.forEach(function (item) {\n        tagsToRender.push({\n          text: getItemValue(item, textField),\n          data: [item]\n        });\n      });\n    } else {\n      tagsToRender.push.apply(tagsToRender, tags);\n    }\n\n    this.setItems(tagsToRender, this._tags);\n    var isValid = !this.validityStyles || this.validity.valid;\n    var component = React.createElement(\"span\", {\n      ref: function (dropdown) {\n        return _this._element = dropdown;\n      },\n      className: classNames('k-widget k-multiselect k-header', className, {\n        'k-state-focused': focused && !disabled,\n        'k-state-invalid': !isValid,\n        'k-state-disabled': disabled\n      }),\n      style: !label ? style : __assign({}, style, {\n        width: undefined\n      }),\n      dir: dir,\n      onFocus: this.handleFocus,\n      onBlur: this.handleBlur\n    }, React.createElement(\"div\", {\n      onClick: this.handleWrapperClick,\n      ref: function (wrapper) {\n        return _this.base.wrapper = wrapper;\n      },\n      className: \"k-multiselect-wrap k-floatwrap\",\n      onMouseDown: preventDefaultNonInputs\n    }, tagsToRender.length > 0 && React.createElement(TagList, {\n      tagRender: this.props.tagRender,\n      onTagDelete: this.onTagDelete,\n      data: tagsToRender,\n      guid: this.base.guid,\n      focused: focusedTag ? tagsToRender.find(function (t) {\n        return matchTags(t, focusedTag, dataItemKey);\n      }) : undefined\n    }), this.renderSearchbar(id), this.props.loading && React.createElement(\"span\", {\n      className: \"k-icon k-i-loading\"\n    })), this.renderListContainer());\n    return label ? React.createElement(FloatingLabel, {\n      label: label,\n      editorId: id,\n      editorValue: text || getItemValue(this.value[0], textField),\n      editorValid: isValid,\n      editorDisabled: disabled,\n      style: {\n        width: style ? style.width : undefined\n      },\n      children: component\n    }) : component;\n  };\n\n  MultiSelect.prototype.renderSearchbar = function (id) {\n    var _a = this.state,\n        activedescendant = _a.activedescendant,\n        focusedTag = _a.focusedTag;\n    var _b = this.props,\n        disabled = _b.disabled,\n        placeholder = _b.placeholder;\n    var text = (this.props.filter !== undefined ? this.props.filter : this.state.text) || '';\n    var opened = this.props.opened !== undefined ? this.props.opened : this.state.opened;\n    var focusedIndex = this.getFocusedState().focusedIndex;\n    var clearButton = !!text || this.value.length > 0;\n    var placeholderToShow = this.value.length === 0 && !text ? placeholder : undefined;\n    var ariaActivedescendant = activedescendant === ActiveDescendant.TagsList && focusedTag !== undefined ? \"tag-\" + this.base.guid + \"-\" + focusedTag.text.replace(/\\s+/g, '-') : \"option-\" + this.base.guid + \"-\" + focusedIndex;\n    return React.createElement(SearchBar, {\n      id: id,\n      size: Math.max((placeholderToShow || '').length, text.length, 1),\n      tabIndex: this.props.tabIndex,\n      accessKey: this.props.accessKey,\n      placeholder: placeholderToShow,\n      value: text,\n      onChange: this.onChangeHandler,\n      onKeyDown: this.onInputKeyDown,\n      ref: this.searchbarRef,\n      disabled: disabled,\n      expanded: opened,\n      owns: this.base.listBoxId,\n      activedescendant: ariaActivedescendant,\n      ariaDescribedBy: \"tagslist-\" + this.base.guid + \" \" + (this.props.ariaDescribedBy || ''),\n      clearButton: clearButton,\n      clearButtonClick: this.clearButtonClick,\n      ariaLabelledBy: this.props.ariaLabelledBy\n    });\n  };\n\n  MultiSelect.prototype.onTagsNavigate = function (event, state) {\n    var keyCode = event.keyCode;\n    var focusedTag = this.state.focusedTag;\n    var tags = this._tags;\n    var itemsKey = this.props.dataItemKey;\n    var focusedIndex = focusedTag ? tags.findIndex(function (t) {\n      return matchTags(t, focusedTag, itemsKey);\n    }) : -1;\n    var newFocusedTag = undefined;\n    var hasFocused = focusedIndex !== -1;\n\n    if (keyCode === Keys.left) {\n      if (hasFocused) {\n        focusedIndex = Math.max(0, focusedIndex - 1);\n      } else {\n        focusedIndex = tags.length - 1;\n      }\n\n      newFocusedTag = tags[focusedIndex];\n    } else if (keyCode === Keys.right) {\n      if (focusedIndex === tags.length - 1) {\n        newFocusedTag = undefined;\n      } else if (hasFocused) {\n        focusedIndex = Math.min(tags.length - 1, focusedIndex + 1);\n        newFocusedTag = tags[focusedIndex];\n      }\n    } else if (keyCode === Keys.home) {\n      newFocusedTag = tags[0];\n    } else if (keyCode === Keys.end) {\n      newFocusedTag = tags[tags.length - 1];\n    } else if (keyCode === Keys.delete) {\n      if (hasFocused) {\n        var items = this.value;\n        removeDataItems(items, tags[focusedIndex].data, itemsKey);\n        this.triggerOnChange(items, state);\n      }\n    } else if (keyCode === Keys.backspace) {\n      var items = this.value;\n\n      if (hasFocused) {\n        removeDataItems(items, tags[focusedIndex].data, itemsKey);\n        this.triggerOnChange(items, state);\n      } else if (!hasFocused && tags.length) {\n        var removed = tags.pop();\n        removeDataItems(items, removed.data, itemsKey);\n        this.triggerOnChange(items, state);\n      }\n    }\n\n    if (newFocusedTag !== focusedTag) {\n      state.data.focusedTag = newFocusedTag;\n      state.data.activedescendant = ActiveDescendant.TagsList;\n    }\n\n    this.applyState(state);\n  };\n\n  MultiSelect.prototype.triggerOnChange = function (items, state) {\n    if (this.props.value === undefined) {\n      state.data.value = items.slice();\n    }\n\n    this._valueItemsDuringOnChange = [];\n    this.setItems(items, this._valueItemsDuringOnChange);\n    state.events.push({\n      type: 'onChange'\n    });\n  };\n\n  MultiSelect.prototype.selectFocusedItem = function (event) {\n    var _a = this.props,\n        _b = _a.data,\n        data = _b === void 0 ? [] : _b,\n        virtual = _a.virtual;\n    var focusedIndex = this.getFocusedState().focusedIndex;\n    var skip = virtual ? virtual.skip : 0;\n\n    if (data[focusedIndex - skip] !== undefined) {\n      this.handleItemClick(focusedIndex, event);\n    }\n  };\n\n  MultiSelect.prototype.setItems = function (srcItems, destItems) {\n    destItems.length = 0;\n    destItems.push.apply(destItems, srcItems);\n  };\n\n  MultiSelect.prototype.getFocusedState = function () {\n    var focusedIndex = this.state.focusedIndex;\n    var text = this.props.filter !== undefined ? this.props.filter : this.state.text;\n    var _a = this.props,\n        allowCustom = _a.allowCustom,\n        _b = _a.data,\n        data = _b === void 0 ? [] : _b,\n        dataItemKey = _a.dataItemKey,\n        virtual = _a.virtual,\n        textField = _a.textField,\n        _c = _a.focusedItemIndex,\n        focusedItemIndex = _c === void 0 ? itemIndexStartsWith : _c;\n    var skip = virtual && virtual.skip || 0;\n    var focusedInd;\n\n    if (focusedIndex !== undefined) {\n      return {\n        focusedIndex: focusedIndex,\n        focusedItem: data[focusedIndex - skip],\n        focusedType: FocusedItemType.ListItem\n      };\n    }\n\n    var selected = this.value;\n\n    if (allowCustom && text) {\n      return {\n        focusedItem: null,\n        focusedIndex: -1,\n        focusedType: FocusedItemType.CustomItem\n      };\n    } else if (text) {\n      focusedInd = focusedItemIndex(data, text, textField);\n      return {\n        focusedItem: data[focusedInd],\n        focusedIndex: focusedInd + skip,\n        focusedType: FocusedItemType.ListItem\n      };\n    } else if (selected.length) {\n      var last_1 = selected[selected.length - 1];\n      focusedInd = data.findIndex(function (i) {\n        return areSame(i, last_1, dataItemKey);\n      });\n\n      if (data[focusedInd] !== undefined) {\n        return {\n          focusedIndex: focusedInd + skip,\n          focusedItem: data[focusedInd],\n          focusedType: FocusedItemType.ListItem\n        };\n      }\n\n      return {\n        focusedType: FocusedItemType.None,\n        focusedIndex: -1\n      };\n    }\n\n    return skip === 0 ? {\n      focusedItem: data[0],\n      focusedIndex: 0,\n      focusedType: FocusedItemType.ListItem\n    } : {\n      focusedType: FocusedItemType.None,\n      focusedIndex: -1\n    };\n  };\n\n  MultiSelect.prototype.focusElement = function (element) {\n    var _this = this;\n\n    this._skipFocusEvent = true;\n    element.focus();\n    setTimeout(function () {\n      return _this._skipFocusEvent = false;\n    }, 30);\n  };\n\n  MultiSelect.prototype.applyState = function (state) {\n    this.base.applyState(state);\n    this._valueItemsDuringOnChange = null;\n  };\n  /**\n   * @hidden\n   */\n\n\n  MultiSelect.propTypes = __assign({}, DropDownBase.propTypes, {\n    autoClose: PropTypes.bool,\n    value: PropTypes.arrayOf(PropTypes.any),\n    defaultValue: PropTypes.arrayOf(PropTypes.any),\n    dataItemKey: PropTypes.string,\n    placeholder: PropTypes.string,\n    tags: PropTypes.arrayOf(PropTypes.shape({\n      text: PropTypes.string,\n      data: PropTypes.arrayOf(PropTypes.any)\n    })),\n    tagRender: PropTypes.func,\n    id: PropTypes.string,\n    ariaLabelledBy: PropTypes.string,\n    ariaDescribedBy: PropTypes.string\n  });\n  /**\n   * @hidden\n   */\n\n  MultiSelect.defaultProps = __assign({}, DropDownBase.defaultProps, {\n    autoClose: true,\n    required: false\n  });\n  return MultiSelect;\n}(React.Component);\n\nexport default MultiSelect;","map":{"version":3,"sources":["../../../src/MultiSelect/MultiSelect.tsx"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,OAAO,KAAK,KAAZ,MAAuB,OAAvB;AACA,OAAO,KAAK,SAAZ,MAA2B,YAA3B;AACA,SACI,UADJ,EAEI,IAFJ,EAGI,IAHJ,QAMO,8BANP;AAOA,SAAS,aAAT,QAA8B,8BAA9B;AAEA,OAAO,aAAP,MAAkD,yBAAlD;AACA,OAAO,IAAP,MAAiB,gBAAjB;AACA,OAAO,OAAP,MAAiC,WAAjC;AACA,OAAO,SAAP,MAAsB,qBAAtB;AACA,OAAO,YAAP,MAAyB,wBAAzB;AAEA,SAA2C,gBAA3C,QAAmE,sBAAnE;AACA,SACI,mBADJ,EACyB,YADzB,EACuC,OADvC,EAEI,oBAFJ,EAE0B,eAF1B,EAE2C,SAF3C,EAEsD,uBAFtD,QAGO,iBAHP;AAKA,IAAM,kBAAkB,GAAW,6BAAnC;;AACA,IAAM,cAAc,GAAG,UAAA,KAAA,EAAK;AAAI,SAAA,KAAK,CAAL,cAAA,EAAA;AAAsB,CAAtD;;AAEA,IAAM,SAAS,GAAG,UAAC,IAAD,EAAgB,IAAhB,EAA+B,GAA/B,EAA2C;AACzD,MAAI,CAAC,CAAC,IAAF,KAAW,CAAC,CAAC,IAAb,IAAqB,IAAI,CAAC,IAAL,KAAc,IAAI,CAAC,IAA5C,EAAkD;AAC9C,WAAO,KAAP;AACH;;AAED,SAAO,IAAI,KAAK,IAAT,IAAiB,oBAAoB,CAAC,IAAI,CAAC,IAAN,EAAY,IAAI,CAAC,IAAjB,EAAuB,GAAvB,CAA5C;AACH,CAND;;AAQA,IAAM,QAAQ,GAAG,UAAC,IAAD,EAAsB;AAAK,SAAA,IAAI,KAAK,eAAe,CAAxB,UAAA;AAAmC,CAA/E;;AAEA,IAAK,eAAL;;AAAA,CAAA,UAAK,eAAL,EAAoB;AAChB,EAAA,eAAA,CAAA,eAAA,CAAA,MAAA,CAAA,GAAA,CAAA,CAAA,GAAA,MAAA;AACA,EAAA,eAAA,CAAA,eAAA,CAAA,UAAA,CAAA,GAAA,CAAA,CAAA,GAAA,UAAA;AACA,EAAA,eAAA,CAAA,eAAA,CAAA,YAAA,CAAA,GAAA,CAAA,CAAA,GAAA,YAAA;AACH,CAJD,EAAK,eAAe,KAAf,eAAe,GAAA,EAAA,CAApB;AA6BA;;;;;;;;;;;;;;;;;;;;;;;;AAsBA,IAAA,WAAA;AAAA;AAAA,UAAA,MAAA,EAAA;AAAyC,EAAA,SAAA,CAAA,WAAA,EAAA,MAAA,CAAA;;AAAzC,WAAA,WAAA,GAAA;AAAA,QAAA,KAAA,GAAA,MAAA,KAAA,IAAA,IAAA,MAAA,CAAA,KAAA,CAAA,IAAA,EAAA,SAAA,CAAA,IAAA,IAAA;AA+BI;;;;;AAGS,IAAA,KAAA,CAAA,KAAA,GAA0B;AAC/B,MAAA,gBAAgB,EAAE,gBAAgB,CAAC;AADJ,KAA1B;AAKD,IAAA,KAAA,CAAA,yBAAA,GAA+C,IAA/C;AACS,IAAA,KAAA,CAAA,QAAA,GAAmB,IAAI,EAAvB;AACE,IAAA,KAAA,CAAA,IAAA,GAAO,IAAI,YAAJ,CAAiB,KAAjB,CAAP;AACF,IAAA,KAAA,CAAA,KAAA,GAAwB,EAAxB;AAET,IAAA,KAAA,CAAA,eAAA,GAA2B,KAA3B;AAER;;;;AAGO,IAAA,KAAA,CAAA,KAAA,GAAQ,YAAA;AACX,UAAI,KAAI,CAAC,MAAT,EAAiB;AACb,QAAA,KAAI,CAAC,MAAL,CAAY,KAAZ;AACH;AACJ,KAJM;AAiHP;;;;;AAGA,IAAA,KAAA,CAAA,gBAAA,GAAmB,UAAC,KAAD,EAAgB,KAAhB,EAA+C;AACxD,UAAA,EAAA,GAAA,KAAA,CAAA,KAAA;AAAA,UAAE,EAAA,GAAA,EAAA,CAAA,IAAF;AAAA,UAAE,IAAA,GAAA,EAAA,KAAA,KAAA,CAAA,GAAA,EAAA,GAAA,EAAF;AAAA,UAAa,WAAA,GAAA,EAAA,CAAA,WAAb;AAAA,UAA0B,OAAA,GAAA,EAAA,CAAA,OAA1B;AACN,UAAM,IAAI,GAAG,OAAO,GAAG,OAAO,CAAC,IAAX,GAAkB,CAAtC;AACA,UAAM,QAAQ,GAAG,IAAI,CAAC,KAAK,GAAG,IAAT,CAArB;;AACA,UAAM,YAAY,GAAG,KAAI,CAAC,KAAL,CAAW,SAAX,CAAqB,UAAA,CAAA,EAAC;AAAI,eAAA,OAAO,CAAC,CAAD,EAAI,QAAJ,EAAP,WAAO,CAAP;AAAiC,OAA3D,CAArB;;AACA,UAAI,QAAQ,GAAe,EAA3B;;AAEA,UAAI,YAAY,KAAK,CAAC,CAAtB,EAAyB;AAAC;AACtB,QAAA,QAAQ,GAAG,KAAI,CAAC,KAAhB;AACA,QAAA,QAAQ,CAAC,MAAT,CAAgB,YAAhB,EAA8B,CAA9B;AACH,OAHD,MAGO;AACH,QAAA,QAAQ,GAAO,KAAI,CAAC,KAAL,CAAU,MAAV,CAAU,CAAE,QAAF,CAAV,CAAf;AACH;;AAED,UAAM,IAAI,GAAG,KAAI,CAAC,KAAL,CAAW,MAAX,KAAsB,SAAtB,GAAkC,KAAI,CAAC,KAAL,CAAW,MAA7C,GAAsD,KAAI,CAAC,KAAL,CAAW,IAA9E;;AAEA,UAAI,IAAJ,EAAU;AACN,YAAI,KAAI,CAAC,KAAL,CAAW,IAAf,EAAqB;AACjB,UAAA,KAAK,CAAC,IAAN,CAAW,IAAX,GAAkB,EAAlB;AACH;;AACD,QAAA,KAAI,CAAC,IAAL,CAAU,aAAV,CAAwB,EAAxB,EAA4B,KAA5B;AACH;;AAED,UAAI,KAAI,CAAC,KAAL,CAAW,YAAX,KAA4B,SAAhC,EAA2C;AACvC,QAAA,KAAK,CAAC,IAAN,CAAW,YAAX,GAA0B,SAA1B;AACH;;AACD,MAAA,KAAI,CAAC,eAAL,CAAqB,QAArB,EAA+B,KAA/B;;AACA,MAAA,KAAI,CAAC,IAAL,CAAU,4BAAV,CAAuC,QAAvC,EAAiD,KAAjD;AACH,KA5BD;AA8BA;;;;;AAGA,IAAA,KAAA,CAAA,WAAA,GAAc,UAAC,aAAD,EAA4B,KAA5B,EAAoE;AAC9E,UAAM,MAAM,GAAG,KAAI,CAAC,KAAL,CAAW,MAAX,KAAsB,SAAtB,GAAkC,KAAI,CAAC,KAAL,CAAW,MAA7C,GAAsD,KAAI,CAAC,KAAL,CAAW,MAAhF;;AACA,UAAM,KAAK,GAA6B,KAAI,CAAC,IAAL,CAAU,SAAV,EAAxC;;AACA,MAAA,KAAK,CAAC,cAAN,GAAuB,KAAvB;;AAEA,UAAI,MAAJ,EAAY;AACR,QAAA,KAAI,CAAC,IAAL,CAAU,WAAV,CAAsB,KAAtB;AACH;;AAED,UAAI,CAAC,KAAI,CAAC,KAAL,CAAW,OAAhB,EAAyB;AACrB,QAAA,KAAK,CAAC,IAAN,CAAW,OAAX,GAAqB,IAArB;AACH;;AAED,UAAM,QAAQ,GAAG,KAAI,CAAC,KAAtB;AACA,MAAA,eAAe,CAAC,QAAD,EAAW,aAAX,EAA0B,KAAI,CAAC,KAAL,CAAW,WAArC,CAAf;;AACA,MAAA,KAAI,CAAC,eAAL,CAAqB,QAArB,EAA+B,KAA/B;;AAEA,MAAA,KAAI,CAAC,UAAL,CAAgB,KAAhB;AACH,KAlBD;AAsDA;;;;;AAGA,IAAA,KAAA,CAAA,SAAA,GAAY,UAAC,KAAD,EAAgB,KAAhB,EAA+C;AACjD,UAAA,EAAA,GAAA,KAAA,CAAA,KAAA;AAAA,UAAE,EAAA,GAAA,EAAA,CAAA,IAAF;AAAA,UAAE,IAAA,GAAA,EAAA,KAAA,KAAA,CAAA,GAAA,EAAA,GAAA,EAAF;AAAA,UAAa,WAAA,GAAA,EAAA,CAAA,WAAb;AAAA,UAA0B,OAAA,GAAA,EAAA,CAAA,OAA1B;AACN,UAAM,IAAI,GAAG,OAAO,GAAG,OAAO,CAAC,IAAX,GAAkB,CAAtC;AACA,UAAM,IAAI,GAAG,KAAI,CAAC,KAAL,CAAW,MAAX,KAAsB,SAAtB,GAAkC,KAAI,CAAC,KAAL,CAAW,MAA7C,GAAsD,KAAI,CAAC,KAAL,CAAW,IAA9E;;AACQ,UAAA,YAAA,GAAA,KAAA,CAAA,eAAA,GAAA,YAAA;;AACR,UAAM,UAAU,GAAG,WAAW,IAAI,IAAlC;AACA,UAAM,eAAe,GAAG,IAAI,CAAC,KAAK,GAAG,IAAT,CAA5B;;AAEA,UAAI,eAAe,IAAI,YAAY,KAAK,KAAxC,EAA+C;AAC3C,YAAI,KAAI,CAAC,KAAL,CAAW,YAAX,KAA4B,KAAhC,EAAuC;AACnC,UAAA,KAAK,CAAC,IAAN,CAAW,YAAX,GAA0B,KAA1B;AACA,UAAA,KAAK,CAAC,IAAN,CAAW,gBAAX,GAA8B,gBAAgB,CAAC,SAA/C;AACH;AACJ,OALD,MAKO,IAAI,UAAU,IAAI,KAAK,KAAK,CAAC,CAA7B,EAAgC;AACnC,YAAI,KAAI,CAAC,KAAL,CAAW,YAAX,KAA4B,SAAhC,EAA2C;AACvC,UAAA,KAAK,CAAC,IAAN,CAAW,YAAX,GAA0B,SAA1B;AACH;AACJ;;AACD,MAAA,KAAI,CAAC,IAAL,CAAU,4BAAV,CAAuC,eAAvC,EAAwD,KAAxD;AACH,KAnBD;;AAmIQ,IAAA,KAAA,CAAA,YAAA,GAAe,UAAC,SAAD,EAA4B;AAC/C,UAAM,KAAK,GAAG,KAAI,CAAC,MAAL,GAAc,SAAS,IAAI,SAAS,CAAC,KAAnD;;AACA,UAAI,KAAK,IAAI,KAAI,CAAC,KAAL,CAAW,OAAxB,EAAiC;AAC7B,QAAA,UAAU,CAAC,YAAA;AAAM,iBAAA,KAAK,CAAL,KAAA,EAAA;AAAa,SAApB,EAAsB,CAAtB,CAAV;AACH;AACJ,KALO;;AAOA,IAAA,KAAA,CAAA,eAAA,GAA4D,UAAC,KAAD,EAAM;AACtE,UAAM,KAAK,GAA6B,KAAI,CAAC,IAAL,CAAU,SAAV,EAAxC;;AACA,UAAM,KAAK,GAAG,KAAK,CAAC,aAAN,CAAoB,KAAlC;AACA,UAAM,MAAM,GAAG,KAAI,CAAC,KAAL,CAAW,MAAX,KAAsB,SAAtB,GAAkC,KAAI,CAAC,KAAL,CAAW,MAA7C,GAAsD,KAAI,CAAC,KAAL,CAAW,MAAhF;AAEA,MAAA,KAAK,CAAC,cAAN,GAAuB,KAAvB;;AACA,UAAI,KAAI,CAAC,KAAL,CAAW,MAAX,KAAsB,SAA1B,EAAqC;AACjC,QAAA,KAAK,CAAC,IAAN,CAAW,IAAX,GAAkB,KAAlB;AACH;;AAED,MAAA,KAAK,CAAC,IAAN,CAAW,YAAX,GAA0B,SAA1B;;AAEA,UAAI,CAAC,MAAL,EAAa;AACT,QAAA,KAAI,CAAC,IAAL,CAAU,WAAV,CAAsB,KAAtB;AACH;;AAED,MAAA,KAAI,CAAC,IAAL,CAAU,aAAV,CAAwB,KAAxB,EAA+B,KAA/B;;AAEA,MAAA,KAAI,CAAC,UAAL,CAAgB,KAAhB;AACH,KAnBO;;AAqBA,IAAA,KAAA,CAAA,gBAAA,GAA6D,UAAC,KAAD,EAAM;AACvE,UAAM,MAAM,GAAG,KAAI,CAAC,KAAL,CAAW,MAAX,KAAsB,SAAtB,GAAkC,KAAI,CAAC,KAAL,CAAW,MAA7C,GAAsD,KAAI,CAAC,KAAL,CAAW,MAAhF;;AACA,UAAM,KAAK,GAA6B,KAAI,CAAC,IAAL,CAAU,SAAV,EAAxC;;AACA,MAAA,KAAK,CAAC,cAAN,GAAuB,KAAvB;AACA,MAAA,KAAK,CAAC,eAAN;;AAEA,UAAI,KAAI,CAAC,KAAL,CAAW,MAAX,GAAoB,CAAxB,EAA2B;AACvB,QAAA,KAAI,CAAC,eAAL,CAAqB,EAArB,EAAyB,KAAzB;AACH;;AAED,UAAI,KAAI,CAAC,KAAL,CAAW,YAAX,KAA4B,SAAhC,EAA2C;AACvC,QAAA,KAAK,CAAC,IAAN,CAAW,YAAX,GAA0B,SAA1B;AACH;;AAED,UAAI,MAAJ,EAAY;AACR,QAAA,KAAI,CAAC,IAAL,CAAU,WAAV,CAAsB,KAAtB;AACH;;AAED,UAAM,IAAI,GAAG,KAAI,CAAC,KAAL,CAAW,MAAX,KAAsB,SAAtB,GAAkC,KAAI,CAAC,KAAL,CAAW,MAA7C,GAAsD,KAAI,CAAC,KAAL,CAAW,IAA9E;;AACA,UAAI,SAAS,CAAC,IAAD,CAAT,IAAmB,IAAI,KAAK,EAAhC,EAAoC;AAChC,QAAA,KAAI,CAAC,IAAL,CAAU,aAAV,CAAwB,EAAxB,EAA4B,KAA5B;AACH;;AAED,UAAI,KAAI,CAAC,KAAL,CAAW,IAAf,EAAqB;AACjB,QAAA,KAAK,CAAC,IAAN,CAAW,IAAX,GAAkB,EAAlB;AACH;;AAED,MAAA,KAAI,CAAC,UAAL,CAAgB,KAAhB;AACH,KA5BO;;AA8BA,IAAA,KAAA,CAAA,cAAA,GAA+D,UAAC,KAAD,EAAM;AACzE,UAAM,OAAO,GAAG,KAAK,CAAC,OAAtB;AACA,UAAM,IAAI,GAAG,KAAI,CAAC,KAAL,CAAW,MAAX,KAAsB,SAAtB,GAAkC,KAAI,CAAC,KAAL,CAAW,MAA7C,GAAsD,KAAI,CAAC,KAAL,CAAW,IAA9E;AACA,UAAM,MAAM,GAAG,KAAI,CAAC,KAAL,CAAW,MAAX,KAAsB,SAAtB,GAAkC,KAAI,CAAC,KAAL,CAAW,MAA7C,GAAsD,KAAI,CAAC,KAAL,CAAW,MAAhF;;AACQ,UAAA,WAAA,GAAA,KAAA,CAAA,eAAA,GAAA,WAAA;;AACR,UAAM,KAAK,GAA6B,KAAI,CAAC,IAAL,CAAU,SAAV,EAAxC;;AACA,MAAA,KAAK,CAAC,cAAN,GAAuB,KAAvB;;AAEA,UAAI,CAAC,IAAD,IAAS,KAAI,CAAC,KAAL,CAAW,MAAX,GAAoB,CAA7B,KACC,OAAO,KAAK,IAAI,CAAC,IAAjB,IAAyB,OAAO,KAAK,IAAI,CAAC,KAA1C,IACG,OAAO,KAAK,IAAI,CAAC,IADpB,IAC4B,OAAO,KAAK,IAAI,CAAC,GAD7C,IAEG,OAAO,KAAK,IAAI,CAAC,MAFpB,IAE8B,OAAO,KAAK,IAAI,CAAC,SAHhD,CAAJ,EAGgE;AAC5D,eAAO,KAAI,CAAC,cAAL,CAAoB,KAApB,EAA2B,KAA3B,CAAP;AACH;;AAED,UAAM,WAAW,GAAG,YAAA;AAChB,QAAA,KAAK,CAAC,cAAN;;AACA,QAAA,KAAI,CAAC,IAAL,CAAU,WAAV,CAAsB,KAAtB;;AACA,QAAA,KAAI,CAAC,UAAL,CAAgB,KAAhB;AACH,OAJD;;AAMA,UAAI,MAAJ,EAAY;AACR,YAAI,KAAK,CAAC,MAAN,IAAgB,OAAO,KAAK,IAAI,CAAC,EAArC,EAAyC;AACrC,UAAA,WAAW;AACd,SAFD,MAEO,IAAI,OAAO,KAAK,IAAI,CAAC,EAAjB,IAAuB,OAAO,KAAK,IAAI,CAAC,IAA5C,EAAkD;AACrD,UAAA,KAAK,CAAC,cAAN;;AACA,UAAA,KAAI,CAAC,UAAL,CAAgB,KAAhB,EAAuB,OAAvB;AACH,SAHM,MAGA,IAAI,OAAO,KAAK,IAAI,CAAC,KAArB,EAA4B;AAC/B,UAAA,KAAK,CAAC,cAAN;;AACA,cAAI,KAAI,CAAC,KAAL,CAAW,WAAX,IAA0B,IAA1B,IAAkC,WAAW,KAAK,IAAtD,EAA4D;AACxD,YAAA,KAAI,CAAC,gBAAL,CAAsB,KAAtB;AACH,WAFD,MAEO;AACH,YAAA,KAAI,CAAC,iBAAL,CAAuB,KAAvB;AACH;AACJ,SAPM,MAOA,IAAI,OAAO,KAAK,IAAI,CAAC,GAArB,EAA0B;AAC7B,UAAA,WAAW;AACd;AACJ,OAhBD,MAgBO,IAAI,KAAK,CAAC,MAAN,IAAgB,OAAO,KAAK,IAAI,CAAC,IAArC,EAA2C;AAC9C,QAAA,WAAW;AACd;AACJ,KAxCO;;AAqKA,IAAA,KAAA,CAAA,mBAAA,GAAsB,YAAA;AAC1B,UAAM,IAAI,GAAG,KAAI,CAAC,IAAlB;AACM,UAAA,EAAA,GAAA,KAAA,CAAA,KAAA;AAAA,UAAE,MAAA,GAAA,EAAA,CAAA,MAAF;AAAA,UAAU,MAAA,GAAA,EAAA,CAAA,MAAV;AAAA,UAAkB,WAAA,GAAA,EAAA,CAAA,WAAlB;AAAA,UAA+B,GAAA,GAAA,EAAA,CAAA,GAA/B;;AACN,UAAM,aAAa,GAAG,KAAI,CAAC,IAAL,CAAU,gBAAV,EAAtB;;AACA,UAAM,MAAM,GAAG,KAAI,CAAC,KAAL,CAAW,MAAX,KAAsB,SAAtB,GAAkC,KAAI,CAAC,KAAL,CAAW,MAA7C,GAAsD,KAAI,CAAC,KAAL,CAAW,MAAhF;AACA,UAAM,IAAI,GAAG,KAAI,CAAC,KAAL,CAAW,MAAX,KAAsB,SAAtB,GAAkC,KAAI,CAAC,KAAL,CAAW,MAA7C,GAAsD,KAAI,CAAC,KAAL,CAAW,IAA9E;AACA,UAAM,OAAO,GAAG,KAAI,CAAC,KAAL,CAAW,OAAX,KAAuB,SAAvC;AACA,UAAM,UAAU,GAAG,aAAa,CAAC,KAAd,KAAwB,SAAxB,GAAoC,aAAa,CAAC,KAAlD,GAA0D,IAAI,CAAC,UAAlF;AAEA,UAAM,kBAAkB,GAAuB;AAC3C,QAAA,WAAW,EAAE,cAD8B;AAE3C,QAAA,GAAG,EAAE,GAAG,KAAK,SAAR,GAAoB,GAApB,GAA0B,IAAI,CAAC,aAFO;AAG3C,QAAA,MAAM,EAAE,KAAI,CAAC,UAH8B;AAI3C,QAAA,KAAK,EAAE,UAJoC;AAK3C,QAAA,aAAa,EAAE;AACX,UAAA,SAAS,EAAE,UAAU,CAAC,0BAAD,EAA6B,aAAa,CAAC,SAA3C,CADV;AAEX,UAAA,OAAO,EAAE,aAAa,CAAC,OAFZ;AAGX,UAAA,MAAM,EAAE,KAAI,CAAC,OAAL,IAAgB,SAHb;AAIX,UAAA,IAAI,EAAE,MAJK;AAKX,UAAA,IAAI,EAAE,KAAI,CAAC,aALA;AAMX,UAAA,KAAK,EAAE,KAAI,CAAC,aAND;AAOX,UAAA,QAAQ,EAAE,aAAa,CAAC;AAPb;AAL4B,OAA/C;;AAgBQ,UAAA,WAAA,GAAA,KAAA,CAAA,eAAA,GAAA,WAAA;;AACR,UAAM,UAAU,GAAG,WAAW,IAAI,IAAf,IACf,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA;AAAK,QAAA,SAAS,EAAC,QAAf;AAAwB,QAAA,GAAG,EAAC,YAA5B;AAAyC,QAAA,OAAO,EAAE,KAAI,CAAC;AAAvD,OAAA,EACI,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA;AAAK,QAAA,SAAS,EAAE,UAAU,CAAC,sBAAD,EAAyB;AAAE,6BAAmB,QAAQ,CAAC,WAAD;AAA7B,SAAzB;AAA1B,OAAA,EACK,IADL,EAEI,KAAA,CAAA,aAAA,CAAA,MAAA,EAAA;AAAM,QAAA,SAAS,EAAC,iBAAhB;AAAkC,QAAA,KAAK,EAAE;AAAE,UAAA,KAAK,EAAE;AAAT;AAAzC,OAAA,CAFJ,CADJ,CADJ;AASA,aACI,KAAA,CAAA,aAAA,CAAC,aAAD,EAAc,QAAA,CAAA,EAAA,EAAK,kBAAL,CAAd,EACK,OAAO,IAAI,MADhB,EAEK,KAAI,CAAC,IAAL,CAAU,mBAAV,CACG,KAAA,CAAA,aAAA,CAAA,KAAA,CAAA,QAAA,EAAA,IAAA,EACK,CAAC,OAAD,IAAY,MADjB,EAEK,UAFL,EAGK,KAAI,CAAC,UAAL,EAHL,EAIK,CAAC,OAAD,IAAY,MAJjB,EAKK,KAAI,CAAC,IAAL,CAAU,mBAAV,EALL,CADH,CAFL,EAWK,OAAO,IAAI,MAXhB,CADJ;AAeH,KAlDO;;AAoDA,IAAA,KAAA,CAAA,UAAA,GAAa,YAAA;AACX,UAAA,EAAA,GAAA,KAAA,CAAA,KAAA;AAAA,UACF,EAAA,GAAA,EAAA,CAAA,IADE;AAAA,UACF,IAAA,GAAA,EAAA,KAAA,KAAA,CAAA,GAAA,EAAA,GAAA,EADE;AAAA,UAEF,SAAA,GAAA,EAAA,CAAA,SAFE;AAAA,UAGF,gBAAA,GAAA,EAAA,CAAA,gBAHE;AAAA,UAIF,UAAA,GAAA,EAAA,CAAA,UAJE;AAAA,UAKF,WAAA,GAAA,EAAA,CAAA,WALE;AAAA,UAMF,OAAA,GAAA,EAAA,CAAA,OANE;AASN,UAAM,EAAE,GAAG,KAAI,CAAC,IAAL,CAAU,EAArB;AACA,UAAM,IAAI,GAAG,OAAO,GAAG,OAAO,CAAC,IAAX,GAAkB,CAAtC;AACA,UAAM,MAAM,GAAG,KAAI,CAAC,KAAL,CAAW,MAAX,KAAsB,SAAtB,GAAkC,KAAI,CAAC,KAAL,CAAW,MAA7C,GAAsD,KAAI,CAAC,KAAL,CAAW,MAAhF;;AACQ,UAAA,YAAA,GAAA,KAAA,CAAA,eAAA,GAAA,YAAA;;AACR,UAAM,aAAa,GAAG,KAAI,CAAC,IAAL,CAAU,gBAAV,EAAtB;;AACA,UAAM,SAAS,GAAG,gBAAc,EAAE,CAAC,SAAjB,GAA0B,KAA5C;AAEA,aACI,KAAA,CAAA,aAAA,CAAC,IAAD,EAAK;AACD,QAAA,EAAE,EAAE,KAAI,CAAC,IAAL,CAAU,SADb;AAED,QAAA,IAAI,EAAE,MAFL;AAGD,QAAA,IAAI,EAAE,IAAI,CAAC,KAAL,EAHL;AAID,QAAA,YAAY,EAAE,YAAY,GAAG,IAJ5B;AAKD,QAAA,KAAK,EAAE,KAAI,CAAC,KALX;AAMD,QAAA,SAAS,EAAE,SANV;AAOD,QAAA,UAAU,EAAE,WAPX;AAQD,QAAA,WAAW,EAAE,KAAI,CAAC,IAAL,CAAU,IARtB;AASD,QAAA,OAAO,EAAE,UAAA,IAAA,EAAI;AAAI,iBAAA,EAAE,CAAC,IAAH,GAAU,KAAI,CAAC,IAAL,CAAU,IAAV,GAAV,IAAA;AAA+B,SAT/C;AAUD,QAAA,YAAY,EAAE,EAAE,CAAC,OAAH,GACV;AAAE,UAAA,KAAK,EAAE,MAAT;AAAiB,UAAA,KAAK,EAAE;AAAxB,SADU,GACyB;AAAE,UAAA,SAAS,EAAE,aAAa,CAAC;AAA3B,SAXtC;AAaD,QAAA,eAAe,EAAE,EAAE,CAAC,OAAH,GAAa,SAAb,GAAyB,iBAbzC;AAcD,QAAA,SAAS,EAAE,EAAE,CAAC,OAAH,GAAa;AAAE,UAAA,SAAS,EAAE;AAAb,SAAb,GAAwC,SAdlD;AAeD,QAAA,GAAG,EAAC,SAfH;AAgBD,QAAA,IAAI,EAAE,IAhBL;AAiBD,QAAA,OAAO,EAAE,KAAI,CAAC,eAjBb;AAkBD,QAAA,UAAU,EAAE,UAlBX;AAmBD,QAAA,YAAY,EAAE;AAnBb,OAAL,CADJ;AAuBH,KAxCO;;AA0CA,IAAA,KAAA,CAAA,gBAAA,GAAmB,UAAC,KAAD,EAAgF;;;AACvG,UAAM,QAAQ,GAAG,KAAI,CAAC,KAAL,CAAW,MAAX,KAAsB,SAAtB,GAAkC,KAAI,CAAC,KAAL,CAAW,MAA7C,GAAsD,KAAI,CAAC,KAAL,CAAW,IAAlF;AACQ,UAAA,SAAA,GAAA,KAAA,CAAA,KAAA,CAAA,SAAA;;AACR,UAAI,CAAC,QAAL,EAAe;AACX;AACH;;AAED,UAAM,KAAK,GAA6B,KAAI,CAAC,IAAL,CAAU,SAAV,EAAxC;;AACA,MAAA,KAAK,CAAC,cAAN,GAAuB,KAAvB;AAEA,UAAM,IAAI,GAAG,SAAS,IAAE,EAAA,GAAA,EAAA,EAAG,EAAA,CAAC,SAAD,CAAA,GAAa,QAAhB,EAAwB,EAA1B,IAA+B,QAArD;;AACA,UAAI,KAAI,CAAC,KAAL,CAAW,IAAX,KAAoB,SAAxB,EAAmC;AAC/B,QAAA,KAAK,CAAC,IAAN,CAAW,IAAX,GAAkB,EAAlB;AACH;;AACD,MAAA,KAAK,CAAC,IAAN,CAAW,YAAX,GAA0B,SAA1B;;AAEA,MAAA,KAAI,CAAC,IAAL,CAAU,aAAV,CAAwB,EAAxB,EAA4B,KAA5B;;AAEA,UAAM,QAAQ,GAAO,KAAI,CAAC,KAAL,CAAU,MAAV,CAAU,CAAE,IAAF,CAAV,CAArB;;AACA,MAAA,KAAI,CAAC,eAAL,CAAqB,QAArB,EAA+B,KAA/B;;AAEA,MAAA,KAAI,CAAC,IAAL,CAAU,WAAV,CAAsB,KAAtB;;AAEA,MAAA,KAAI,CAAC,UAAL,CAAgB,KAAhB;AACH,KAxBO;;AA0BA,IAAA,KAAA,CAAA,kBAAA,GAA+D,UAAC,KAAD,EAAM;AACzE,UAAM,MAAM,GAAG,KAAI,CAAC,KAAL,CAAW,MAAX,KAAsB,SAAtB,GAAkC,KAAI,CAAC,KAAL,CAAW,MAA7C,GAAsD,KAAI,CAAC,KAAL,CAAW,MAAhF;AACA,UAAM,KAAK,GAAG,KAAI,CAAC,MAAnB;;AACA,UAAI,CAAC,MAAD,IAAW,KAAf,EAAsB;AAClB,QAAA,KAAI,CAAC,YAAL,CAAkB,KAAlB;AACH;;AACD,UAAM,KAAK,GAAG,KAAI,CAAC,IAAL,CAAU,SAAV,EAAd;;AACA,MAAA,KAAK,CAAC,cAAN,GAAuB,KAAvB;;AAEA,UAAI,CAAC,KAAI,CAAC,KAAL,CAAW,OAAhB,EAAyB;AACrB,QAAA,KAAK,CAAC,MAAN,CAAa,IAAb,CAAkB;AAAE,UAAA,IAAI,EAAE;AAAR,SAAlB;AACA,QAAA,KAAK,CAAC,IAAN,CAAW,OAAX,GAAqB,IAArB;AACH;;AACD,MAAA,KAAI,CAAC,IAAL,CAAU,WAAV,CAAsB,KAAtB;;AAEA,MAAA,KAAI,CAAC,UAAL,CAAgB,KAAhB;AACH,KAhBO;;AAkBA,IAAA,KAAA,CAAA,eAAA,GAAkB,UACtB,KADsB,EAEtB,KAFsB,EAEwD;AAC9E,UAAM,KAAK,GAAG,KAAI,CAAC,IAAL,CAAU,SAAV,EAAd;;AACA,MAAA,KAAK,CAAC,cAAN,GAAuB,KAAvB;;AAEA,MAAA,KAAI,CAAC,gBAAL,CAAsB,KAAtB,EAA6B,KAA7B;;AAEA,UAAI,KAAI,CAAC,KAAL,CAAW,SAAf,EAA0B;AACtB,QAAA,KAAI,CAAC,IAAL,CAAU,WAAV,CAAsB,KAAtB;AACH;;AAED,MAAA,KAAI,CAAC,UAAL,CAAgB,KAAhB;AACH,KAbO;;AAeA,IAAA,KAAA,CAAA,UAAA,GAAuD,UAAC,KAAD,EAAM;AACjE,UAAI,CAAC,KAAI,CAAC,KAAL,CAAW,OAAZ,IAAuB,KAAI,CAAC,eAAhC,EAAiD;AAC7C;AACH;;AAED,UAAM,MAAM,GAAG,KAAI,CAAC,KAAL,CAAW,MAAX,KAAsB,SAAtB,GAAkC,KAAI,CAAC,KAAL,CAAW,MAA7C,GAAsD,KAAI,CAAC,KAAL,CAAW,MAAhF;;AACA,UAAM,KAAK,GAA6B,KAAI,CAAC,IAAL,CAAU,SAAV,EAAxC;;AACM,UAAA,EAAA,GAAA,KAAA,CAAA,KAAA;AAAA,UAAE,WAAA,GAAA,EAAA,CAAA,WAAF;AAAA,UAAe,UAAA,GAAA,EAAA,CAAA,UAAf;AACN,MAAA,KAAK,CAAC,cAAN,GAAuB,KAAvB;AAEA,MAAA,KAAK,CAAC,IAAN,CAAW,OAAX,GAAqB,KAArB;AACA,MAAA,KAAK,CAAC,MAAN,CAAa,IAAb,CAAkB;AAAE,QAAA,IAAI,EAAE;AAAR,OAAlB;;AAEA,UAAI,MAAJ,EAAY;AACR,YAAI,KAAI,CAAC,KAAL,CAAW,MAAf,EAAuB;AACnB,UAAA,KAAK,CAAC,IAAN,CAAW,MAAX,GAAoB,KAApB;AACH;;AACD,QAAA,KAAK,CAAC,MAAN,CAAa,IAAb,CAAkB;AAAE,UAAA,IAAI,EAAE;AAAR,SAAlB;AACH;;AAED,UAAI,CAAC,WAAD,IAAgB,CAAC,UAAjB,IAA+B,KAAI,CAAC,KAAL,CAAW,IAA9C,EAAoD;AAChD,QAAA,KAAK,CAAC,IAAN,CAAW,IAAX,GAAkB,EAAlB;AACH;;AAED,MAAA,KAAI,CAAC,UAAL,CAAgB,KAAhB;AACH,KAzBO;;AA2BA,IAAA,KAAA,CAAA,WAAA,GAAwD,UAAC,KAAD,EAAM;AAClE,UAAI,KAAI,CAAC,eAAT,EAA0B;AACtB;AACH;;AACD,MAAA,KAAI,CAAC,IAAL,CAAU,WAAV,CAAsB,KAAtB;AACH,KALO;;AAOA,IAAA,KAAA,CAAA,aAAA,GAAgB,YAAA;AACpB,UAAI,KAAI,CAAC,MAAL,IAAe,KAAI,CAAC,KAAL,CAAW,OAA9B,EAAuC;AACnC,QAAA,KAAI,CAAC,YAAL,CAAkB,KAAI,CAAC,MAAvB;AACH;AACJ,KAJO;;AAMA,IAAA,KAAA,CAAA,aAAA,GAAgB,YAAA;AACpB,UAAI,KAAI,CAAC,KAAL,CAAW,OAAf,EAAwB;AACpB,QAAA,UAAU,CAAC,YAAA;AAAQ,cAAI,KAAI,CAAC,KAAL,CAAW,OAAf,EAAwB;AAAE,YAAA,KAAI,CAAC,YAAL,CAAkB,KAAI,CAAC,MAAvB;AAAiC;AAAE,SAAtE,EAAwE,CAAxE,CAAV;AACH;AACJ,KAJO;;AAiBA,IAAA,KAAA,CAAA,WAAA,GAAc,YAAA;AAClB,UAAI,KAAI,CAAC,MAAL,IAAe,KAAI,CAAC,MAAL,CAAY,iBAA/B,EAAkD;AAC9C,QAAA,KAAI,CAAC,MAAL,CAAY,iBAAZ,CACI,KAAI,CAAC,QAAL,CAAc,KAAd,GACM,EADN,GAEM,KAAI,CAAC,KAAL,CAAW,iBAAX,IAAgC,kBAH1C;AAKH;AACJ,KARO;;;AASX;;AAlwBG,EAAA,MAAA,CAAA,cAAA,CAAW,WAAA,CAAA,SAAX,EAAW,SAAX,EAAkB;AAHlB;;;SAGA,YAAA;AACI,aAAO,KAAK,QAAZ;AACH,KAFiB;oBAAA;;AAAA,GAAlB;AAOA,EAAA,MAAA,CAAA,cAAA,CAAW,WAAA,CAAA,SAAX,EAAW,OAAX,EAAgB;AAHhB;;;SAGA,YAAA;AACI,UAAM,MAAM,GAAe,EAA3B;;AAEA,UAAI,KAAK,yBAAT,EAAoC;AAChC,QAAA,MAAM,CAAC,IAAP,CAAW,KAAX,CAAA,MAAA,EAAe,KAAK,yBAApB;AACH,OAFD,MAEO,IAAI,KAAK,KAAL,CAAW,KAAf,EAAsB;AACzB,QAAA,MAAM,CAAC,IAAP,CAAW,KAAX,CAAA,MAAA,EAAe,KAAK,KAAL,CAAW,KAA1B;AACH,OAFM,MAEA,IAAI,KAAK,KAAL,CAAW,KAAf,EAAsB;AACzB,QAAA,MAAM,CAAC,IAAP,CAAW,KAAX,CAAA,MAAA,EAAe,KAAK,KAAL,CAAW,KAA1B;AACH,OAFM,MAEA,IAAI,KAAK,KAAL,CAAW,YAAf,EAA6B;AAChC,QAAA,MAAM,CAAC,IAAP,CAAW,KAAX,CAAA,MAAA,EAAe,KAAK,KAAL,CAAW,YAA1B;AACH;;AAED,aAAO,MAAP;AACH,KAde;oBAAA;;AAAA,GAAhB;AAmBA,EAAA,MAAA,CAAA,cAAA,CAAW,WAAA,CAAA,SAAX,EAAW,MAAX,EAAe;AAHf;;;SAGA,YAAA;AACI,aAAO,KAAK,KAAL,CAAW,IAAlB;AACH,KAFc;oBAAA;;AAAA,GAAf;AAOA,EAAA,MAAA,CAAA,cAAA,CAAW,WAAA,CAAA,SAAX,EAAW,UAAX,EAAmB;AAHnB;;;SAGA,YAAA;AACI,UAAM,WAAW,GAAG,KAAK,KAAL,CAAW,iBAAX,KAAiC,SAArD;AACA,UAAM,OAAO,GAAI,CAAC,KAAK,QAAN,IACT,KAAK,KAAL,KAAe,IAAf,IAAuB,KAAK,KAAL,CAAW,MAAX,GAAoB,CAA3C,IAAgD,KAAK,KAAL,KAAe,SADvE;AAEA,UAAM,KAAK,GAAG,KAAK,KAAL,CAAW,KAAX,KAAqB,SAArB,GAAiC,KAAK,KAAL,CAAW,KAA5C,GAAoD,OAAlE;AAEA,aAAO;AACH,QAAA,WAAW,EAAA,WADR;AAEH,QAAA,KAAK,EAAA,KAFF;AAGH,QAAA,YAAY,EAAE,KAAK,KAAL,KAAe;AAH1B,OAAP;AAKH,KAXkB;oBAAA;;AAAA,GAAnB;AAgBA,EAAA,MAAA,CAAA,cAAA,CAAc,WAAA,CAAA,SAAd,EAAc,UAAd,EAAsB;AAHtB;;;SAGA,YAAA;AACI,aAAO,KAAK,KAAL,CAAW,QAAX,KAAwB,SAAxB,GACD,KAAK,KAAL,CAAW,QADV,GAED,WAAW,CAAC,YAAZ,CAAyB,QAF/B;AAGH,KAJqB;oBAAA;;AAAA,GAAtB;AAMA,EAAA,MAAA,CAAA,cAAA,CAAc,WAAA,CAAA,SAAd,EAAc,gBAAd,EAA4B;SAA5B,YAAA;AACI,aAAO,KAAK,KAAL,CAAW,cAAX,KAA8B,SAA9B,GACD,KAAK,KAAL,CAAW,cADV,GAED,WAAW,CAAC,YAAZ,CAAyB,cAF/B;AAGH,KAJ2B;oBAAA;;AAAA,GAA5B;AAMA;;;;AAGA,EAAA,WAAA,CAAA,SAAA,CAAA,kBAAA,GAAA,UAAmB,SAAnB,EAAgD,SAAhD,EAA2E;AACjE,QAAA,EAAA,GAAA,KAAA,KAAA;AAAA,QAAE,OAAA,GAAA,EAAA,CAAA,OAAF;AAAA,QAAW,IAAA,GAAA,EAAA,CAAA,IAAX;AACN,QAAM,IAAI,GAAG,OAAO,GAAG,OAAO,CAAC,IAAX,GAAkB,CAAtC;AACA,QAAM,SAAS,GAAG,SAAS,CAAC,OAAV,GAAoB,SAAS,CAAC,OAAV,CAAkB,KAAtC,GAA8C,CAAhE;AACA,QAAM,MAAM,GAAG,KAAK,KAAL,CAAW,MAAX,KAAsB,SAAtB,GAAkC,KAAK,KAAL,CAAW,MAA7C,GAAsD,KAAK,KAAL,CAAW,MAAhF;AACA,QAAM,UAAU,GAAG,SAAS,CAAC,MAAV,KAAqB,SAArB,GAAiC,SAAS,CAAC,MAA3C,GAAoD,SAAS,CAAC,MAAjF;AACA,QAAM,OAAO,GAAG,CAAC,UAAD,IAAe,MAA/B;AACA,QAAM,OAAO,GAAG,UAAU,IAAI,CAAC,MAA/B;AACA,QAAM,aAAa,GAAG,KAAK,IAAL,CAAU,gBAAV,EAAtB;;AAEA,QAAI,CAAC,aAAa,CAAC,OAAf,IAA0B,OAA9B,EAAuC;AACnC,WAAK,aAAL;AACH;;AAED,QAAI,OAAO,IAAI,OAAO,CAAC,KAAR,KAAkB,SAAjC,EAA4C;AACxC,WAAK,IAAL,CAAU,EAAV,CAAa,uBAAb;AACA,WAAK,IAAL,CAAU,EAAV,CAAa,KAAb;AACH,KAHD,MAGO;AACG,UAAA,EAAA,GAAA,KAAA,eAAA,EAAA;AAAA,UAAE,WAAA,GAAA,EAAA,CAAA,WAAF;AAAA,UAAe,YAAA,GAAA,EAAA,CAAA,YAAf;;AACN,UAAM,kBAAkB,GAAG,YAAY,KAAK,SAAjB,IAA8B,SAAS,CAAC,YAAV,KAA2B,YAApF;AACQ,UAAA,QAAA,GAAA,SAAA,CAAA,IAAA;;AACR,UAAI,OAAO,IAAI,OAAf,EAAwB;AACpB,aAAK,IAAL,CAAU,mBAAV,CAA8B,OAA9B,EAAuC,YAAY,GAAG,IAAtD;AACH,OAFD,MAEO,IAAI,OAAO,IAAI,CAAC,OAAhB,EAAyB;AAC5B,aAAK,IAAL,CAAU,YAAV,CAAuB,YAAvB;AACH,OAFM,MAEA,IAAI,MAAM,IAAI,UAAV,IAAwB,WAAxB,KAAwC,kBAAkB,IAAI,QAAQ,KAAK,IAA3E,CAAJ,EAAsF;AACzF,aAAK,IAAL,CAAU,YAAV,CAAuB,YAAY,GAAG,IAAtC;AACH;AACJ;;AACD,SAAK,WAAL;AACH,GA9BD;AAgCA;;;;;AAGA,EAAA,WAAA,CAAA,SAAA,CAAA,iBAAA,GAAA,YAAA;AACI,SAAK,IAAL,CAAU,QAAV;AACA,SAAK,WAAL;AACH,GAHD;AA6DA;;;;;AAGA,EAAA,WAAA,CAAA,SAAA,CAAA,UAAA,GAAA,UAAW,KAAX,EAA4C,OAA5C,EAA2D;AACjD,QAAA,EAAA,GAAA,KAAA,KAAA;AAAA,QAAE,WAAA,GAAA,EAAA,CAAA,WAAF;AAAA,QAAe,EAAA,GAAA,EAAA,CAAA,IAAf;AAAA,QAAe,IAAA,GAAA,EAAA,KAAA,KAAA,CAAA,GAAA,EAAA,GAAA,EAAf;AACN,QAAM,MAAM,GAAG,KAAK,KAAL,CAAW,MAAX,KAAsB,SAAtB,GAAkC,KAAK,KAAL,CAAW,MAA7C,GAAsD,KAAK,KAAL,CAAW,MAAhF;AACA,QAAM,IAAI,GAAG,KAAK,KAAL,CAAW,MAAX,KAAsB,SAAtB,GAAkC,KAAK,KAAL,CAAW,MAA7C,GAAsD,KAAK,KAAL,CAAW,IAA9E;;AACM,QAAA,EAAA,GAAA,KAAA,eAAA,EAAA;AAAA,QAAE,WAAA,GAAA,EAAA,CAAA,WAAF;AAAA,QAAe,YAAA,GAAA,EAAA,CAAA,YAAf;;AACN,QAAM,UAAU,GAAG,WAAW,IAAI,IAAlC;AACA,QAAM,iBAAiB,GAAG,QAAQ,CAAC,WAAD,CAAlC;AAEA,QAAM,IAAI,GAAG,KAAK,IAAlB;AACA,QAAM,EAAE,GAAG,IAAI,CAAC,EAAhB;;AAEA,QAAI,MAAM,IAAI,OAAO,KAAK,IAAI,CAAC,EAA3B,IAAiC,iBAArC,EAAwD;AACpD,UAAI,KAAK,KAAL,CAAW,YAAX,KAA4B,SAAhC,EAA2C;AACvC,QAAA,KAAK,CAAC,IAAN,CAAW,YAAX,GAA0B,SAA1B;AACH;AACJ,KAJD,MAIO;AACH,UAAM,UAAU,GAAG,IAAI,CAAC,UAAL,CAAgB,QAAhB,CAAyB;AACxC,QAAA,OAAO,EAAE,OAD+B;AAExC,QAAA,OAAO,EAAE,YAF+B;AAGxC,QAAA,GAAG,EAAE,CAAC,EAAE,CAAC,OAAH,GAAa,EAAE,CAAC,KAAhB,GAAwB,IAAI,CAAC,MAA9B,IAAwC,CAHL;AAIxC,QAAA,GAAG,EAAE,UAAU,GAAG,CAAC,CAAJ,GAAQ;AAJiB,OAAzB,CAAnB;;AAOA,UAAI,UAAU,KAAK,SAAnB,EAA8B;AAC1B,aAAK,SAAL,CAAe,UAAf,EAA2B,KAA3B;AACH;AACJ;;AAED,SAAK,UAAL,CAAgB,KAAhB;AACH,GA7BD;AAuDA;;;;;AAGA,EAAA,WAAA,CAAA,SAAA,CAAA,MAAA,GAAA,YAAA;AAAA,QAAA,KAAA,GAAA,IAAA;;AACU,QAAA,EAAA,GAAA,KAAA,KAAA;AAAA,QAAE,KAAA,GAAA,EAAA,CAAA,KAAF;AAAA,QAAS,SAAA,GAAA,EAAA,CAAA,SAAT;AAAA,QAAoB,KAAA,GAAA,EAAA,CAAA,KAApB;AAAA,QAA2B,GAAA,GAAA,EAAA,CAAA,GAA3B;AAAA,QAAgC,QAAA,GAAA,EAAA,CAAA,QAAhC;AAAA,QAA0C,IAAA,GAAA,EAAA,CAAA,IAA1C;AAAA,QAAgD,SAAA,GAAA,EAAA,CAAA,SAAhD;AAAA,QAA2D,WAAA,GAAA,EAAA,CAAA,WAA3D;AAAA,QAAwE,OAAA,GAAA,EAAA,CAAA,OAAxE;AACA,QAAA,EAAA,GAAA,KAAA,KAAA;AAAA,QAAE,OAAA,GAAA,EAAA,CAAA,OAAF;AAAA,QAAW,IAAA,GAAA,EAAA,CAAA,IAAX;AAAA,QAAiB,UAAA,GAAA,EAAA,CAAA,UAAjB;AACN,QAAM,EAAE,GAAG,KAAK,IAAL,CAAU,EAArB;AACA,QAAM,EAAE,GAAG,KAAK,KAAL,CAAW,EAAX,IAAiB,KAAK,QAAjC;AAEA,IAAA,EAAE,CAAC,OAAH,GAAa,OAAO,KAAK,SAAzB;;AACA,QAAI,OAAO,KAAK,SAAhB,EAA2B;AACvB,MAAA,EAAE,CAAC,IAAH,GAAU,OAAO,CAAC,IAAlB;AACA,MAAA,EAAE,CAAC,KAAH,GAAW,OAAO,CAAC,KAAnB;AACA,MAAA,EAAE,CAAC,QAAH,GAAc,OAAO,CAAC,QAAtB;AACH;;AACD,QAAI,YAAY,GAAmB,EAAnC;;AACA,QAAI,IAAI,KAAK,SAAb,EAAwB;AACpB,WAAK,KAAL,CAAW,OAAX,CAAmB,UAAC,IAAD,EAAK;AACpB,QAAA,YAAY,CAAC,IAAb,CAAkB;AAAE,UAAA,IAAI,EAAE,YAAY,CAAC,IAAD,EAAO,SAAP,CAApB;AAAuC,UAAA,IAAI,EAAE,CAAC,IAAD;AAA7C,SAAlB;AACH,OAFD;AAGH,KAJD,MAIO;AACH,MAAA,YAAY,CAAC,IAAb,CAAiB,KAAjB,CAAA,YAAA,EAAqB,IAArB;AACH;;AACD,SAAK,QAAL,CAAc,YAAd,EAA4B,KAAK,KAAjC;AAEA,QAAM,OAAO,GAAG,CAAC,KAAK,cAAN,IAAwB,KAAK,QAAL,CAAc,KAAtD;AAEA,QAAM,SAAS,GACX,KAAA,CAAA,aAAA,CAAA,MAAA,EAAA;AACI,MAAA,GAAG,EAAE,UAAA,QAAA,EAAQ;AAAI,eAAA,KAAI,CAAC,QAAL,GAAA,QAAA;AAAwB,OAD7C;AAEI,MAAA,SAAS,EAAE,UAAU,CAAC,iCAAD,EAAoC,SAApC,EAA+C;AAChE,2BAAmB,OAAO,IAAI,CAAC,QADiC;AAEhE,2BAAmB,CAAC,OAF4C;AAGhE,4BAAoB;AAH4C,OAA/C,CAFzB;AAOI,MAAA,KAAK,EAAE,CAAC,KAAD,GACD,KADC,GAEF,QAAA,CAAA,EAAA,EAAM,KAAN,EAAW;AAAE,QAAA,KAAK,EAAE;AAAT,OAAX,CATT;AAUI,MAAA,GAAG,EAAE,GAVT;AAWI,MAAA,OAAO,EAAE,KAAK,WAXlB;AAYI,MAAA,MAAM,EAAE,KAAK;AAZjB,KAAA,EAcI,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA;AACI,MAAA,OAAO,EAAE,KAAK,kBADlB;AAEI,MAAA,GAAG,EAAE,UAAA,OAAA,EAAO;AAAI,eAAA,KAAI,CAAC,IAAL,CAAU,OAAV,GAAA,OAAA;AAA2B,OAF/C;AAGI,MAAA,SAAS,EAAC,gCAHd;AAII,MAAA,WAAW,EAAE;AAJjB,KAAA,EAMK,YAAY,CAAC,MAAb,GAAsB,CAAtB,IAA2B,KAAA,CAAA,aAAA,CAAC,OAAD,EAAQ;AAChC,MAAA,SAAS,EAAE,KAAK,KAAL,CAAW,SADU;AAEhC,MAAA,WAAW,EAAE,KAAK,WAFc;AAGhC,MAAA,IAAI,EAAE,YAH0B;AAIhC,MAAA,IAAI,EAAE,KAAK,IAAL,CAAU,IAJgB;AAKhC,MAAA,OAAO,EAAE,UAAU,GAAG,YAAY,CAAC,IAAb,CAAkB,UAAA,CAAA,EAAC;AAAI,eAAA,SAAS,CAAC,CAAD,EAAI,UAAJ,EAAT,WAAS,CAAT;AAAqC,OAA5D,CAAH,GAAmE;AALtD,KAAR,CANhC,EAaK,KAAK,eAAL,CAAqB,EAArB,CAbL,EAcK,KAAK,KAAL,CAAW,OAAX,IAAsB,KAAA,CAAA,aAAA,CAAA,MAAA,EAAA;AAAM,MAAA,SAAS,EAAC;AAAhB,KAAA,CAd3B,CAdJ,EA8BK,KAAK,mBAAL,EA9BL,CADJ;AAmCA,WAAO,KAAK,GACR,KAAA,CAAA,aAAA,CAAC,aAAD,EAAc;AACV,MAAA,KAAK,EAAE,KADG;AAEV,MAAA,QAAQ,EAAE,EAFA;AAGV,MAAA,WAAW,EAAE,IAAI,IAAI,YAAY,CAAC,KAAK,KAAL,CAAW,CAAX,CAAD,EAAgB,SAAhB,CAHvB;AAIV,MAAA,WAAW,EAAE,OAJH;AAKV,MAAA,cAAc,EAAE,QALN;AAMV,MAAA,KAAK,EAAE;AAAE,QAAA,KAAK,EAAE,KAAK,GAAG,KAAK,CAAC,KAAT,GAAiB;AAA/B,OANG;AAOV,MAAA,QAAQ,EAAE;AAPA,KAAd,CADQ,GAUR,SAVJ;AAWH,GAtED;;AAwEQ,EAAA,WAAA,CAAA,SAAA,CAAA,eAAA,GAAR,UAAwB,EAAxB,EAAkC;AACxB,QAAA,EAAA,GAAA,KAAA,KAAA;AAAA,QAAE,gBAAA,GAAA,EAAA,CAAA,gBAAF;AAAA,QAAoB,UAAA,GAAA,EAAA,CAAA,UAApB;AACA,QAAA,EAAA,GAAA,KAAA,KAAA;AAAA,QAAE,QAAA,GAAA,EAAA,CAAA,QAAF;AAAA,QAAY,WAAA,GAAA,EAAA,CAAA,WAAZ;AACN,QAAM,IAAI,GAAG,CAAC,KAAK,KAAL,CAAW,MAAX,KAAsB,SAAtB,GAAkC,KAAK,KAAL,CAAW,MAA7C,GAAsD,KAAK,KAAL,CAAW,IAAlE,KAA2E,EAAxF;AACA,QAAM,MAAM,GAAG,KAAK,KAAL,CAAW,MAAX,KAAsB,SAAtB,GAAkC,KAAK,KAAL,CAAW,MAA7C,GAAsD,KAAK,KAAL,CAAW,MAAhF;AACQ,QAAA,YAAA,GAAA,KAAA,eAAA,GAAA,YAAA;AACR,QAAM,WAAW,GAAG,CAAC,CAAC,IAAF,IAAU,KAAK,KAAL,CAAW,MAAX,GAAoB,CAAlD;AACA,QAAM,iBAAiB,GAAG,KAAK,KAAL,CAAW,MAAX,KAAsB,CAAtB,IAA2B,CAAC,IAA5B,GAAmC,WAAnC,GAAiD,SAA3E;AACA,QAAM,oBAAoB,GAAG,gBAAgB,KAAK,gBAAgB,CAAC,QAAtC,IAAkD,UAAU,KAAK,SAAjE,GACzB,SAAO,KAAK,IAAL,CAAU,IAAjB,GAAqB,GAArB,GAAyB,UAAU,CAAC,IAAX,CAAgB,OAAhB,CAAwB,MAAxB,EAAgC,GAAhC,CADA,GAEzB,YAAU,KAAK,IAAL,CAAU,IAApB,GAAwB,GAAxB,GAA4B,YAFhC;AAIA,WACI,KAAA,CAAA,aAAA,CAAC,SAAD,EAAU;AACN,MAAA,EAAE,EAAE,EADE;AAEN,MAAA,IAAI,EAAE,IAAI,CAAC,GAAL,CAAS,CAAC,iBAAiB,IAAI,EAAtB,EAA0B,MAAnC,EAA2C,IAAI,CAAC,MAAhD,EAAwD,CAAxD,CAFA;AAGN,MAAA,QAAQ,EAAE,KAAK,KAAL,CAAW,QAHf;AAIN,MAAA,SAAS,EAAE,KAAK,KAAL,CAAW,SAJhB;AAKN,MAAA,WAAW,EAAE,iBALP;AAMN,MAAA,KAAK,EAAE,IAND;AAON,MAAA,QAAQ,EAAE,KAAK,eAPT;AAQN,MAAA,SAAS,EAAE,KAAK,cARV;AASN,MAAA,GAAG,EAAE,KAAK,YATJ;AAUN,MAAA,QAAQ,EAAE,QAVJ;AAWN,MAAA,QAAQ,EAAE,MAXJ;AAYN,MAAA,IAAI,EAAE,KAAK,IAAL,CAAU,SAZV;AAaN,MAAA,gBAAgB,EAAE,oBAbZ;AAcN,MAAA,eAAe,EAAE,cAAY,KAAK,IAAL,CAAU,IAAtB,GAA0B,GAA1B,IAA8B,KAAK,KAAL,CAAW,eAAX,IAA8B,EAA5D,CAdX;AAeN,MAAA,WAAW,EAAE,WAfP;AAgBN,MAAA,gBAAgB,EAAE,KAAK,gBAhBjB;AAiBN,MAAA,cAAc,EAAE,KAAK,KAAL,CAAW;AAjBrB,KAAV,CADJ;AAqBH,GAjCO;;AAuIA,EAAA,WAAA,CAAA,SAAA,CAAA,cAAA,GAAR,UAAuB,KAAvB,EAAqE,KAArE,EAAoG;AAChG,QAAM,OAAO,GAAG,KAAK,CAAC,OAAtB;AACQ,QAAA,UAAA,GAAA,KAAA,KAAA,CAAA,UAAA;AACR,QAAM,IAAI,GAAG,KAAK,KAAlB;AACA,QAAM,QAAQ,GAAG,KAAK,KAAL,CAAW,WAA5B;AACA,QAAI,YAAY,GAAG,UAAU,GACzB,IAAI,CAAC,SAAL,CAAe,UAAA,CAAA,EAAC;AAAI,aAAA,SAAS,CAAC,CAAD,EAAI,UAAJ,EAAT,QAAS,CAAT;AAAkC,KAAtD,CADyB,GACiC,CAAC,CAD/D;AAEA,QAAI,aAAa,GAAwB,SAAzC;AACA,QAAM,UAAU,GAAG,YAAY,KAAK,CAAC,CAArC;;AAEA,QAAI,OAAO,KAAK,IAAI,CAAC,IAArB,EAA2B;AACvB,UAAI,UAAJ,EAAgB;AACZ,QAAA,YAAY,GAAG,IAAI,CAAC,GAAL,CAAS,CAAT,EAAY,YAAY,GAAG,CAA3B,CAAf;AACH,OAFD,MAEO;AACH,QAAA,YAAY,GAAG,IAAI,CAAC,MAAL,GAAc,CAA7B;AACH;;AACD,MAAA,aAAa,GAAG,IAAI,CAAC,YAAD,CAApB;AACH,KAPD,MAOO,IAAI,OAAO,KAAK,IAAI,CAAC,KAArB,EAA4B;AAC/B,UAAI,YAAY,KAAK,IAAI,CAAC,MAAL,GAAc,CAAnC,EAAsC;AAClC,QAAA,aAAa,GAAG,SAAhB;AACH,OAFD,MAEO,IAAI,UAAJ,EAAgB;AACnB,QAAA,YAAY,GAAG,IAAI,CAAC,GAAL,CAAS,IAAI,CAAC,MAAL,GAAc,CAAvB,EAA0B,YAAY,GAAG,CAAzC,CAAf;AACA,QAAA,aAAa,GAAG,IAAI,CAAC,YAAD,CAApB;AACH;AACJ,KAPM,MAOA,IAAI,OAAO,KAAK,IAAI,CAAC,IAArB,EAA2B;AAC9B,MAAA,aAAa,GAAG,IAAI,CAAC,CAAD,CAApB;AACH,KAFM,MAEA,IAAI,OAAO,KAAK,IAAI,CAAC,GAArB,EAA0B;AAC7B,MAAA,aAAa,GAAG,IAAI,CAAC,IAAI,CAAC,MAAL,GAAc,CAAf,CAApB;AACH,KAFM,MAEA,IAAI,OAAO,KAAK,IAAI,CAAC,MAArB,EAA6B;AAChC,UAAI,UAAJ,EAAgB;AACZ,YAAM,KAAK,GAAG,KAAK,KAAnB;AACA,QAAA,eAAe,CAAC,KAAD,EAAQ,IAAI,CAAC,YAAD,CAAJ,CAAmB,IAA3B,EAAiC,QAAjC,CAAf;AACA,aAAK,eAAL,CAAqB,KAArB,EAA4B,KAA5B;AACH;AACJ,KANM,MAMA,IAAI,OAAO,KAAK,IAAI,CAAC,SAArB,EAAgC;AACnC,UAAM,KAAK,GAAG,KAAK,KAAnB;;AACA,UAAI,UAAJ,EAAgB;AACZ,QAAA,eAAe,CAAC,KAAD,EAAQ,IAAI,CAAC,YAAD,CAAJ,CAAmB,IAA3B,EAAiC,QAAjC,CAAf;AACA,aAAK,eAAL,CAAqB,KAArB,EAA4B,KAA5B;AACH,OAHD,MAGO,IAAI,CAAC,UAAD,IAAe,IAAI,CAAC,MAAxB,EAAgC;AACnC,YAAM,OAAO,GAAG,IAAI,CAAC,GAAL,EAAhB;AACA,QAAA,eAAe,CAAC,KAAD,EAAQ,OAAO,CAAC,IAAhB,EAAsB,QAAtB,CAAf;AACA,aAAK,eAAL,CAAqB,KAArB,EAA4B,KAA5B;AACH;AACJ;;AAED,QAAI,aAAa,KAAK,UAAtB,EAAkC;AAC9B,MAAA,KAAK,CAAC,IAAN,CAAW,UAAX,GAAwB,aAAxB;AACA,MAAA,KAAK,CAAC,IAAN,CAAW,gBAAX,GAA8B,gBAAgB,CAAC,QAA/C;AACH;;AAED,SAAK,UAAL,CAAgB,KAAhB;AACH,GApDO;;AAsDA,EAAA,WAAA,CAAA,SAAA,CAAA,eAAA,GAAR,UAAwB,KAAxB,EAA2C,KAA3C,EAA0E;AACtE,QAAI,KAAK,KAAL,CAAW,KAAX,KAAqB,SAAzB,EAAoC;AAChC,MAAA,KAAK,CAAC,IAAN,CAAW,KAAX,GAAuB,KAAK,CAAA,KAAL,EAAvB;AACH;;AAED,SAAK,yBAAL,GAAiC,EAAjC;AACA,SAAK,QAAL,CAAc,KAAd,EAAqB,KAAK,yBAA1B;AAEA,IAAA,KAAK,CAAC,MAAN,CAAa,IAAb,CAAkB;AAAE,MAAA,IAAI,EAAE;AAAR,KAAlB;AACH,GATO;;AAWA,EAAA,WAAA,CAAA,SAAA,CAAA,iBAAA,GAAR,UAA0B,KAA1B,EAAsE;AAC5D,QAAA,EAAA,GAAA,KAAA,KAAA;AAAA,QAAE,EAAA,GAAA,EAAA,CAAA,IAAF;AAAA,QAAE,IAAA,GAAA,EAAA,KAAA,KAAA,CAAA,GAAA,EAAA,GAAA,EAAF;AAAA,QAAa,OAAA,GAAA,EAAA,CAAA,OAAb;AACE,QAAA,YAAA,GAAA,KAAA,eAAA,GAAA,YAAA;AACR,QAAM,IAAI,GAAG,OAAO,GAAG,OAAO,CAAC,IAAX,GAAkB,CAAtC;;AAEA,QAAI,IAAI,CAAC,YAAY,GAAG,IAAhB,CAAJ,KAA8B,SAAlC,EAA6C;AACzC,WAAK,eAAL,CAAqB,YAArB,EAAmC,KAAnC;AACH;AACJ,GARO;;AAUA,EAAA,WAAA,CAAA,SAAA,CAAA,QAAA,GAAR,UAAiB,QAAjB,EAAuC,SAAvC,EAA4D;AACxD,IAAA,SAAS,CAAC,MAAV,GAAmB,CAAnB;AACA,IAAA,SAAS,CAAC,IAAV,CAAc,KAAd,CAAA,SAAA,EAAkB,QAAlB;AACH,GAHO;;AAKA,EAAA,WAAA,CAAA,SAAA,CAAA,eAAA,GAAR,YAAA;AACY,QAAA,YAAA,GAAA,KAAA,KAAA,CAAA,YAAA;AACR,QAAM,IAAI,GAAG,KAAK,KAAL,CAAW,MAAX,KAAsB,SAAtB,GAAkC,KAAK,KAAL,CAAW,MAA7C,GAAsD,KAAK,KAAL,CAAW,IAA9E;AACM,QAAA,EAAA,GAAA,KAAA,KAAA;AAAA,QAAE,WAAA,GAAA,EAAA,CAAA,WAAF;AAAA,QAAe,EAAA,GAAA,EAAA,CAAA,IAAf;AAAA,QAAe,IAAA,GAAA,EAAA,KAAA,KAAA,CAAA,GAAA,EAAA,GAAA,EAAf;AAAA,QAA0B,WAAA,GAAA,EAAA,CAAA,WAA1B;AAAA,QAAuC,OAAA,GAAA,EAAA,CAAA,OAAvC;AAAA,QAAgD,SAAA,GAAA,EAAA,CAAA,SAAhD;AAAA,QAA2D,EAAA,GAAA,EAAA,CAAA,gBAA3D;AAAA,QAA2D,gBAAA,GAAA,EAAA,KAAA,KAAA,CAAA,GAAA,mBAAA,GAAA,EAA3D;AACN,QAAM,IAAI,GAAI,OAAO,IAAI,OAAO,CAAC,IAApB,IAA6B,CAA1C;AACA,QAAI,UAAJ;;AAEA,QAAI,YAAY,KAAK,SAArB,EAAgC;AAC5B,aAAO;AACH,QAAA,YAAY,EAAE,YADX;AAEH,QAAA,WAAW,EAAE,IAAI,CAAC,YAAY,GAAG,IAAhB,CAFd;AAGH,QAAA,WAAW,EAAE,eAAe,CAAC;AAH1B,OAAP;AAKH;;AACD,QAAM,QAAQ,GAAG,KAAK,KAAtB;;AAEA,QAAI,WAAW,IAAI,IAAnB,EAAyB;AACrB,aAAO;AAAE,QAAA,WAAW,EAAE,IAAf;AAAqB,QAAA,YAAY,EAAE,CAAC,CAApC;AAAuC,QAAA,WAAW,EAAE,eAAe,CAAC;AAApE,OAAP;AACH,KAFD,MAEO,IAAI,IAAJ,EAAU;AACb,MAAA,UAAU,GAAG,gBAAgB,CAAC,IAAD,EAAO,IAAP,EAAa,SAAb,CAA7B;AACA,aAAO;AACH,QAAA,WAAW,EAAE,IAAI,CAAC,UAAD,CADd;AAEH,QAAA,YAAY,EAAE,UAAU,GAAG,IAFxB;AAGH,QAAA,WAAW,EAAE,eAAe,CAAC;AAH1B,OAAP;AAKH,KAPM,MAOA,IAAI,QAAQ,CAAC,MAAb,EAAqB;AACxB,UAAM,MAAI,GAAG,QAAQ,CAAC,QAAQ,CAAC,MAAT,GAAkB,CAAnB,CAArB;AACA,MAAA,UAAU,GAAG,IAAI,CAAC,SAAL,CAAe,UAAA,CAAA,EAAC;AAAI,eAAA,OAAO,CAAC,CAAD,EAAI,MAAJ,EAAP,WAAO,CAAP;AAA6B,OAAjD,CAAb;;AACA,UAAI,IAAI,CAAC,UAAD,CAAJ,KAAqB,SAAzB,EAAoC;AAChC,eAAO;AACH,UAAA,YAAY,EAAE,UAAU,GAAG,IADxB;AAEH,UAAA,WAAW,EAAE,IAAI,CAAC,UAAD,CAFd;AAGH,UAAA,WAAW,EAAE,eAAe,CAAC;AAH1B,SAAP;AAKH;;AACD,aAAO;AAAE,QAAA,WAAW,EAAE,eAAe,CAAC,IAA/B;AAAqC,QAAA,YAAY,EAAE,CAAC;AAApD,OAAP;AACH;;AAED,WAAO,IAAI,KAAK,CAAT,GACH;AAAE,MAAA,WAAW,EAAE,IAAI,CAAC,CAAD,CAAnB;AAAwB,MAAA,YAAY,EAAE,CAAtC;AAAyC,MAAA,WAAW,EAAE,eAAe,CAAC;AAAtE,KADG,GAEH;AAAE,MAAA,WAAW,EAAE,eAAe,CAAC,IAA/B;AAAqC,MAAA,YAAY,EAAE,CAAC;AAApD,KAFJ;AAGH,GAzCO;;AAkPA,EAAA,WAAA,CAAA,SAAA,CAAA,YAAA,GAAR,UAAqB,OAArB,EAAiC;AAAjC,QAAA,KAAA,GAAA,IAAA;;AACI,SAAK,eAAL,GAAuB,IAAvB;AACA,IAAA,OAAO,CAAC,KAAR;AACA,IAAA,UAAU,CAAC,YAAA;AAAM,aAAA,KAAI,CAAC,eAAL,GAAA,KAAA;AAA4B,KAAnC,EAAqC,EAArC,CAAV;AACH,GAJO;;AAMA,EAAA,WAAA,CAAA,SAAA,CAAA,UAAA,GAAR,UAAmB,KAAnB,EAAkD;AAC9C,SAAK,IAAL,CAAU,UAAV,CAAqB,KAArB;AACA,SAAK,yBAAL,GAAiC,IAAjC;AACH,GAHO;AA7yBR;;;;;AAGO,EAAA,WAAA,CAAA,SAAA,GAAS,QAAA,CAAA,EAAA,EACT,YAAY,CAAC,SADJ,EACa;AAEzB,IAAA,SAAS,EAAE,SAAS,CAAC,IAFI;AAGzB,IAAA,KAAK,EAAE,SAAS,CAAC,OAAV,CAAkB,SAAS,CAAC,GAA5B,CAHkB;AAIzB,IAAA,YAAY,EAAE,SAAS,CAAC,OAAV,CAAkB,SAAS,CAAC,GAA5B,CAJW;AAKzB,IAAA,WAAW,EAAE,SAAS,CAAC,MALE;AAMzB,IAAA,WAAW,EAAE,SAAS,CAAC,MANE;AAOzB,IAAA,IAAI,EAAE,SAAS,CAAC,OAAV,CAAkB,SAAS,CAAC,KAAV,CAAgB;AACpC,MAAA,IAAI,EAAE,SAAS,CAAC,MADoB;AAEpC,MAAA,IAAI,EAAE,SAAS,CAAC,OAAV,CAAkB,SAAS,CAAC,GAA5B;AAF8B,KAAhB,CAAlB,CAPmB;AAWzB,IAAA,SAAS,EAAE,SAAS,CAAC,IAXI;AAYzB,IAAA,EAAE,EAAE,SAAS,CAAC,MAZW;AAazB,IAAA,cAAc,EAAE,SAAS,CAAC,MAbD;AAczB,IAAA,eAAe,EAAE,SAAS,CAAC;AAdF,GADb,CAAT;AAkBP;;;;AAGO,EAAA,WAAA,CAAA,YAAA,GAAY,QAAA,CAAA,EAAA,EACZ,YAAY,CAAC,YADD,EACa;AAC5B,IAAA,SAAS,EAAE,IADiB;AAE5B,IAAA,QAAQ,EAAE;AAFkB,GADb,CAAZ;AAmyBX,SAAA,WAAA;AAAC,CA5zBD,CAAyC,KAAK,CAAC,SAA/C,CAAA;;eAAqB,W","sourceRoot":"","sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport * as React from 'react';\nimport * as PropTypes from 'prop-types';\nimport { classNames, Keys, guid } from '@progress/kendo-react-common';\nimport { FloatingLabel } from '@progress/kendo-react-labels';\nimport ListContainer from '../common/ListContainer';\nimport List from '../common/List';\nimport TagList from './TagList';\nimport SearchBar from '../common/SearchBar';\nimport DropDownBase from '../common/DropDownBase';\nimport { ActiveDescendant } from './../common/settings';\nimport { itemIndexStartsWith, getItemValue, areSame, matchDataCollections, removeDataItems, isPresent, preventDefaultNonInputs } from '../common/utils';\nvar VALIDATION_MESSAGE = 'Please enter a valid value!';\nvar preventDefault = function (event) { return event.preventDefault(); };\nvar matchTags = function (tag1, tag2, key) {\n    if (!!tag1 !== !!tag2 || tag1.text !== tag2.text) {\n        return false;\n    }\n    return tag1 === tag2 || matchDataCollections(tag1.data, tag2.data, key);\n};\nvar isCustom = function (type) { return type === FocusedItemType.CustomItem; };\nvar FocusedItemType;\n(function (FocusedItemType) {\n    FocusedItemType[FocusedItemType[\"None\"] = 0] = \"None\";\n    FocusedItemType[FocusedItemType[\"ListItem\"] = 1] = \"ListItem\";\n    FocusedItemType[FocusedItemType[\"CustomItem\"] = 2] = \"CustomItem\";\n})(FocusedItemType || (FocusedItemType = {}));\n/**\n * Represents the [KendoReact MultiSelect component]({% slug overview_multiselect %}).\n *\n * @example\n * ```jsx\n * class App extends React.Component {\n *    multiselect = null;\n *    render() {\n *       return (\n *          <div>\n *              <MultiSelect\n *                  data={[ \"Albania\", \"Andorra\", \"Austria\", \"Belarus\" ]}\n *                  ref={component => this.multiselect = component}\n *              />\n *              <button onClick={() => alert(this.multiselect.value)}>alert value</button>\n *          </div>\n *       );\n *    }\n * }\n * ReactDOM.render(<App />, document.querySelector('my-app'));\n * ```\n */\nvar MultiSelect = /** @class */ (function (_super) {\n    __extends(MultiSelect, _super);\n    function MultiSelect() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        /**\n         * @hidden\n         */\n        _this.state = {\n            activedescendant: ActiveDescendant.PopupList\n        };\n        _this._valueItemsDuringOnChange = null;\n        _this._inputId = guid();\n        _this.base = new DropDownBase(_this);\n        _this._tags = [];\n        _this._skipFocusEvent = false;\n        /**\n         * @hidden\n         */\n        _this.focus = function () {\n            if (_this._input) {\n                _this._input.focus();\n            }\n        };\n        /**\n         * @hidden\n         */\n        _this.handleItemSelect = function (index, state) {\n            var _a = _this.props, _b = _a.data, data = _b === void 0 ? [] : _b, dataItemKey = _a.dataItemKey, virtual = _a.virtual;\n            var skip = virtual ? virtual.skip : 0;\n            var dataItem = data[index - skip];\n            var indexInValue = _this.value.findIndex(function (i) { return areSame(i, dataItem, dataItemKey); });\n            var newItems = [];\n            if (indexInValue !== -1) { // item is already selected\n                newItems = _this.value;\n                newItems.splice(indexInValue, 1);\n            }\n            else {\n                newItems = _this.value.concat([dataItem]);\n            }\n            var text = _this.props.filter !== undefined ? _this.props.filter : _this.state.text;\n            if (text) {\n                if (_this.state.text) {\n                    state.data.text = '';\n                }\n                _this.base.filterChanged('', state);\n            }\n            if (_this.state.focusedIndex !== undefined) {\n                state.data.focusedIndex = undefined;\n            }\n            _this.triggerOnChange(newItems, state);\n            _this.base.triggerPageChangeCornerItems(dataItem, state);\n        };\n        /**\n         * @hidden\n         */\n        _this.onTagDelete = function (itemsToRemove, event) {\n            var opened = _this.props.opened !== undefined ? _this.props.opened : _this.state.opened;\n            var state = _this.base.initState();\n            state.syntheticEvent = event;\n            if (opened) {\n                _this.base.togglePopup(state);\n            }\n            if (!_this.state.focused) {\n                state.data.focused = true;\n            }\n            var selected = _this.value;\n            removeDataItems(selected, itemsToRemove, _this.props.dataItemKey);\n            _this.triggerOnChange(selected, state);\n            _this.applyState(state);\n        };\n        /**\n         * @hidden\n         */\n        _this.itemFocus = function (index, state) {\n            var _a = _this.props, _b = _a.data, data = _b === void 0 ? [] : _b, allowCustom = _a.allowCustom, virtual = _a.virtual;\n            var skip = virtual ? virtual.skip : 0;\n            var text = _this.props.filter !== undefined ? _this.props.filter : _this.state.text;\n            var focusedIndex = _this.getFocusedState().focusedIndex;\n            var customItem = allowCustom && text;\n            var nextFocusedItem = data[index - skip];\n            if (nextFocusedItem && focusedIndex !== index) {\n                if (_this.state.focusedIndex !== index) {\n                    state.data.focusedIndex = index;\n                    state.data.activedescendant = ActiveDescendant.PopupList;\n                }\n            }\n            else if (customItem && index === -1) {\n                if (_this.state.focusedIndex !== undefined) {\n                    state.data.focusedIndex = undefined;\n                }\n            }\n            _this.base.triggerPageChangeCornerItems(nextFocusedItem, state);\n        };\n        _this.searchbarRef = function (searchbar) {\n            var input = _this._input = searchbar && searchbar.input;\n            if (input && _this.state.focused) {\n                setTimeout(function () { return input.focus(); }, 0);\n            }\n        };\n        _this.onChangeHandler = function (event) {\n            var state = _this.base.initState();\n            var value = event.currentTarget.value;\n            var opened = _this.props.opened !== undefined ? _this.props.opened : _this.state.opened;\n            state.syntheticEvent = event;\n            if (_this.props.filter === undefined) {\n                state.data.text = value;\n            }\n            state.data.focusedIndex = undefined;\n            if (!opened) {\n                _this.base.togglePopup(state);\n            }\n            _this.base.filterChanged(value, state);\n            _this.applyState(state);\n        };\n        _this.clearButtonClick = function (event) {\n            var opened = _this.props.opened !== undefined ? _this.props.opened : _this.state.opened;\n            var state = _this.base.initState();\n            state.syntheticEvent = event;\n            event.stopPropagation();\n            if (_this.value.length > 0) {\n                _this.triggerOnChange([], state);\n            }\n            if (_this.state.focusedIndex !== undefined) {\n                state.data.focusedIndex = undefined;\n            }\n            if (opened) {\n                _this.base.togglePopup(state);\n            }\n            var text = _this.props.filter !== undefined ? _this.props.filter : _this.state.text;\n            if (isPresent(text) && text !== '') {\n                _this.base.filterChanged('', state);\n            }\n            if (_this.state.text) {\n                state.data.text = '';\n            }\n            _this.applyState(state);\n        };\n        _this.onInputKeyDown = function (event) {\n            var keyCode = event.keyCode;\n            var text = _this.props.filter !== undefined ? _this.props.filter : _this.state.text;\n            var opened = _this.props.opened !== undefined ? _this.props.opened : _this.state.opened;\n            var focusedItem = _this.getFocusedState().focusedItem;\n            var state = _this.base.initState();\n            state.syntheticEvent = event;\n            if (!text && _this.value.length > 0 &&\n                (keyCode === Keys.left || keyCode === Keys.right ||\n                    keyCode === Keys.home || keyCode === Keys.end ||\n                    keyCode === Keys.delete || keyCode === Keys.backspace)) {\n                return _this.onTagsNavigate(event, state);\n            }\n            var togglePopup = function () {\n                event.preventDefault();\n                _this.base.togglePopup(state);\n                _this.applyState(state);\n            };\n            if (opened) {\n                if (event.altKey && keyCode === Keys.up) {\n                    togglePopup();\n                }\n                else if (keyCode === Keys.up || keyCode === Keys.down) {\n                    event.preventDefault();\n                    _this.onNavigate(state, keyCode);\n                }\n                else if (keyCode === Keys.enter) {\n                    event.preventDefault();\n                    if (_this.props.allowCustom && text && focusedItem === null) {\n                        _this.customItemSelect(event);\n                    }\n                    else {\n                        _this.selectFocusedItem(event);\n                    }\n                }\n                else if (keyCode === Keys.esc) {\n                    togglePopup();\n                }\n            }\n            else if (event.altKey && keyCode === Keys.down) {\n                togglePopup();\n            }\n        };\n        _this.renderListContainer = function () {\n            var base = _this.base;\n            var _a = _this.props, header = _a.header, footer = _a.footer, allowCustom = _a.allowCustom, dir = _a.dir;\n            var popupSettings = _this.base.getPopupSettings();\n            var opened = _this.props.opened !== undefined ? _this.props.opened : _this.state.opened;\n            var text = _this.props.filter !== undefined ? _this.props.filter : _this.state.text;\n            var virtual = _this.props.virtual !== undefined;\n            var popupWidth = popupSettings.width !== undefined ? popupSettings.width : base.popupWidth;\n            var listContainerProps = {\n                onMouseDown: preventDefault,\n                dir: dir !== undefined ? dir : base.dirCalculated,\n                onBlur: _this.handleBlur,\n                width: popupWidth,\n                popupSettings: {\n                    className: classNames('k-list-container k-reset', popupSettings.className),\n                    animate: popupSettings.animate,\n                    anchor: _this.element || undefined,\n                    show: opened,\n                    open: _this.onPopupOpened,\n                    close: _this.onPopupClosed,\n                    appendTo: popupSettings.appendTo\n                }\n            };\n            var focusedType = _this.getFocusedState().focusedType;\n            var customItem = allowCustom && text && (React.createElement(\"div\", { className: \"k-list\", key: \"customitem\", onClick: _this.customItemSelect },\n                React.createElement(\"div\", { className: classNames('k-item k-custom-item', { 'k-state-focused': isCustom(focusedType) }) },\n                    text,\n                    React.createElement(\"span\", { className: \"k-icon k-i-plus\", style: { float: 'right' } }))));\n            return (React.createElement(ListContainer, __assign({}, listContainerProps),\n                virtual && header,\n                _this.base.renderScrollWrapper(React.createElement(React.Fragment, null,\n                    !virtual && header,\n                    customItem,\n                    _this.renderList(),\n                    !virtual && footer,\n                    _this.base.renderScrollElement())),\n                virtual && footer));\n        };\n        _this.renderList = function () {\n            var _a = _this.props, _b = _a.data, data = _b === void 0 ? [] : _b, textField = _a.textField, listNoDataRender = _a.listNoDataRender, itemRender = _a.itemRender, dataItemKey = _a.dataItemKey, virtual = _a.virtual;\n            var vs = _this.base.vs;\n            var skip = virtual ? virtual.skip : 0;\n            var opened = _this.props.opened !== undefined ? _this.props.opened : _this.state.opened;\n            var focusedIndex = _this.getFocusedState().focusedIndex;\n            var popupSettings = _this.base.getPopupSettings();\n            var translate = \"translateY(\" + vs.translate + \"px)\";\n            return (React.createElement(List, { id: _this.base.listBoxId, show: opened, data: data.slice(), focusedIndex: focusedIndex - skip, value: _this.value, textField: textField, valueField: dataItemKey, optionsGuid: _this.base.guid, listRef: function (list) { return vs.list = _this.base.list = list; }, wrapperStyle: vs.enabled ?\n                    { float: 'left', width: '100%' } : { maxHeight: popupSettings.height }, wrapperCssClass: vs.enabled ? undefined : 'k-list-scroller', listStyle: vs.enabled ? { transform: translate } : undefined, key: \"listKey\", skip: skip, onClick: _this.handleItemClick, itemRender: itemRender, noDataRender: listNoDataRender }));\n        };\n        _this.customItemSelect = function (event) {\n            var _a;\n            var itemText = _this.props.filter !== undefined ? _this.props.filter : _this.state.text;\n            var textField = _this.props.textField;\n            if (!itemText) {\n                return;\n            }\n            var state = _this.base.initState();\n            state.syntheticEvent = event;\n            var item = textField ? (_a = {}, _a[textField] = itemText, _a) : itemText;\n            if (_this.state.text !== undefined) {\n                state.data.text = '';\n            }\n            state.data.focusedIndex = undefined;\n            _this.base.filterChanged('', state);\n            var newItems = _this.value.concat([item]);\n            _this.triggerOnChange(newItems, state);\n            _this.base.togglePopup(state);\n            _this.applyState(state);\n        };\n        _this.handleWrapperClick = function (event) {\n            var opened = _this.props.opened !== undefined ? _this.props.opened : _this.state.opened;\n            var input = _this._input;\n            if (!opened && input) {\n                _this.focusElement(input);\n            }\n            var state = _this.base.initState();\n            state.syntheticEvent = event;\n            if (!_this.state.focused) {\n                state.events.push({ type: 'onFocus' });\n                state.data.focused = true;\n            }\n            _this.base.togglePopup(state);\n            _this.applyState(state);\n        };\n        _this.handleItemClick = function (index, event) {\n            var state = _this.base.initState();\n            state.syntheticEvent = event;\n            _this.handleItemSelect(index, state);\n            if (_this.props.autoClose) {\n                _this.base.togglePopup(state);\n            }\n            _this.applyState(state);\n        };\n        _this.handleBlur = function (event) {\n            if (!_this.state.focused || _this._skipFocusEvent) {\n                return;\n            }\n            var opened = _this.props.opened !== undefined ? _this.props.opened : _this.state.opened;\n            var state = _this.base.initState();\n            var _a = _this.props, allowCustom = _a.allowCustom, filterable = _a.filterable;\n            state.syntheticEvent = event;\n            state.data.focused = false;\n            state.events.push({ type: 'onBlur' });\n            if (opened) {\n                if (_this.state.opened) {\n                    state.data.opened = false;\n                }\n                state.events.push({ type: 'onClose' });\n            }\n            if (!allowCustom && !filterable && _this.state.text) {\n                state.data.text = '';\n            }\n            _this.applyState(state);\n        };\n        _this.handleFocus = function (event) {\n            if (_this._skipFocusEvent) {\n                return;\n            }\n            _this.base.handleFocus(event);\n        };\n        _this.onPopupOpened = function () {\n            if (_this._input && _this.state.focused) {\n                _this.focusElement(_this._input);\n            }\n        };\n        _this.onPopupClosed = function () {\n            if (_this.state.focused) {\n                setTimeout(function () { if (_this.state.focused) {\n                    _this.focusElement(_this._input);\n                } }, 0);\n            }\n        };\n        _this.setValidity = function () {\n            if (_this._input && _this._input.setCustomValidity) {\n                _this._input.setCustomValidity(_this.validity.valid\n                    ? ''\n                    : _this.props.validationMessage || VALIDATION_MESSAGE);\n            }\n        };\n        return _this;\n    }\n    Object.defineProperty(MultiSelect.prototype, \"element\", {\n        /**\n         * @hidden\n         */\n        get: function () {\n            return this._element;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(MultiSelect.prototype, \"value\", {\n        /**\n         * Represents the value of the MultiSelect.\n         */\n        get: function () {\n            var result = [];\n            if (this._valueItemsDuringOnChange) {\n                result.push.apply(result, this._valueItemsDuringOnChange);\n            }\n            else if (this.props.value) {\n                result.push.apply(result, this.props.value);\n            }\n            else if (this.state.value) {\n                result.push.apply(result, this.state.value);\n            }\n            else if (this.props.defaultValue) {\n                result.push.apply(result, this.props.defaultValue);\n            }\n            return result;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(MultiSelect.prototype, \"name\", {\n        /**\n         * Gets the `name` property of the MultiSelect.\n         */\n        get: function () {\n            return this.props.name;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(MultiSelect.prototype, \"validity\", {\n        /**\n         * Represents the validity state into which the MultiSelect is set.\n         */\n        get: function () {\n            var customError = this.props.validationMessage !== undefined;\n            var isValid = (!this.required\n                || (this.value !== null && this.value.length > 0 && this.value !== undefined));\n            var valid = this.props.valid !== undefined ? this.props.valid : isValid;\n            return {\n                customError: customError,\n                valid: valid,\n                valueMissing: this.value === null\n            };\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(MultiSelect.prototype, \"required\", {\n        /**\n         * @hidden\n         */\n        get: function () {\n            return this.props.required !== undefined\n                ? this.props.required\n                : MultiSelect.defaultProps.required;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(MultiSelect.prototype, \"validityStyles\", {\n        get: function () {\n            return this.props.validityStyles !== undefined\n                ? this.props.validityStyles\n                : MultiSelect.defaultProps.validityStyles;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @hidden\n     */\n    MultiSelect.prototype.componentDidUpdate = function (prevProps, prevState) {\n        var _a = this.props, virtual = _a.virtual, data = _a.data;\n        var skip = virtual ? virtual.skip : 0;\n        var prevTotal = prevProps.virtual ? prevProps.virtual.total : 0;\n        var opened = this.props.opened !== undefined ? this.props.opened : this.state.opened;\n        var prevOpened = prevProps.opened !== undefined ? prevProps.opened : prevState.opened;\n        var opening = !prevOpened && opened;\n        var closing = prevOpened && !opened;\n        var popupSettings = this.base.getPopupSettings();\n        if (!popupSettings.animate && closing) {\n            this.onPopupClosed();\n        }\n        if (virtual && virtual.total !== prevTotal) {\n            this.base.vs.calcScrollElementHeight();\n            this.base.vs.reset();\n        }\n        else {\n            var _b = this.getFocusedState(), focusedItem = _b.focusedItem, focusedIndex = _b.focusedIndex;\n            var focusedItemChanged = focusedIndex !== undefined && prevState.focusedIndex !== focusedIndex;\n            var prevData = prevProps.data;\n            if (opening && virtual) {\n                this.base.scrollToVirtualItem(virtual, focusedIndex - skip);\n            }\n            else if (opening && !virtual) {\n                this.base.scrollToItem(focusedIndex);\n            }\n            else if (opened && prevOpened && focusedItem && (focusedItemChanged || prevData !== data)) {\n                this.base.scrollToItem(focusedIndex - skip);\n            }\n        }\n        this.setValidity();\n    };\n    /**\n     * @hidden\n     */\n    MultiSelect.prototype.componentDidMount = function () {\n        this.base.didMount();\n        this.setValidity();\n    };\n    /**\n     * @hidden\n     */\n    MultiSelect.prototype.onNavigate = function (state, keyCode) {\n        var _a = this.props, allowCustom = _a.allowCustom, _b = _a.data, data = _b === void 0 ? [] : _b;\n        var opened = this.props.opened !== undefined ? this.props.opened : this.state.opened;\n        var text = this.props.filter !== undefined ? this.props.filter : this.state.text;\n        var _c = this.getFocusedState(), focusedType = _c.focusedType, focusedIndex = _c.focusedIndex;\n        var customItem = allowCustom && text;\n        var customItemFocused = isCustom(focusedType);\n        var base = this.base;\n        var vs = base.vs;\n        if (opened && keyCode === Keys.up && customItemFocused) {\n            if (this.state.focusedIndex !== undefined) {\n                state.data.focusedIndex = undefined;\n            }\n        }\n        else {\n            var newFocused = base.navigation.navigate({\n                keyCode: keyCode,\n                current: focusedIndex,\n                max: (vs.enabled ? vs.total : data.length) - 1,\n                min: customItem ? -1 : 0\n            });\n            if (newFocused !== undefined) {\n                this.itemFocus(newFocused, state);\n            }\n        }\n        this.applyState(state);\n    };\n    /**\n     * @hidden\n     */\n    MultiSelect.prototype.render = function () {\n        var _this = this;\n        var _a = this.props, style = _a.style, className = _a.className, label = _a.label, dir = _a.dir, disabled = _a.disabled, tags = _a.tags, textField = _a.textField, dataItemKey = _a.dataItemKey, virtual = _a.virtual;\n        var _b = this.state, focused = _b.focused, text = _b.text, focusedTag = _b.focusedTag;\n        var vs = this.base.vs;\n        var id = this.props.id || this._inputId;\n        vs.enabled = virtual !== undefined;\n        if (virtual !== undefined) {\n            vs.skip = virtual.skip;\n            vs.total = virtual.total;\n            vs.pageSize = virtual.pageSize;\n        }\n        var tagsToRender = [];\n        if (tags === undefined) {\n            this.value.forEach(function (item) {\n                tagsToRender.push({ text: getItemValue(item, textField), data: [item] });\n            });\n        }\n        else {\n            tagsToRender.push.apply(tagsToRender, tags);\n        }\n        this.setItems(tagsToRender, this._tags);\n        var isValid = !this.validityStyles || this.validity.valid;\n        var component = (React.createElement(\"span\", { ref: function (dropdown) { return _this._element = dropdown; }, className: classNames('k-widget k-multiselect k-header', className, {\n                'k-state-focused': focused && !disabled,\n                'k-state-invalid': !isValid,\n                'k-state-disabled': disabled\n            }), style: !label\n                ? style\n                : __assign({}, style, { width: undefined }), dir: dir, onFocus: this.handleFocus, onBlur: this.handleBlur },\n            React.createElement(\"div\", { onClick: this.handleWrapperClick, ref: function (wrapper) { return _this.base.wrapper = wrapper; }, className: \"k-multiselect-wrap k-floatwrap\", onMouseDown: preventDefaultNonInputs },\n                tagsToRender.length > 0 && React.createElement(TagList, { tagRender: this.props.tagRender, onTagDelete: this.onTagDelete, data: tagsToRender, guid: this.base.guid, focused: focusedTag ? tagsToRender.find(function (t) { return matchTags(t, focusedTag, dataItemKey); }) : undefined }),\n                this.renderSearchbar(id),\n                this.props.loading && React.createElement(\"span\", { className: \"k-icon k-i-loading\" })),\n            this.renderListContainer()));\n        return label ? (React.createElement(FloatingLabel, { label: label, editorId: id, editorValue: text || getItemValue(this.value[0], textField), editorValid: isValid, editorDisabled: disabled, style: { width: style ? style.width : undefined }, children: component })) : component;\n    };\n    MultiSelect.prototype.renderSearchbar = function (id) {\n        var _a = this.state, activedescendant = _a.activedescendant, focusedTag = _a.focusedTag;\n        var _b = this.props, disabled = _b.disabled, placeholder = _b.placeholder;\n        var text = (this.props.filter !== undefined ? this.props.filter : this.state.text) || '';\n        var opened = this.props.opened !== undefined ? this.props.opened : this.state.opened;\n        var focusedIndex = this.getFocusedState().focusedIndex;\n        var clearButton = !!text || this.value.length > 0;\n        var placeholderToShow = this.value.length === 0 && !text ? placeholder : undefined;\n        var ariaActivedescendant = activedescendant === ActiveDescendant.TagsList && focusedTag !== undefined ?\n            \"tag-\" + this.base.guid + \"-\" + focusedTag.text.replace(/\\s+/g, '-') :\n            \"option-\" + this.base.guid + \"-\" + focusedIndex;\n        return (React.createElement(SearchBar, { id: id, size: Math.max((placeholderToShow || '').length, text.length, 1), tabIndex: this.props.tabIndex, accessKey: this.props.accessKey, placeholder: placeholderToShow, value: text, onChange: this.onChangeHandler, onKeyDown: this.onInputKeyDown, ref: this.searchbarRef, disabled: disabled, expanded: opened, owns: this.base.listBoxId, activedescendant: ariaActivedescendant, ariaDescribedBy: \"tagslist-\" + this.base.guid + \" \" + (this.props.ariaDescribedBy || ''), clearButton: clearButton, clearButtonClick: this.clearButtonClick, ariaLabelledBy: this.props.ariaLabelledBy }));\n    };\n    MultiSelect.prototype.onTagsNavigate = function (event, state) {\n        var keyCode = event.keyCode;\n        var focusedTag = this.state.focusedTag;\n        var tags = this._tags;\n        var itemsKey = this.props.dataItemKey;\n        var focusedIndex = focusedTag ?\n            tags.findIndex(function (t) { return matchTags(t, focusedTag, itemsKey); }) : -1;\n        var newFocusedTag = undefined;\n        var hasFocused = focusedIndex !== -1;\n        if (keyCode === Keys.left) {\n            if (hasFocused) {\n                focusedIndex = Math.max(0, focusedIndex - 1);\n            }\n            else {\n                focusedIndex = tags.length - 1;\n            }\n            newFocusedTag = tags[focusedIndex];\n        }\n        else if (keyCode === Keys.right) {\n            if (focusedIndex === tags.length - 1) {\n                newFocusedTag = undefined;\n            }\n            else if (hasFocused) {\n                focusedIndex = Math.min(tags.length - 1, focusedIndex + 1);\n                newFocusedTag = tags[focusedIndex];\n            }\n        }\n        else if (keyCode === Keys.home) {\n            newFocusedTag = tags[0];\n        }\n        else if (keyCode === Keys.end) {\n            newFocusedTag = tags[tags.length - 1];\n        }\n        else if (keyCode === Keys.delete) {\n            if (hasFocused) {\n                var items = this.value;\n                removeDataItems(items, tags[focusedIndex].data, itemsKey);\n                this.triggerOnChange(items, state);\n            }\n        }\n        else if (keyCode === Keys.backspace) {\n            var items = this.value;\n            if (hasFocused) {\n                removeDataItems(items, tags[focusedIndex].data, itemsKey);\n                this.triggerOnChange(items, state);\n            }\n            else if (!hasFocused && tags.length) {\n                var removed = tags.pop();\n                removeDataItems(items, removed.data, itemsKey);\n                this.triggerOnChange(items, state);\n            }\n        }\n        if (newFocusedTag !== focusedTag) {\n            state.data.focusedTag = newFocusedTag;\n            state.data.activedescendant = ActiveDescendant.TagsList;\n        }\n        this.applyState(state);\n    };\n    MultiSelect.prototype.triggerOnChange = function (items, state) {\n        if (this.props.value === undefined) {\n            state.data.value = items.slice();\n        }\n        this._valueItemsDuringOnChange = [];\n        this.setItems(items, this._valueItemsDuringOnChange);\n        state.events.push({ type: 'onChange' });\n    };\n    MultiSelect.prototype.selectFocusedItem = function (event) {\n        var _a = this.props, _b = _a.data, data = _b === void 0 ? [] : _b, virtual = _a.virtual;\n        var focusedIndex = this.getFocusedState().focusedIndex;\n        var skip = virtual ? virtual.skip : 0;\n        if (data[focusedIndex - skip] !== undefined) {\n            this.handleItemClick(focusedIndex, event);\n        }\n    };\n    MultiSelect.prototype.setItems = function (srcItems, destItems) {\n        destItems.length = 0;\n        destItems.push.apply(destItems, srcItems);\n    };\n    MultiSelect.prototype.getFocusedState = function () {\n        var focusedIndex = this.state.focusedIndex;\n        var text = this.props.filter !== undefined ? this.props.filter : this.state.text;\n        var _a = this.props, allowCustom = _a.allowCustom, _b = _a.data, data = _b === void 0 ? [] : _b, dataItemKey = _a.dataItemKey, virtual = _a.virtual, textField = _a.textField, _c = _a.focusedItemIndex, focusedItemIndex = _c === void 0 ? itemIndexStartsWith : _c;\n        var skip = (virtual && virtual.skip) || 0;\n        var focusedInd;\n        if (focusedIndex !== undefined) {\n            return {\n                focusedIndex: focusedIndex,\n                focusedItem: data[focusedIndex - skip],\n                focusedType: FocusedItemType.ListItem\n            };\n        }\n        var selected = this.value;\n        if (allowCustom && text) {\n            return { focusedItem: null, focusedIndex: -1, focusedType: FocusedItemType.CustomItem };\n        }\n        else if (text) {\n            focusedInd = focusedItemIndex(data, text, textField);\n            return {\n                focusedItem: data[focusedInd],\n                focusedIndex: focusedInd + skip,\n                focusedType: FocusedItemType.ListItem\n            };\n        }\n        else if (selected.length) {\n            var last_1 = selected[selected.length - 1];\n            focusedInd = data.findIndex(function (i) { return areSame(i, last_1, dataItemKey); });\n            if (data[focusedInd] !== undefined) {\n                return {\n                    focusedIndex: focusedInd + skip,\n                    focusedItem: data[focusedInd],\n                    focusedType: FocusedItemType.ListItem\n                };\n            }\n            return { focusedType: FocusedItemType.None, focusedIndex: -1 };\n        }\n        return skip === 0 ?\n            { focusedItem: data[0], focusedIndex: 0, focusedType: FocusedItemType.ListItem } :\n            { focusedType: FocusedItemType.None, focusedIndex: -1 };\n    };\n    MultiSelect.prototype.focusElement = function (element) {\n        var _this = this;\n        this._skipFocusEvent = true;\n        element.focus();\n        setTimeout(function () { return _this._skipFocusEvent = false; }, 30);\n    };\n    MultiSelect.prototype.applyState = function (state) {\n        this.base.applyState(state);\n        this._valueItemsDuringOnChange = null;\n    };\n    /**\n     * @hidden\n     */\n    MultiSelect.propTypes = __assign({}, DropDownBase.propTypes, { autoClose: PropTypes.bool, value: PropTypes.arrayOf(PropTypes.any), defaultValue: PropTypes.arrayOf(PropTypes.any), dataItemKey: PropTypes.string, placeholder: PropTypes.string, tags: PropTypes.arrayOf(PropTypes.shape({\n            text: PropTypes.string,\n            data: PropTypes.arrayOf(PropTypes.any)\n        })), tagRender: PropTypes.func, id: PropTypes.string, ariaLabelledBy: PropTypes.string, ariaDescribedBy: PropTypes.string });\n    /**\n     * @hidden\n     */\n    MultiSelect.defaultProps = __assign({}, DropDownBase.defaultProps, { autoClose: true, required: false });\n    return MultiSelect;\n}(React.Component));\nexport default MultiSelect;\n//# sourceMappingURL=MultiSelect.js.map"]},"metadata":{},"sourceType":"module"}