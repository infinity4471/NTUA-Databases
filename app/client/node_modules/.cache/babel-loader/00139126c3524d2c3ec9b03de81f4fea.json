{"ast":null,"code":"import formatString from '../common/format-string';\nimport isString from '../common/is-string';\nimport { EMPTY } from '../common/constants';\nvar REMOVAL_PENALTY = 120;\nvar ADDITION_PENALTY = 20;\nvar LENGHT_DELTA = [2, 1, 5, 3, 4];\nvar LONG_LESS_PENALTY_DELTA = -2;\nvar SHORT_LESS_PENALTY_DELTA = -1;\nvar SHORT_MORE_PENALTY_DELTA = 1;\nvar LONG_MORE_PENALTY_DELTA = 2;\nvar PENALTIES = {};\nPENALTIES[LONG_LESS_PENALTY_DELTA.toString()] = 8;\nPENALTIES[SHORT_LESS_PENALTY_DELTA.toString()] = 6;\nPENALTIES[LONG_MORE_PENALTY_DELTA.toString()] = 6;\nPENALTIES[SHORT_MORE_PENALTY_DELTA.toString()] = 3;\nvar VALUE_FORMAT_LENGTH = {\n  numeric: 1,\n  \"2-digit\": 2,\n  short: 3,\n  long: 4,\n  narrow: 5\n};\nvar TIME_SPECIFIERS_REGEX = /[hHmsSzZoOvVxX]/;\n\nfunction getHourSpecifier(options) {\n  return options.hour12 ? \"h\" : \"H\";\n}\n\nvar DATE_OPTIONS_MAP = [{\n  key: \"era\",\n  specifier: \"G\"\n}, {\n  key: \"year\",\n  specifier: \"y\"\n}, {\n  key: \"month\",\n  specifier: \"M\"\n}, {\n  key: \"day\",\n  specifier: \"d\"\n}, {\n  key: \"weekday\",\n  specifier: \"E\"\n}, {\n  key: \"hour\",\n  getSpecifier: getHourSpecifier\n}, {\n  key: \"minute\",\n  specifier: \"m\"\n}, {\n  key: \"second\",\n  specifier: \"s\"\n}, {\n  key: \"timeZoneName\",\n  specifier: \"z\"\n}];\nvar STAND_ALONE_SPECIFIERS = {\n  e: 'c',\n  E: 'c',\n  M: 'L',\n  Q: 'q'\n};\nvar specifiersRegex = {};\nvar resolvedFormats = {};\n\nfunction getSpecifierRegex(specifier) {\n  if (!specifiersRegex[specifier]) {\n    specifiersRegex[specifier] = new RegExp(specifier + \"+\");\n  }\n\n  return specifiersRegex[specifier];\n}\n\nfunction skeletonSpecifiers(skeleton) {\n  var result = [];\n  var current = skeleton.charAt(0);\n  var specifier = current;\n\n  for (var idx = 1; idx < skeleton.length; idx++) {\n    var character = skeleton.charAt(idx);\n\n    if (character === specifier) {\n      current += character;\n    } else {\n      result.push(current);\n      current = specifier = character;\n    }\n  }\n\n  result.push(current);\n  return result;\n}\n\nfunction findBestMatch(specifiers, availableFormats) {\n  var specifiersLength = specifiers.length;\n  var maxScore = -Number.MAX_VALUE;\n  var bestMatches, result;\n\n  for (var format in availableFormats) {\n    var matches = [];\n    var currentFormat = format.replace(\"v\", \"z\");\n    var score = 0;\n\n    for (var idx = 0; idx < specifiersLength; idx++) {\n      var specifier = specifiers[idx];\n      var specifierRegex = getSpecifierRegex(specifier[0]);\n      var match = (specifierRegex.exec(currentFormat) || [])[0];\n\n      if (!match) {\n        score -= REMOVAL_PENALTY;\n      } else {\n        currentFormat = currentFormat.replace(match, EMPTY);\n\n        if (match.length !== specifier.length) {\n          var delta = Math.max(Math.min(LENGHT_DELTA[match.length] - LENGHT_DELTA[specifier.length], 2), -2);\n          score -= PENALTIES[delta];\n        }\n      }\n\n      matches.push(match);\n\n      if (score < maxScore) {\n        break;\n      }\n    }\n\n    if (currentFormat.length) {\n      score -= skeletonSpecifiers(currentFormat).length * ADDITION_PENALTY;\n    }\n\n    if (score > maxScore) {\n      maxScore = score;\n      bestMatches = matches;\n      result = availableFormats[format];\n    }\n  }\n\n  result = result.replace(\"v\", \"z\");\n\n  for (var idx$1 = 0; idx$1 < specifiersLength; idx$1++) {\n    var bestMatch = bestMatches[idx$1];\n\n    if (bestMatch && bestMatch !== specifiers[idx$1]) {\n      var matchSpecifier = bestMatches[idx$1][0];\n      result = result.replace(getSpecifierRegex(matchSpecifier), specifiers[idx$1]);\n\n      if (STAND_ALONE_SPECIFIERS[matchSpecifier]) {\n        result = result.replace(getSpecifierRegex(STAND_ALONE_SPECIFIERS[matchSpecifier]), specifiers[idx$1]);\n      }\n    }\n  }\n\n  return result;\n}\n\nfunction cacheFormat(skeleton, format, locale) {\n  if (!resolvedFormats[locale]) {\n    resolvedFormats[locale] = {};\n  }\n\n  resolvedFormats[locale][skeleton] = format;\n}\n\nfunction skeletonFormat(skeleton, info) {\n  var availableFormats = info.calendar.dateTimeFormats.availableFormats;\n\n  if (availableFormats[skeleton]) {\n    return availableFormats[skeleton];\n  }\n\n  if (resolvedFormats[info.name] && resolvedFormats[info.name][skeleton]) {\n    return resolvedFormats[info.name][skeleton];\n  }\n\n  var timeStartIndex = skeleton.search(TIME_SPECIFIERS_REGEX);\n  var result;\n\n  if (timeStartIndex > 0) {\n    var dateSkeleton = skeleton.substr(0, timeStartIndex);\n    var timeSkeleton = skeleton.substr(timeStartIndex);\n    result = formatString(info.calendar.dateTimeFormats.short, //should be deterimed based on specifiers\n    availableFormats[timeSkeleton] || findBestMatch(skeletonSpecifiers(timeSkeleton), availableFormats), availableFormats[dateSkeleton] || findBestMatch(skeletonSpecifiers(dateSkeleton), availableFormats));\n  } else {\n    result = findBestMatch(skeletonSpecifiers(skeleton), availableFormats);\n  }\n\n  cacheFormat(skeleton, result, info.name);\n  return result;\n}\n\nfunction skeletonFromOptions(options) {\n  var result = [];\n\n  for (var idx = 0; idx < DATE_OPTIONS_MAP.length; idx++) {\n    var option = DATE_OPTIONS_MAP[idx];\n    var field = option.key;\n    var value = options[field];\n\n    if (value) {\n      var spcifier = option.specifier || option.getSpecifier(options);\n      result.push(spcifier.repeat(VALUE_FORMAT_LENGTH[value]));\n    }\n  }\n\n  return result.join(EMPTY);\n}\n\nexport default function datePattern(format, info) {\n  var calendar = info.calendar;\n  var result;\n\n  if (isString(format)) {\n    if (calendar.patterns[format]) {\n      result = calendar.patterns[format];\n    } else {\n      result = format;\n    }\n  } else if (format) {\n    if (format.pattern) {\n      return format.pattern;\n    }\n\n    var skeleton = format.skeleton;\n\n    if (!skeleton) {\n      if (format.datetime) {\n        result = formatString(calendar.dateTimeFormats[format.datetime], calendar.timeFormats[format.datetime], calendar.dateFormats[format.datetime]);\n      } else if (format.date) {\n        result = calendar.dateFormats[format.date];\n      } else if (format.time) {\n        result = calendar.timeFormats[format.time];\n      } else {\n        skeleton = skeletonFromOptions(format);\n      }\n    }\n\n    if (skeleton) {\n      result = skeletonFormat(skeleton, info);\n    }\n  }\n\n  if (!result) {\n    result = calendar.patterns.d;\n  }\n\n  return result;\n}","map":{"version":3,"sources":["/home/infinity/Desktop/NTUA-Databases/app/client/node_modules/@telerik/kendo-intl/dist/es/dates/date-pattern.js"],"names":["formatString","isString","EMPTY","REMOVAL_PENALTY","ADDITION_PENALTY","LENGHT_DELTA","LONG_LESS_PENALTY_DELTA","SHORT_LESS_PENALTY_DELTA","SHORT_MORE_PENALTY_DELTA","LONG_MORE_PENALTY_DELTA","PENALTIES","toString","VALUE_FORMAT_LENGTH","numeric","short","long","narrow","TIME_SPECIFIERS_REGEX","getHourSpecifier","options","hour12","DATE_OPTIONS_MAP","key","specifier","getSpecifier","STAND_ALONE_SPECIFIERS","e","E","M","Q","specifiersRegex","resolvedFormats","getSpecifierRegex","RegExp","skeletonSpecifiers","skeleton","result","current","charAt","idx","length","character","push","findBestMatch","specifiers","availableFormats","specifiersLength","maxScore","Number","MAX_VALUE","bestMatches","format","matches","currentFormat","replace","score","specifierRegex","match","exec","delta","Math","max","min","idx$1","bestMatch","matchSpecifier","cacheFormat","locale","skeletonFormat","info","calendar","dateTimeFormats","name","timeStartIndex","search","dateSkeleton","substr","timeSkeleton","skeletonFromOptions","option","field","value","spcifier","repeat","join","datePattern","patterns","pattern","datetime","timeFormats","dateFormats","date","time","d"],"mappings":"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","sourcesContent":["import formatString from '../common/format-string';\nimport isString from '../common/is-string';\nimport { EMPTY } from '../common/constants';\n\nvar REMOVAL_PENALTY = 120;\nvar ADDITION_PENALTY = 20;\nvar LENGHT_DELTA = [ 2, 1, 5, 3, 4 ];\nvar LONG_LESS_PENALTY_DELTA = -2;\nvar SHORT_LESS_PENALTY_DELTA = -1;\nvar SHORT_MORE_PENALTY_DELTA = 1;\nvar LONG_MORE_PENALTY_DELTA = 2;\n\nvar PENALTIES = {};\nPENALTIES[LONG_LESS_PENALTY_DELTA.toString()] = 8;\nPENALTIES[SHORT_LESS_PENALTY_DELTA.toString()] = 6;\nPENALTIES[LONG_MORE_PENALTY_DELTA.toString()] = 6;\nPENALTIES[SHORT_MORE_PENALTY_DELTA.toString()] = 3;\n\nvar VALUE_FORMAT_LENGTH = {\n    numeric: 1,\n    \"2-digit\": 2,\n    short: 3,\n    long: 4,\n    narrow: 5\n};\n\nvar TIME_SPECIFIERS_REGEX = /[hHmsSzZoOvVxX]/;\n\nfunction getHourSpecifier(options) {\n    return options.hour12 ? \"h\" : \"H\";\n}\n\nvar DATE_OPTIONS_MAP = [ {\n    key: \"era\",\n    specifier: \"G\"\n}, {\n    key: \"year\",\n    specifier: \"y\"\n}, {\n    key: \"month\",\n    specifier: \"M\"\n}, {\n    key: \"day\",\n    specifier: \"d\"\n}, {\n    key: \"weekday\",\n    specifier: \"E\"\n}, {\n    key: \"hour\",\n    getSpecifier: getHourSpecifier\n}, {\n    key: \"minute\",\n    specifier: \"m\"\n}, {\n    key: \"second\",\n    specifier: \"s\"\n}, {\n    key: \"timeZoneName\",\n    specifier: \"z\"\n} ];\n\nvar STAND_ALONE_SPECIFIERS = {\n    e: 'c',\n    E: 'c',\n    M: 'L',\n    Q: 'q'\n};\n\nvar specifiersRegex = {};\nvar resolvedFormats = {};\n\nfunction getSpecifierRegex(specifier) {\n    if (!specifiersRegex[specifier]) {\n        specifiersRegex[specifier] = new RegExp(specifier + \"+\");\n    }\n    return specifiersRegex[specifier];\n}\n\nfunction skeletonSpecifiers(skeleton) {\n    var result = [];\n    var current = skeleton.charAt(0);\n    var specifier = current;\n    for (var idx = 1; idx < skeleton.length; idx++) {\n        var character = skeleton.charAt(idx);\n        if (character === specifier) {\n            current += character;\n        } else {\n            result.push(current);\n            current = specifier = character;\n        }\n    }\n\n    result.push(current);\n\n    return result;\n}\n\nfunction findBestMatch(specifiers, availableFormats) {\n    var specifiersLength = specifiers.length;\n    var maxScore = -Number.MAX_VALUE;\n    var bestMatches, result;\n    for (var format in availableFormats) {\n        var matches = [];\n        var currentFormat = format.replace(\"v\", \"z\");\n        var score = 0;\n        for (var idx = 0; idx < specifiersLength; idx++) {\n            var specifier = specifiers[idx];\n            var specifierRegex = getSpecifierRegex(specifier[0]);\n            var match = (specifierRegex.exec(currentFormat) || [])[0];\n\n            if (!match) {\n                score -= REMOVAL_PENALTY;\n            } else {\n                currentFormat = currentFormat.replace(match, EMPTY);\n                if (match.length !== specifier.length) {\n                    var delta = Math.max(Math.min(LENGHT_DELTA[match.length] - LENGHT_DELTA[specifier.length], 2), -2);\n                    score -= PENALTIES[delta];\n                }\n            }\n\n            matches.push(match);\n\n            if (score < maxScore) {\n                break;\n            }\n        }\n\n        if (currentFormat.length) {\n            score -= skeletonSpecifiers(currentFormat).length * ADDITION_PENALTY;\n        }\n\n        if (score > maxScore) {\n            maxScore = score;\n            bestMatches = matches;\n            result = availableFormats[format];\n        }\n    }\n\n    result = result.replace(\"v\", \"z\");\n\n    for (var idx$1 = 0; idx$1 < specifiersLength; idx$1++) {\n        var bestMatch = bestMatches[idx$1];\n        if (bestMatch && bestMatch !== specifiers[idx$1]) {\n            var matchSpecifier = bestMatches[idx$1][0];\n            result = result.replace(getSpecifierRegex(matchSpecifier), specifiers[idx$1]);\n            if (STAND_ALONE_SPECIFIERS[matchSpecifier]) {\n                result = result.replace(getSpecifierRegex(STAND_ALONE_SPECIFIERS[matchSpecifier]), specifiers[idx$1]);\n            }\n        }\n    }\n\n    return result;\n}\n\nfunction cacheFormat(skeleton, format, locale) {\n    if (!resolvedFormats[locale]) {\n        resolvedFormats[locale] = {};\n    }\n    resolvedFormats[locale][skeleton] = format;\n}\n\n\nfunction skeletonFormat(skeleton, info) {\n    var availableFormats = info.calendar.dateTimeFormats.availableFormats;\n    if (availableFormats[skeleton]) {\n        return availableFormats[skeleton];\n    }\n    if (resolvedFormats[info.name] && resolvedFormats[info.name][skeleton]) {\n        return resolvedFormats[info.name][skeleton];\n    }\n    var timeStartIndex = skeleton.search(TIME_SPECIFIERS_REGEX);\n    var result;\n    if (timeStartIndex > 0) {\n        var dateSkeleton = skeleton.substr(0, timeStartIndex);\n        var timeSkeleton = skeleton.substr(timeStartIndex);\n\n        result = formatString(info.calendar.dateTimeFormats.short, //should be deterimed based on specifiers\n            availableFormats[timeSkeleton] || findBestMatch(skeletonSpecifiers(timeSkeleton), availableFormats),\n            availableFormats[dateSkeleton] || findBestMatch(skeletonSpecifiers(dateSkeleton), availableFormats));\n    } else {\n        result = findBestMatch(skeletonSpecifiers(skeleton), availableFormats);\n    }\n\n    cacheFormat(skeleton, result, info.name);\n    return result;\n}\n\nfunction skeletonFromOptions(options) {\n    var result = [];\n    for (var idx = 0; idx < DATE_OPTIONS_MAP.length; idx++) {\n        var option = DATE_OPTIONS_MAP[idx];\n        var field = option.key;\n        var value = options[field];\n        if (value) {\n            var spcifier = option.specifier || option.getSpecifier(options);\n            result.push(spcifier.repeat(VALUE_FORMAT_LENGTH[value]));\n        }\n    }\n\n    return result.join(EMPTY);\n}\n\nexport default function datePattern(format, info) {\n    var calendar = info.calendar;\n    var result;\n    if (isString(format)) {\n        if (calendar.patterns[format]) {\n            result = calendar.patterns[format];\n        } else {\n            result = format;\n        }\n    } else if (format) {\n        if (format.pattern) {\n            return format.pattern;\n        }\n\n        var skeleton = format.skeleton;\n        if (!skeleton) {\n            if (format.datetime) {\n                result = formatString(calendar.dateTimeFormats[format.datetime], calendar.timeFormats[format.datetime], calendar.dateFormats[format.datetime]);\n            } else if (format.date) {\n                result = calendar.dateFormats[format.date];\n            } else if (format.time) {\n                result = calendar.timeFormats[format.time];\n            } else {\n                skeleton = skeletonFromOptions(format);\n            }\n        }\n\n        if (skeleton) {\n            result = skeletonFormat(skeleton, info);\n        }\n    }\n\n    if (!result) {\n        result = calendar.patterns.d;\n    }\n\n    return result;\n}\n"]},"metadata":{},"sourceType":"module"}