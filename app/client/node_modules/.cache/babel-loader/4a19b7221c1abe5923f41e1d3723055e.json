{"ast":null,"code":"var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nimport * as React from 'react';\nimport * as PropTypes from 'prop-types';\nimport VirtualScroll from './VirtualScroll';\nimport { Navigation } from './Navigation';\nimport { scrollToItem, areSame } from './utils';\nimport { guid } from '@progress/kendo-react-common';\n/**\n * @hidden\n */\n\nvar DropDownBase =\n/** @class */\nfunction () {\n  function DropDownBase(component) {\n    var _this = this;\n\n    this.vs = new VirtualScroll();\n    this.navigation = new Navigation();\n\n    this.handleItemClick = function (index, event) {\n      var state = _this.initState();\n\n      state.syntheticEvent = event;\n\n      _this.component.handleItemSelect(index, state);\n\n      _this.togglePopup(state);\n\n      _this.applyState(state);\n    };\n\n    this.handleFocus = function (event) {\n      if (!_this.component.state.focused) {\n        var state = _this.initState();\n\n        state.data.focused = true;\n        state.events.push({\n          type: 'onFocus'\n        });\n        state.syntheticEvent = event;\n\n        _this.applyState(state);\n      }\n    };\n\n    this.filterChanged = function (text, state) {\n      var _a = _this.component.props,\n          textField = _a.textField,\n          filterable = _a.filterable;\n\n      if (filterable) {\n        state.events.push({\n          type: 'onFilterChange',\n          filter: {\n            field: textField,\n            operator: 'contains',\n            ignoreCase: true,\n            value: text\n          }\n        });\n      }\n    };\n\n    this.togglePopup = function (state) {\n      var props = _this.component.props;\n      var opened = props.opened !== undefined ? props.opened : _this.component.state.opened;\n\n      if (props.opened === undefined) {\n        state.data.opened = !opened;\n      }\n\n      if (opened) {\n        state.events.push({\n          type: 'onClose'\n        });\n      } else {\n        state.events.push({\n          type: 'onOpen'\n        });\n\n        _this.calculatePopupWidth();\n      }\n    };\n\n    this.pageChange = function (page, syntheticEvent) {\n      var state = _this.initState();\n\n      state.syntheticEvent = syntheticEvent;\n\n      _this.triggerOnPageChange(state, page.skip, page.take);\n\n      _this.applyState(state);\n    };\n\n    this.scrollToVirtualItem = function (virtual, selectedItemIndex) {\n      var vs = _this.vs;\n      vs.enabled = false;\n\n      if (virtual.skip === 0) {\n        vs.reset();\n      } else if (virtual.skip + virtual.pageSize === virtual.total) {\n        vs.scrollToEnd();\n      } else {\n        var scrollTop = vs.translate;\n\n        if (scrollTop === 0) {\n          vs.calcScrollElementHeight();\n          scrollTop = vs.itemHeight * virtual.skip;\n          vs.translateTo(scrollTop - vs.itemHeight);\n        }\n\n        if (vs.container) {\n          vs.container.scrollTop = scrollTop;\n        }\n\n        _this.scrollToItem(selectedItemIndex, true);\n      }\n\n      setTimeout(function () {\n        return vs.enabled = true;\n      }, 10);\n    }; // Common rendering\n\n\n    this.renderScrollWrapper = function (children) {\n      var popupSettings = _this.getPopupSettings();\n\n      var vs = _this.vs;\n      return vs.enabled ? React.createElement(\"div\", {\n        onScroll: vs.scrollHandler,\n        ref: vs.scrollerRef,\n        style: {\n          height: popupSettings.height,\n          overflowY: 'scroll'\n        }\n      }, children) : children;\n    };\n\n    this.renderScrollElement = function () {\n      var vs = _this.vs;\n      return vs.enabled && React.createElement(\"div\", {\n        ref: function (element) {\n          return vs.scrollElement = element;\n        },\n        key: 'scrollElementKey'\n      });\n    };\n\n    this.listBoxId = guid();\n    this.guid = guid();\n    this.component = component;\n    this.vs.PageChange = this.pageChange;\n  }\n\n  DropDownBase.prototype.didMount = function () {\n    var props = this.component.props;\n    var popupSettings = props.popupSettings || {};\n    var style = props.style || {};\n    var popupWidth = popupSettings.width;\n    var shouldUpdate = props.opened === true;\n\n    if (popupWidth === undefined) {\n      this.calculatePopupWidth();\n    }\n\n    if (props.dir === undefined && style.direction === undefined) {\n      this.calculateDir();\n      shouldUpdate = true;\n    }\n\n    if (shouldUpdate) {\n      this.component.forceUpdate();\n    }\n  };\n\n  DropDownBase.prototype.calculateDir = function () {\n    if (this.component.element) {\n      this.dirCalculated = window.getComputedStyle(this.component.element).direction || undefined;\n    }\n  };\n\n  DropDownBase.prototype.calculatePopupWidth = function () {\n    if (this.wrapper) {\n      this.popupWidth = this.wrapper.offsetWidth + 'px';\n    }\n  };\n\n  DropDownBase.prototype.scrollToItem = function (itemIndex, vsEnabled) {\n    var list = this.list || this.vs.list;\n    var item = list ? list.children[0] : undefined;\n\n    if (item && itemIndex >= 0) {\n      var vs = this.vs;\n      var scrollElement = vs.container || list.parentNode;\n      var virtualScroll = vsEnabled !== undefined ? vsEnabled : vs.enabled;\n      scrollToItem(scrollElement, item.offsetHeight, itemIndex, vs.translate, virtualScroll);\n    }\n  };\n\n  DropDownBase.prototype.initState = function () {\n    var state = {\n      data: {},\n      events: [],\n      syntheticEvent: undefined\n    };\n    return state;\n  };\n\n  DropDownBase.prototype.applyState = function (state) {\n    var _this = this;\n\n    if (Object.keys(state.data).length > 0) {\n      this.component.setState(state.data);\n    }\n\n    var eventArgs = {\n      syntheticEvent: state.syntheticEvent,\n      nativeEvent: state.syntheticEvent ? state.syntheticEvent.nativeEvent : undefined,\n      target: this.component,\n      value: this.component.value\n    };\n    state.events.forEach(function (eventData) {\n      var type = eventData.type;\n      delete eventData.type;\n      var handler = _this.component.props[type];\n\n      if (handler) {\n        handler.call(undefined, __assign({}, eventArgs, eventData));\n      }\n    });\n  };\n\n  DropDownBase.prototype.triggerOnPageChange = function (state, skip, take) {\n    var virtual = this.component.props.virtual;\n\n    if (virtual) {\n      var newSkip = Math.min(Math.max(0, skip), Math.max(0, virtual.total - take));\n\n      if (newSkip !== virtual.skip) {\n        state.events.push({\n          type: 'onPageChange',\n          page: {\n            skip: newSkip,\n            take: take\n          }\n        });\n      }\n    }\n  };\n\n  DropDownBase.prototype.triggerPageChangeCornerItems = function (item, state) {\n    var props = this.component.props;\n    var _a = props.data,\n        data = _a === void 0 ? [] : _a,\n        dataItemKey = props.dataItemKey,\n        virtual = props.virtual;\n    var opened = props.opened !== undefined ? props.opened : this.component.state.opened;\n\n    if (item && virtual && this.vs.enabled) {\n      if (virtual.skip > 0 && areSame(item, data[0], dataItemKey)) {\n        this.triggerOnPageChange(state, virtual.skip - 1, virtual.pageSize);\n      } else if (!opened && virtual.skip + virtual.pageSize < virtual.total && areSame(item, data[data.length - 1], dataItemKey)) {\n        this.triggerOnPageChange(state, virtual.skip + 1, virtual.pageSize);\n      }\n    }\n  };\n\n  DropDownBase.prototype.getPopupSettings = function () {\n    return Object.assign({}, DropDownBase.defaultProps.popupSettings, this.component.props.popupSettings);\n  };\n\n  DropDownBase.basicPropTypes = {\n    opened: PropTypes.bool,\n    disabled: PropTypes.bool,\n    dir: PropTypes.string,\n    tabIndex: PropTypes.number,\n    accessKey: PropTypes.string,\n    data: PropTypes.array,\n    textField: PropTypes.string,\n    className: PropTypes.string,\n    label: PropTypes.string,\n    loading: PropTypes.bool,\n    popupSettings: PropTypes.shape({\n      animate: PropTypes.oneOfType([PropTypes.bool, PropTypes.shape({\n        openDuration: PropTypes.number,\n        closeDuration: PropTypes.number\n      })]),\n      width: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n      height: PropTypes.oneOfType([PropTypes.string, PropTypes.number])\n    }),\n    onOpen: PropTypes.func,\n    onClose: PropTypes.func,\n    onFocus: PropTypes.func,\n    onBlur: PropTypes.func,\n    onChange: PropTypes.func,\n    itemRender: PropTypes.func,\n    listNoDataRender: PropTypes.func,\n    focusedItemIndex: PropTypes.func,\n    header: PropTypes.node,\n    footer: PropTypes.node\n  };\n  DropDownBase.propTypes = __assign({}, DropDownBase.basicPropTypes, {\n    value: PropTypes.any,\n    defaultValue: PropTypes.any,\n    filterable: PropTypes.bool,\n    filter: PropTypes.string,\n    virtual: PropTypes.shape({\n      pageSize: PropTypes.number.isRequired,\n      skip: PropTypes.number.isRequired,\n      total: PropTypes.number.isRequired\n    }),\n    onFilterChange: PropTypes.func,\n    onPageChange: PropTypes.func\n  });\n  DropDownBase.defaultProps = {\n    popupSettings: {\n      animate: true,\n      height: '200px'\n    },\n    required: false,\n    validityStyles: true\n  };\n  return DropDownBase;\n}();\n\nexport default DropDownBase;","map":{"version":3,"sources":["../../../src/common/DropDownBase.tsx"],"names":[],"mappings":";;;;;;;;;;;;;;AAAA,OAAO,KAAK,KAAZ,MAAuB,OAAvB;AACA,OAAO,KAAK,SAAZ,MAA2B,YAA3B;AACA,OAAO,aAAP,MAA0B,iBAA1B;AACA,SAAS,UAAT,QAA2B,cAA3B;AAGA,SAAS,YAAT,EAAuB,OAAvB,QAAsC,SAAtC;AACA,SAAS,IAAT,QAAqB,8BAArB;AA8CA;;;;AAGA,IAAA,YAAA;AAAA;AAAA,YAAA;AAkEI,WAAA,YAAA,CAAY,SAAZ,EAAwC;AAAxC,QAAA,KAAA,GAAA,IAAA;;AANS,SAAA,EAAA,GAAK,IAAI,aAAJ,EAAL;AACA,SAAA,UAAA,GAAa,IAAI,UAAJ,EAAb;;AAwDT,SAAA,eAAA,GAAkB,UACd,KADc,EACC,KADD,EAC+E;AAC7F,UAAM,KAAK,GAAG,KAAI,CAAC,SAAL,EAAd;;AACA,MAAA,KAAK,CAAC,cAAN,GAAuB,KAAvB;;AAEA,MAAA,KAAI,CAAC,SAAL,CAAe,gBAAf,CAAgC,KAAhC,EAAuC,KAAvC;;AACA,MAAA,KAAI,CAAC,WAAL,CAAiB,KAAjB;;AAEA,MAAA,KAAI,CAAC,UAAL,CAAgB,KAAhB;AACH,KATD;;AAWA,SAAA,WAAA,GAAwD,UAAC,KAAD,EAAM;AAC1D,UAAI,CAAC,KAAI,CAAC,SAAL,CAAe,KAAf,CAAqB,OAA1B,EAAmC;AAC/B,YAAM,KAAK,GAAG,KAAI,CAAC,SAAL,EAAd;;AAEA,QAAA,KAAK,CAAC,IAAN,CAAW,OAAX,GAAqB,IAArB;AACA,QAAA,KAAK,CAAC,MAAN,CAAa,IAAb,CAAkB;AAAC,UAAA,IAAI,EAAE;AAAP,SAAlB;AACA,QAAA,KAAK,CAAC,cAAN,GAAuB,KAAvB;;AAEA,QAAA,KAAI,CAAC,UAAL,CAAgB,KAAhB;AACH;AACJ,KAVD;;AAYA,SAAA,aAAA,GAAgB,UAAC,IAAD,EAAsB,KAAtB,EAA0C;AAChD,UAAA,EAAA,GAAA,KAAA,CAAA,SAAA,CAAA,KAAA;AAAA,UAAE,SAAA,GAAA,EAAA,CAAA,SAAF;AAAA,UAAa,UAAA,GAAA,EAAA,CAAA,UAAb;;AACN,UAAI,UAAJ,EAAgB;AACZ,QAAA,KAAK,CAAC,MAAN,CAAa,IAAb,CAAkB;AACd,UAAA,IAAI,EAAE,gBADQ;AAEd,UAAA,MAAM,EAAE;AACJ,YAAA,KAAK,EAAE,SADH;AAEJ,YAAA,QAAQ,EAAE,UAFN;AAGJ,YAAA,UAAU,EAAE,IAHR;AAIJ,YAAA,KAAK,EAAE;AAJH;AAFM,SAAlB;AASH;AACJ,KAbD;;AAkDA,SAAA,WAAA,GAAc,UAAC,KAAD,EAAqB;AAC/B,UAAM,KAAK,GAAG,KAAI,CAAC,SAAL,CAAe,KAA7B;AACA,UAAM,MAAM,GAAG,KAAK,CAAC,MAAN,KAAiB,SAAjB,GAA6B,KAAK,CAAC,MAAnC,GAA4C,KAAI,CAAC,SAAL,CAAe,KAAf,CAAqB,MAAhF;;AACA,UAAI,KAAK,CAAC,MAAN,KAAiB,SAArB,EAAgC;AAC5B,QAAA,KAAK,CAAC,IAAN,CAAW,MAAX,GAAoB,CAAC,MAArB;AACH;;AAED,UAAI,MAAJ,EAAY;AACR,QAAA,KAAK,CAAC,MAAN,CAAa,IAAb,CAAkB;AAAC,UAAA,IAAI,EAAE;AAAP,SAAlB;AACH,OAFD,MAEO;AACH,QAAA,KAAK,CAAC,MAAN,CAAa,IAAb,CAAkB;AAAC,UAAA,IAAI,EAAE;AAAP,SAAlB;;AACA,QAAA,KAAI,CAAC,mBAAL;AACH;AACJ,KAbD;;AAeA,SAAA,UAAA,GAAa,UAAC,IAAD,EAAa,cAAb,EAAsD;AAC/D,UAAM,KAAK,GAAG,KAAI,CAAC,SAAL,EAAd;;AACA,MAAA,KAAK,CAAC,cAAN,GAAuB,cAAvB;;AAEA,MAAA,KAAI,CAAC,mBAAL,CAAyB,KAAzB,EAAgC,IAAI,CAAC,IAArC,EAA2C,IAAI,CAAC,IAAhD;;AACA,MAAA,KAAI,CAAC,UAAL,CAAgB,KAAhB;AACH,KAND;;AAmCA,SAAA,mBAAA,GAAsB,UAAC,OAAD,EAAkC,iBAAlC,EAA2D;AAC7E,UAAM,EAAE,GAAG,KAAI,CAAC,EAAhB;AACA,MAAA,EAAE,CAAC,OAAH,GAAa,KAAb;;AACA,UAAI,OAAO,CAAC,IAAR,KAAiB,CAArB,EAAwB;AACpB,QAAA,EAAE,CAAC,KAAH;AACH,OAFD,MAEO,IAAI,OAAO,CAAC,IAAR,GAAe,OAAO,CAAC,QAAvB,KAAoC,OAAO,CAAC,KAAhD,EAAuD;AAC1D,QAAA,EAAE,CAAC,WAAH;AACH,OAFM,MAEA;AACH,YAAI,SAAS,GAAG,EAAE,CAAC,SAAnB;;AACA,YAAI,SAAS,KAAK,CAAlB,EAAqB;AACjB,UAAA,EAAE,CAAC,uBAAH;AACA,UAAA,SAAS,GAAI,EAAE,CAAC,UAAH,GAAgB,OAAO,CAAC,IAArC;AACA,UAAA,EAAE,CAAC,WAAH,CAAe,SAAS,GAAG,EAAE,CAAC,UAA9B;AACH;;AAED,YAAI,EAAE,CAAC,SAAP,EAAkB;AACd,UAAA,EAAE,CAAC,SAAH,CAAa,SAAb,GAAyB,SAAzB;AACH;;AACD,QAAA,KAAI,CAAC,YAAL,CAAkB,iBAAlB,EAAqC,IAArC;AACH;;AAED,MAAA,UAAU,CAAC,YAAA;AAAM,eAAA,EAAE,CAAC,OAAH,GAAA,IAAA;AAAiB,OAAxB,EAA0B,EAA1B,CAAV;AACH,KAtBD,CA9KwC,CAsMxC;;;AACA,SAAA,mBAAA,GAAsB,UAAC,QAAD,EAA0B;AAC5C,UAAM,aAAa,GAAG,KAAI,CAAC,gBAAL,EAAtB;;AACA,UAAM,EAAE,GAAG,KAAI,CAAC,EAAhB;AAEA,aAAO,EAAE,CAAC,OAAH,GACH,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA;AACI,QAAA,QAAQ,EAAE,EAAE,CAAC,aADjB;AAEI,QAAA,GAAG,EAAE,EAAE,CAAC,WAFZ;AAGI,QAAA,KAAK,EAAE;AACH,UAAA,MAAM,EAAE,aAAa,CAAC,MADnB;AAEH,UAAA,SAAS,EAAE;AAFR;AAHX,OAAA,EAQK,QARL,CADG,GAYF,QAZL;AAaH,KAjBD;;AAmBA,SAAA,mBAAA,GAAsB,YAAA;AAClB,UAAM,EAAE,GAAG,KAAI,CAAC,EAAhB;AACA,aAAO,EAAE,CAAC,OAAH,IACH,KAAA,CAAA,aAAA,CAAA,KAAA,EAAA;AACI,QAAA,GAAG,EAAE,UAAA,OAAA,EAAO;AAAI,iBAAA,EAAE,CAAC,aAAH,GAAA,OAAA;AAA0B,SAD9C;AAEI,QAAA,GAAG,EAAE;AAFT,OAAA,CADJ;AAMH,KARD;;AAzNI,SAAK,SAAL,GAAiB,IAAI,EAArB;AACA,SAAK,IAAL,GAAY,IAAI,EAAhB;AACA,SAAK,SAAL,GAAiB,SAAjB;AACA,SAAK,EAAL,CAAQ,UAAR,GAAqB,KAAK,UAA1B;AACH;;AAED,EAAA,YAAA,CAAA,SAAA,CAAA,QAAA,GAAA,YAAA;AACI,QAAM,KAAK,GAAG,KAAK,SAAL,CAAe,KAA7B;AACA,QAAM,aAAa,GAAG,KAAK,CAAC,aAAN,IAAuB,EAA7C;AACA,QAAM,KAAK,GAAG,KAAK,CAAC,KAAN,IAAe,EAA7B;AACA,QAAM,UAAU,GAAG,aAAa,CAAC,KAAjC;AACA,QAAI,YAAY,GAAG,KAAK,CAAC,MAAN,KAAiB,IAApC;;AAEA,QAAI,UAAU,KAAK,SAAnB,EAA8B;AAC1B,WAAK,mBAAL;AACH;;AAED,QAAI,KAAK,CAAC,GAAN,KAAc,SAAd,IAA2B,KAAK,CAAC,SAAN,KAAoB,SAAnD,EAA8D;AAC1D,WAAK,YAAL;AACA,MAAA,YAAY,GAAG,IAAf;AACH;;AAED,QAAI,YAAJ,EAAkB;AACd,WAAK,SAAL,CAAe,WAAf;AACH;AACJ,GAnBD;;AAqBA,EAAA,YAAA,CAAA,SAAA,CAAA,YAAA,GAAA,YAAA;AACI,QAAI,KAAK,SAAL,CAAe,OAAnB,EAA4B;AACxB,WAAK,aAAL,GAAqB,MAAM,CAAC,gBAAP,CAAwB,KAAK,SAAL,CAAe,OAAvC,EAAiD,SAAjD,IAA8D,SAAnF;AACH;AACJ,GAJD;;AAMA,EAAA,YAAA,CAAA,SAAA,CAAA,mBAAA,GAAA,YAAA;AACI,QAAI,KAAK,OAAT,EAAkB;AACd,WAAK,UAAL,GAAkB,KAAK,OAAL,CAAa,WAAb,GAA2B,IAA7C;AACH;AACJ,GAJD;;AAMA,EAAA,YAAA,CAAA,SAAA,CAAA,YAAA,GAAA,UAAa,SAAb,EAAgC,SAAhC,EAAmD;AAC/C,QAAM,IAAI,GAAG,KAAK,IAAL,IAAa,KAAK,EAAL,CAAQ,IAAlC;AACA,QAAM,IAAI,GAAG,IAAI,GAAG,IAAI,CAAC,QAAL,CAAc,CAAd,CAAH,GAAuC,SAAxD;;AACA,QAAI,IAAI,IAAI,SAAS,IAAI,CAAzB,EAA4B;AACxB,UAAM,EAAE,GAAG,KAAK,EAAhB;AACA,UAAM,aAAa,GAAI,EAAE,CAAC,SAAH,IAAgB,IAAI,CAAC,UAA5C;AACA,UAAM,aAAa,GAAG,SAAS,KAAK,SAAd,GAA0B,SAA1B,GAAsC,EAAE,CAAC,OAA/D;AACA,MAAA,YAAY,CAAC,aAAD,EAAgB,IAAI,CAAC,YAArB,EAAmC,SAAnC,EAA8C,EAAE,CAAC,SAAjD,EAA4D,aAA5D,CAAZ;AACH;AACJ,GATD;;AAiDA,EAAA,YAAA,CAAA,SAAA,CAAA,SAAA,GAAA,YAAA;AACI,QAAM,KAAK,GAAkB;AACzB,MAAA,IAAI,EAAE,EADmB;AAEzB,MAAA,MAAM,EAAE,EAFiB;AAGzB,MAAA,cAAc,EAAE;AAHS,KAA7B;AAKA,WAAO,KAAP;AACH,GAPD;;AASA,EAAA,YAAA,CAAA,SAAA,CAAA,UAAA,GAAA,UAAW,KAAX,EAA+B;AAA/B,QAAA,KAAA,GAAA,IAAA;;AACI,QAAI,MAAM,CAAC,IAAP,CAAY,KAAK,CAAC,IAAlB,EAAwB,MAAxB,GAAiC,CAArC,EAAwC;AACpC,WAAK,SAAL,CAAe,QAAf,CAAwB,KAAK,CAAC,IAA9B;AACH;;AAED,QAAM,SAAS,GAAG;AACd,MAAA,cAAc,EAAE,KAAK,CAAC,cADR;AAEd,MAAA,WAAW,EAAE,KAAK,CAAC,cAAN,GAAuB,KAAK,CAAC,cAAN,CAAqB,WAA5C,GAA0D,SAFzD;AAGd,MAAA,MAAM,EAAE,KAAK,SAHC;AAId,MAAA,KAAK,EAAE,KAAK,SAAL,CAAe;AAJR,KAAlB;AAOA,IAAA,KAAK,CAAC,MAAN,CAAa,OAAb,CAAqB,UAAC,SAAD,EAAU;AACnB,UAAA,IAAA,GAAA,SAAA,CAAA,IAAA;AACR,aAAO,SAAS,CAAC,IAAjB;AAEA,UAAM,OAAO,GAAG,KAAI,CAAC,SAAL,CAAe,KAAf,CAAqB,IAArB,CAAhB;;AACA,UAAI,OAAJ,EAAa;AACT,QAAA,OAAO,CAAC,IAAR,CAAa,SAAb,EAAsB,QAAA,CAAA,EAAA,EACf,SADe,EAEf,SAFe,CAAtB;AAIH;AACJ,KAXD;AAYH,GAxBD;;AAiDA,EAAA,YAAA,CAAA,SAAA,CAAA,mBAAA,GAAA,UAAoB,KAApB,EAA0C,IAA1C,EAAwD,IAAxD,EAAoE;AAChE,QAAM,OAAO,GAAG,KAAK,SAAL,CAAe,KAAf,CAAqB,OAArC;;AACA,QAAI,OAAJ,EAAa;AACT,UAAM,OAAO,GAAG,IAAI,CAAC,GAAL,CAAS,IAAI,CAAC,GAAL,CAAS,CAAT,EAAY,IAAZ,CAAT,EAA4B,IAAI,CAAC,GAAL,CAAS,CAAT,EAAY,OAAO,CAAC,KAAR,GAAgB,IAA5B,CAA5B,CAAhB;;AACA,UAAI,OAAO,KAAK,OAAO,CAAC,IAAxB,EAA8B;AAC1B,QAAA,KAAK,CAAC,MAAN,CAAa,IAAb,CAAkB;AACd,UAAA,IAAI,EAAE,cADQ;AAEd,UAAA,IAAI,EAAE;AAAE,YAAA,IAAI,EAAE,OAAR;AAAiB,YAAA,IAAI,EAAE;AAAvB;AAFQ,SAAlB;AAIH;AACJ;AACJ,GAXD;;AAaA,EAAA,YAAA,CAAA,SAAA,CAAA,4BAAA,GAAA,UAA6B,IAA7B,EAAwC,KAAxC,EAA4D;AACxD,QAAM,KAAK,GAAG,KAAK,SAAL,CAAe,KAA7B;AACQ,QAAA,EAAA,GAAA,KAAA,CAAA,IAAA;AAAA,QAAA,IAAA,GAAA,EAAA,KAAA,KAAA,CAAA,GAAA,EAAA,GAAA,EAAA;AAAA,QAAW,WAAA,GAAA,KAAA,CAAA,WAAX;AAAA,QAAwB,OAAA,GAAA,KAAA,CAAA,OAAxB;AACR,QAAM,MAAM,GAAG,KAAK,CAAC,MAAN,KAAiB,SAAjB,GAA6B,KAAK,CAAC,MAAnC,GAA4C,KAAK,SAAL,CAAe,KAAf,CAAqB,MAAhF;;AACA,QAAI,IAAI,IAAI,OAAR,IAAmB,KAAK,EAAL,CAAQ,OAA/B,EAAwC;AACpC,UAAI,OAAO,CAAC,IAAR,GAAe,CAAf,IAAoB,OAAO,CAAC,IAAD,EAAO,IAAI,CAAC,CAAD,CAAX,EAAgB,WAAhB,CAA/B,EAA6D;AACzD,aAAK,mBAAL,CAAyB,KAAzB,EAAgC,OAAO,CAAC,IAAR,GAAe,CAA/C,EAAkD,OAAQ,CAAC,QAA3D;AACH,OAFD,MAEO,IAAI,CAAC,MAAD,IAAW,OAAO,CAAC,IAAR,GAAe,OAAQ,CAAC,QAAxB,GAAmC,OAAQ,CAAC,KAAvD,IACP,OAAO,CAAC,IAAD,EAAO,IAAI,CAAC,IAAI,CAAC,MAAL,GAAc,CAAf,CAAX,EAA8B,WAA9B,CADJ,EACgD;AACnD,aAAK,mBAAL,CAAyB,KAAzB,EAAgC,OAAO,CAAC,IAAR,GAAe,CAA/C,EAAkD,OAAQ,CAAC,QAA3D;AACH;AACJ;AACJ,GAZD;;AAoEA,EAAA,YAAA,CAAA,SAAA,CAAA,gBAAA,GAAA,YAAA;AACI,WAAQ,MAAc,CACjB,MADG,CACI,EADJ,EACQ,YAAY,CAAC,YAAb,CAA0B,aADlC,EACiD,KAAK,SAAL,CAAe,KAAf,CAAqB,aADtE,CAAR;AAEH,GAHD;;AArSO,EAAA,YAAA,CAAA,cAAA,GAAiB;AACpB,IAAA,MAAM,EAAE,SAAS,CAAC,IADE;AAEpB,IAAA,QAAQ,EAAE,SAAS,CAAC,IAFA;AAGpB,IAAA,GAAG,EAAE,SAAS,CAAC,MAHK;AAIpB,IAAA,QAAQ,EAAE,SAAS,CAAC,MAJA;AAKpB,IAAA,SAAS,EAAE,SAAS,CAAC,MALD;AAMpB,IAAA,IAAI,EAAE,SAAS,CAAC,KANI;AAOpB,IAAA,SAAS,EAAE,SAAS,CAAC,MAPD;AAQpB,IAAA,SAAS,EAAE,SAAS,CAAC,MARD;AASpB,IAAA,KAAK,EAAE,SAAS,CAAC,MATG;AAUpB,IAAA,OAAO,EAAE,SAAS,CAAC,IAVC;AAWpB,IAAA,aAAa,EAAE,SAAS,CAAC,KAAV,CAAgB;AAC3B,MAAA,OAAO,EAAE,SAAS,CAAC,SAAV,CAAoB,CAAC,SAAS,CAAC,IAAX,EAAiB,SAAS,CAAC,KAAV,CAAgB;AAC1D,QAAA,YAAY,EAAE,SAAS,CAAC,MADkC;AAE1D,QAAA,aAAa,EAAE,SAAS,CAAC;AAFiC,OAAhB,CAAjB,CAApB,CADkB;AAK3B,MAAA,KAAK,EAAE,SAAS,CAAC,SAAV,CAAoB,CAAC,SAAS,CAAC,MAAX,EAAmB,SAAS,CAAC,MAA7B,CAApB,CALoB;AAM3B,MAAA,MAAM,EAAE,SAAS,CAAC,SAAV,CAAoB,CAAC,SAAS,CAAC,MAAX,EAAmB,SAAS,CAAC,MAA7B,CAApB;AANmB,KAAhB,CAXK;AAmBpB,IAAA,MAAM,EAAE,SAAS,CAAC,IAnBE;AAoBpB,IAAA,OAAO,EAAE,SAAS,CAAC,IApBC;AAqBpB,IAAA,OAAO,EAAE,SAAS,CAAC,IArBC;AAsBpB,IAAA,MAAM,EAAE,SAAS,CAAC,IAtBE;AAuBpB,IAAA,QAAQ,EAAE,SAAS,CAAC,IAvBA;AAwBpB,IAAA,UAAU,EAAE,SAAS,CAAC,IAxBF;AAyBpB,IAAA,gBAAgB,EAAE,SAAS,CAAC,IAzBR;AA0BpB,IAAA,gBAAgB,EAAE,SAAS,CAAC,IA1BR;AA2BpB,IAAA,MAAM,EAAE,SAAS,CAAC,IA3BE;AA4BpB,IAAA,MAAM,EAAE,SAAS,CAAC;AA5BE,GAAjB;AA+BA,EAAA,YAAA,CAAA,SAAA,GAAS,QAAA,CAAA,EAAA,EACT,YAAY,CAAC,cADJ,EACkB;AAC9B,IAAA,KAAK,EAAE,SAAS,CAAC,GADa;AAE9B,IAAA,YAAY,EAAE,SAAS,CAAC,GAFM;AAG9B,IAAA,UAAU,EAAE,SAAS,CAAC,IAHQ;AAI9B,IAAA,MAAM,EAAE,SAAS,CAAC,MAJY;AAK9B,IAAA,OAAO,EAAE,SAAS,CAAC,KAAV,CAAgB;AACrB,MAAA,QAAQ,EAAE,SAAS,CAAC,MAAV,CAAiB,UADN;AAErB,MAAA,IAAI,EAAE,SAAS,CAAC,MAAV,CAAiB,UAFF;AAGrB,MAAA,KAAK,EAAE,SAAS,CAAC,MAAV,CAAiB;AAHH,KAAhB,CALqB;AAU9B,IAAA,cAAc,EAAE,SAAS,CAAC,IAVI;AAW9B,IAAA,YAAY,EAAE,SAAS,CAAC;AAXM,GADlB,CAAT;AAcA,EAAA,YAAA,CAAA,YAAA,GAAe;AAClB,IAAA,aAAa,EAAE;AACX,MAAA,OAAO,EAAE,IADE;AAEX,MAAA,MAAM,EAAE;AAFG,KADG;AAKlB,IAAA,QAAQ,EAAE,KALQ;AAMlB,IAAA,cAAc,EAAE;AANE,GAAf;AA4PX,SAAA,YAAA;AAAC,CA1SD,EAAA;;eAAqB,Y","sourceRoot":"","sourcesContent":["var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport * as React from 'react';\nimport * as PropTypes from 'prop-types';\nimport VirtualScroll from './VirtualScroll';\nimport { Navigation } from './Navigation';\nimport { scrollToItem, areSame } from './utils';\nimport { guid } from '@progress/kendo-react-common';\n/**\n * @hidden\n */\nvar DropDownBase = /** @class */ (function () {\n    function DropDownBase(component) {\n        var _this = this;\n        this.vs = new VirtualScroll();\n        this.navigation = new Navigation();\n        this.handleItemClick = function (index, event) {\n            var state = _this.initState();\n            state.syntheticEvent = event;\n            _this.component.handleItemSelect(index, state);\n            _this.togglePopup(state);\n            _this.applyState(state);\n        };\n        this.handleFocus = function (event) {\n            if (!_this.component.state.focused) {\n                var state = _this.initState();\n                state.data.focused = true;\n                state.events.push({ type: 'onFocus' });\n                state.syntheticEvent = event;\n                _this.applyState(state);\n            }\n        };\n        this.filterChanged = function (text, state) {\n            var _a = _this.component.props, textField = _a.textField, filterable = _a.filterable;\n            if (filterable) {\n                state.events.push({\n                    type: 'onFilterChange',\n                    filter: {\n                        field: textField,\n                        operator: 'contains',\n                        ignoreCase: true,\n                        value: text\n                    }\n                });\n            }\n        };\n        this.togglePopup = function (state) {\n            var props = _this.component.props;\n            var opened = props.opened !== undefined ? props.opened : _this.component.state.opened;\n            if (props.opened === undefined) {\n                state.data.opened = !opened;\n            }\n            if (opened) {\n                state.events.push({ type: 'onClose' });\n            }\n            else {\n                state.events.push({ type: 'onOpen' });\n                _this.calculatePopupWidth();\n            }\n        };\n        this.pageChange = function (page, syntheticEvent) {\n            var state = _this.initState();\n            state.syntheticEvent = syntheticEvent;\n            _this.triggerOnPageChange(state, page.skip, page.take);\n            _this.applyState(state);\n        };\n        this.scrollToVirtualItem = function (virtual, selectedItemIndex) {\n            var vs = _this.vs;\n            vs.enabled = false;\n            if (virtual.skip === 0) {\n                vs.reset();\n            }\n            else if (virtual.skip + virtual.pageSize === virtual.total) {\n                vs.scrollToEnd();\n            }\n            else {\n                var scrollTop = vs.translate;\n                if (scrollTop === 0) {\n                    vs.calcScrollElementHeight();\n                    scrollTop = (vs.itemHeight * virtual.skip);\n                    vs.translateTo(scrollTop - vs.itemHeight);\n                }\n                if (vs.container) {\n                    vs.container.scrollTop = scrollTop;\n                }\n                _this.scrollToItem(selectedItemIndex, true);\n            }\n            setTimeout(function () { return vs.enabled = true; }, 10);\n        };\n        // Common rendering\n        this.renderScrollWrapper = function (children) {\n            var popupSettings = _this.getPopupSettings();\n            var vs = _this.vs;\n            return vs.enabled ? (React.createElement(\"div\", { onScroll: vs.scrollHandler, ref: vs.scrollerRef, style: {\n                    height: popupSettings.height,\n                    overflowY: 'scroll'\n                } }, children)) :\n                (children);\n        };\n        this.renderScrollElement = function () {\n            var vs = _this.vs;\n            return vs.enabled && (React.createElement(\"div\", { ref: function (element) { return vs.scrollElement = element; }, key: 'scrollElementKey' }));\n        };\n        this.listBoxId = guid();\n        this.guid = guid();\n        this.component = component;\n        this.vs.PageChange = this.pageChange;\n    }\n    DropDownBase.prototype.didMount = function () {\n        var props = this.component.props;\n        var popupSettings = props.popupSettings || {};\n        var style = props.style || {};\n        var popupWidth = popupSettings.width;\n        var shouldUpdate = props.opened === true;\n        if (popupWidth === undefined) {\n            this.calculatePopupWidth();\n        }\n        if (props.dir === undefined && style.direction === undefined) {\n            this.calculateDir();\n            shouldUpdate = true;\n        }\n        if (shouldUpdate) {\n            this.component.forceUpdate();\n        }\n    };\n    DropDownBase.prototype.calculateDir = function () {\n        if (this.component.element) {\n            this.dirCalculated = window.getComputedStyle(this.component.element).direction || undefined;\n        }\n    };\n    DropDownBase.prototype.calculatePopupWidth = function () {\n        if (this.wrapper) {\n            this.popupWidth = this.wrapper.offsetWidth + 'px';\n        }\n    };\n    DropDownBase.prototype.scrollToItem = function (itemIndex, vsEnabled) {\n        var list = this.list || this.vs.list;\n        var item = list ? list.children[0] : undefined;\n        if (item && itemIndex >= 0) {\n            var vs = this.vs;\n            var scrollElement = (vs.container || list.parentNode);\n            var virtualScroll = vsEnabled !== undefined ? vsEnabled : vs.enabled;\n            scrollToItem(scrollElement, item.offsetHeight, itemIndex, vs.translate, virtualScroll);\n        }\n    };\n    DropDownBase.prototype.initState = function () {\n        var state = {\n            data: {},\n            events: [],\n            syntheticEvent: undefined\n        };\n        return state;\n    };\n    DropDownBase.prototype.applyState = function (state) {\n        var _this = this;\n        if (Object.keys(state.data).length > 0) {\n            this.component.setState(state.data);\n        }\n        var eventArgs = {\n            syntheticEvent: state.syntheticEvent,\n            nativeEvent: state.syntheticEvent ? state.syntheticEvent.nativeEvent : undefined,\n            target: this.component,\n            value: this.component.value\n        };\n        state.events.forEach(function (eventData) {\n            var type = eventData.type;\n            delete eventData.type;\n            var handler = _this.component.props[type];\n            if (handler) {\n                handler.call(undefined, __assign({}, eventArgs, eventData));\n            }\n        });\n    };\n    DropDownBase.prototype.triggerOnPageChange = function (state, skip, take) {\n        var virtual = this.component.props.virtual;\n        if (virtual) {\n            var newSkip = Math.min(Math.max(0, skip), Math.max(0, virtual.total - take));\n            if (newSkip !== virtual.skip) {\n                state.events.push({\n                    type: 'onPageChange',\n                    page: { skip: newSkip, take: take }\n                });\n            }\n        }\n    };\n    DropDownBase.prototype.triggerPageChangeCornerItems = function (item, state) {\n        var props = this.component.props;\n        var _a = props.data, data = _a === void 0 ? [] : _a, dataItemKey = props.dataItemKey, virtual = props.virtual;\n        var opened = props.opened !== undefined ? props.opened : this.component.state.opened;\n        if (item && virtual && this.vs.enabled) {\n            if (virtual.skip > 0 && areSame(item, data[0], dataItemKey)) {\n                this.triggerOnPageChange(state, virtual.skip - 1, virtual.pageSize);\n            }\n            else if (!opened && virtual.skip + virtual.pageSize < virtual.total &&\n                areSame(item, data[data.length - 1], dataItemKey)) {\n                this.triggerOnPageChange(state, virtual.skip + 1, virtual.pageSize);\n            }\n        }\n    };\n    DropDownBase.prototype.getPopupSettings = function () {\n        return Object\n            .assign({}, DropDownBase.defaultProps.popupSettings, this.component.props.popupSettings);\n    };\n    DropDownBase.basicPropTypes = {\n        opened: PropTypes.bool,\n        disabled: PropTypes.bool,\n        dir: PropTypes.string,\n        tabIndex: PropTypes.number,\n        accessKey: PropTypes.string,\n        data: PropTypes.array,\n        textField: PropTypes.string,\n        className: PropTypes.string,\n        label: PropTypes.string,\n        loading: PropTypes.bool,\n        popupSettings: PropTypes.shape({\n            animate: PropTypes.oneOfType([PropTypes.bool, PropTypes.shape({\n                    openDuration: PropTypes.number,\n                    closeDuration: PropTypes.number\n                })]),\n            width: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n            height: PropTypes.oneOfType([PropTypes.string, PropTypes.number])\n        }),\n        onOpen: PropTypes.func,\n        onClose: PropTypes.func,\n        onFocus: PropTypes.func,\n        onBlur: PropTypes.func,\n        onChange: PropTypes.func,\n        itemRender: PropTypes.func,\n        listNoDataRender: PropTypes.func,\n        focusedItemIndex: PropTypes.func,\n        header: PropTypes.node,\n        footer: PropTypes.node\n    };\n    DropDownBase.propTypes = __assign({}, DropDownBase.basicPropTypes, { value: PropTypes.any, defaultValue: PropTypes.any, filterable: PropTypes.bool, filter: PropTypes.string, virtual: PropTypes.shape({\n            pageSize: PropTypes.number.isRequired,\n            skip: PropTypes.number.isRequired,\n            total: PropTypes.number.isRequired\n        }), onFilterChange: PropTypes.func, onPageChange: PropTypes.func });\n    DropDownBase.defaultProps = {\n        popupSettings: {\n            animate: true,\n            height: '200px'\n        },\n        required: false,\n        validityStyles: true\n    };\n    return DropDownBase;\n}());\nexport default DropDownBase;\n//# sourceMappingURL=DropDownBase.js.map"]},"metadata":{},"sourceType":"module"}