{"ast":null,"code":"import { getDate, isEqual } from '@progress/kendo-date-math';\nimport { MIDNIGHT_DATE } from '../../utils';\nimport { range, setHours } from '../utils';\nvar HOURS_IN_DAY = 24;\n\nvar clampToRange = function (rangeValue) {\n  return function (value) {\n    return value % rangeValue;\n  };\n};\n\nvar clamp = clampToRange(HOURS_IN_DAY);\n\nvar stepper = function (start, step) {\n  return function (idx) {\n    return clamp(start + idx * step);\n  };\n};\n\nvar distanceFromMin = function (value, min) {\n  return clamp(HOURS_IN_DAY + value - min);\n};\n\nvar limit = function (borderValue) {\n  return function (barrier, value) {\n    var useBarrier = !value || getDate(barrier).getTime() === getDate(value).getTime();\n    return useBarrier ? barrier : setHours(barrier, borderValue);\n  };\n};\n\nvar limitDown = limit(0);\nvar limitUp = limit(HOURS_IN_DAY - 1);\n/**\n * @hidden\n */\n\nvar HoursService =\n/** @class */\nfunction () {\n  function HoursService(intl) {\n    this.intl = intl;\n    this.boundRange = false;\n    this.insertUndividedMax = false;\n  }\n\n  HoursService.prototype.apply = function (value, candidate) {\n    return setHours(value, candidate.getHours());\n  };\n\n  HoursService.prototype.configure = function (settings) {\n    var _this = this;\n\n    var _a = settings.boundRange,\n        boundRange = _a === void 0 ? this.boundRange : _a,\n        _b = settings.insertUndividedMax,\n        insertUndividedMax = _b === void 0 ? this.insertUndividedMax : _b,\n        _c = settings.min,\n        min = _c === void 0 ? this.min : _c,\n        _d = settings.max,\n        max = _d === void 0 ? this.max : _d,\n        part = settings.part,\n        _e = settings.step,\n        step = _e === void 0 ? this.step : _e;\n    this.boundRange = boundRange;\n    this.insertUndividedMax = insertUndividedMax;\n\n    this.toListItem = function (hour) {\n      var date = setHours(MIDNIGHT_DATE, hour);\n      return {\n        text: _this.intl.formatDate(date, part.pattern),\n        value: date\n      };\n    };\n\n    this.min = min;\n    this.max = max;\n    this.step = step;\n  };\n\n  HoursService.prototype.data = function (selectedValue) {\n    var _this = this;\n\n    var min = this.range(selectedValue)[0];\n    var getHour = stepper(min, this.step);\n\n    var convertToItem = function (idx) {\n      return _this.toListItem(getHour(idx));\n    };\n\n    var data = range(0, this.countFromMin(selectedValue)).map(convertToItem);\n    this.addLast(data);\n\n    if (selectedValue) {\n      this.addMissing(data, selectedValue);\n    }\n\n    return data;\n  };\n\n  HoursService.prototype.isRangeChanged = function (min, max) {\n    return !isEqual(this.min, min) || !isEqual(this.max, max);\n  };\n\n  HoursService.prototype.limitRange = function (min, max, value) {\n    return this.boundRange ? [limitDown(min, value), limitUp(max, value)] : [min, max];\n  };\n\n  HoursService.prototype.total = function (value) {\n    var last = this.insertUndividedMax && this.isLastMissing(value) ? 1 : 0;\n    var missing = this.isMissing(value) ? 1 : 0;\n    return this.countFromMin(value) + missing + last;\n  };\n\n  HoursService.prototype.selectedIndex = function (value) {\n    return Math.ceil(this.divideByStep(value));\n  };\n\n  HoursService.prototype.valueInList = function (value) {\n    if (!value) {\n      return true;\n    }\n\n    var matchMax = this.insertUndividedMax && this.lastHour(value) === value.getHours();\n    return matchMax || !this.isMissing(value);\n  };\n\n  HoursService.prototype.addLast = function (data, value) {\n    if (this.insertUndividedMax && this.isLastMissing(value)) {\n      data.push(this.toListItem(this.lastHour(value)));\n    }\n\n    return data;\n  };\n\n  HoursService.prototype.addMissing = function (data, value) {\n    if (this.valueInList(value)) {\n      return data;\n    }\n\n    var missingItem = this.toListItem(value.getHours());\n    data.splice(this.selectedIndex(value), 0, missingItem);\n    return data;\n  };\n\n  HoursService.prototype.countFromMin = function (value) {\n    var _a = this.range(value),\n        min = _a[0],\n        max = _a[1];\n\n    return Math.floor(distanceFromMin(max, min) / this.step) + 1;\n    /* include min */\n  };\n\n  HoursService.prototype.isMissing = function (value) {\n    if (!value) {\n      return false;\n    }\n\n    return this.selectedIndex(value) !== this.divideByStep(value);\n  };\n\n  HoursService.prototype.isLastMissing = function (value) {\n    return this.isMissing(setHours(this.max, this.lastHour(value)));\n  };\n\n  HoursService.prototype.divideByStep = function (value) {\n    return distanceFromMin(value.getHours(), this.min.getHours()) / this.step;\n  };\n\n  HoursService.prototype.lastHour = function (value) {\n    return this.range(value)[1];\n  };\n\n  HoursService.prototype.range = function (value) {\n    var _a = this.limitRange(this.min, this.max, value),\n        min = _a[0],\n        max = _a[1];\n\n    return [min.getHours(), max.getHours()];\n  };\n\n  return HoursService;\n}();\n\nexport { HoursService };","map":{"version":3,"sources":["../../../../src/timepicker/services/HoursService.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["import { getDate, isEqual } from '@progress/kendo-date-math';\nimport { MIDNIGHT_DATE } from '../../utils';\nimport { range, setHours } from '../utils';\nvar HOURS_IN_DAY = 24;\nvar clampToRange = function (rangeValue) { return function (value) { return value % rangeValue; }; };\nvar clamp = clampToRange(HOURS_IN_DAY);\nvar stepper = function (start, step) { return function (idx) { return clamp(start + (idx * step)); }; };\nvar distanceFromMin = function (value, min) { return clamp(HOURS_IN_DAY + value - min); };\nvar limit = function (borderValue) { return function (barrier, value) {\n    var useBarrier = !value || getDate(barrier).getTime() === getDate(value).getTime();\n    return useBarrier ? barrier : setHours(barrier, borderValue);\n}; };\nvar limitDown = limit(0);\nvar limitUp = limit(HOURS_IN_DAY - 1);\n/**\n * @hidden\n */\nvar HoursService = /** @class */ (function () {\n    function HoursService(intl) {\n        this.intl = intl;\n        this.boundRange = false;\n        this.insertUndividedMax = false;\n    }\n    HoursService.prototype.apply = function (value, candidate) {\n        return setHours(value, candidate.getHours());\n    };\n    HoursService.prototype.configure = function (settings) {\n        var _this = this;\n        var _a = settings.boundRange, boundRange = _a === void 0 ? this.boundRange : _a, _b = settings.insertUndividedMax, insertUndividedMax = _b === void 0 ? this.insertUndividedMax : _b, _c = settings.min, min = _c === void 0 ? this.min : _c, _d = settings.max, max = _d === void 0 ? this.max : _d, part = settings.part, _e = settings.step, step = _e === void 0 ? this.step : _e;\n        this.boundRange = boundRange;\n        this.insertUndividedMax = insertUndividedMax;\n        this.toListItem = function (hour) {\n            var date = setHours(MIDNIGHT_DATE, hour);\n            return {\n                text: _this.intl.formatDate(date, part.pattern),\n                value: date\n            };\n        };\n        this.min = min;\n        this.max = max;\n        this.step = step;\n    };\n    HoursService.prototype.data = function (selectedValue) {\n        var _this = this;\n        var min = this.range(selectedValue)[0];\n        var getHour = stepper(min, this.step);\n        var convertToItem = function (idx) { return (_this.toListItem(getHour(idx))); };\n        var data = range(0, this.countFromMin(selectedValue)).map(convertToItem);\n        this.addLast(data);\n        if (selectedValue) {\n            this.addMissing(data, selectedValue);\n        }\n        return data;\n    };\n    HoursService.prototype.isRangeChanged = function (min, max) {\n        return !isEqual(this.min, min) || !isEqual(this.max, max);\n    };\n    HoursService.prototype.limitRange = function (min, max, value) {\n        return this.boundRange ? [limitDown(min, value), limitUp(max, value)] : [min, max];\n    };\n    HoursService.prototype.total = function (value) {\n        var last = this.insertUndividedMax && this.isLastMissing(value) ? 1 : 0;\n        var missing = this.isMissing(value) ? 1 : 0;\n        return this.countFromMin(value) + missing + last;\n    };\n    HoursService.prototype.selectedIndex = function (value) {\n        return Math.ceil(this.divideByStep(value));\n    };\n    HoursService.prototype.valueInList = function (value) {\n        if (!value) {\n            return true;\n        }\n        var matchMax = this.insertUndividedMax && this.lastHour(value) === value.getHours();\n        return matchMax || !this.isMissing(value);\n    };\n    HoursService.prototype.addLast = function (data, value) {\n        if (this.insertUndividedMax && this.isLastMissing(value)) {\n            data.push(this.toListItem(this.lastHour(value)));\n        }\n        return data;\n    };\n    HoursService.prototype.addMissing = function (data, value) {\n        if (this.valueInList(value)) {\n            return data;\n        }\n        var missingItem = this.toListItem(value.getHours());\n        data.splice(this.selectedIndex(value), 0, missingItem);\n        return data;\n    };\n    HoursService.prototype.countFromMin = function (value) {\n        var _a = this.range(value), min = _a[0], max = _a[1];\n        return Math.floor(distanceFromMin(max, min) / this.step) + 1; /* include min */\n    };\n    HoursService.prototype.isMissing = function (value) {\n        if (!value) {\n            return false;\n        }\n        return this.selectedIndex(value) !== this.divideByStep(value);\n    };\n    HoursService.prototype.isLastMissing = function (value) {\n        return this.isMissing(setHours(this.max, this.lastHour(value)));\n    };\n    HoursService.prototype.divideByStep = function (value) {\n        return distanceFromMin(value.getHours(), this.min.getHours()) / this.step;\n    };\n    HoursService.prototype.lastHour = function (value) {\n        return this.range(value)[1];\n    };\n    HoursService.prototype.range = function (value) {\n        var _a = this.limitRange(this.min, this.max, value), min = _a[0], max = _a[1];\n        return [min.getHours(), max.getHours()];\n    };\n    return HoursService;\n}());\nexport { HoursService };\n//# sourceMappingURL=HoursService.js.map"]},"metadata":{},"sourceType":"module"}