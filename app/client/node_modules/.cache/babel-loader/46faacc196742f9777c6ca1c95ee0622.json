{"ast":null,"code":"var maxHeightIE = 1533915;\n/**\n * @hidden\n */\n\nvar VirtualScroll =\n/** @class */\nfunction () {\n  function VirtualScroll() {\n    var _this = this;\n\n    this.containerHeight = 0;\n    this.skip = 0;\n    this.total = 0;\n    this.enabled = false;\n    this.pageSize = 0;\n    this.itemHeight = 0;\n    this.prevScrollPos = 0;\n    this.listTranslate = 0;\n    this.scrollSyncing = false;\n\n    this.scrollerRef = function (element) {\n      var vs = _this;\n      vs.container = element;\n\n      if (element) {\n        element.setAttribute('unselectable', 'on');\n        setTimeout(vs.calcScrollElementHeight.bind(vs), 0);\n      }\n    };\n\n    this.calcScrollElementHeight = function () {\n      _this.scrollSyncing = true;\n      var heightChanged = false;\n      _this.itemHeight = _this.list ? _this.list.children[0].offsetHeight : _this.itemHeight;\n      _this.containerHeight = Math.min(maxHeightIE, _this.itemHeight * _this.total);\n      var newHeight = _this.containerHeight;\n\n      if (_this.scrollElement) {\n        heightChanged = _this.scrollElement.style.height !== newHeight + 'px';\n\n        if (heightChanged) {\n          _this.scrollElement.style.height = newHeight + 'px';\n        }\n      }\n\n      _this.scrollSyncing = false;\n      return heightChanged;\n    };\n\n    this.scrollHandler = this.scrollHandler.bind(this);\n  }\n\n  Object.defineProperty(VirtualScroll.prototype, \"translate\", {\n    get: function () {\n      return this.listTranslate;\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  VirtualScroll.prototype.changePage = function (skip, e) {\n    var newSkip = Math.min(Math.max(0, skip), this.total - this.pageSize);\n\n    if (newSkip !== this.skip) {\n      this.PageChange({\n        skip: newSkip,\n        take: this.pageSize\n      }, e);\n    }\n  };\n\n  VirtualScroll.prototype.translateTo = function (dY) {\n    this.listTranslate = dY;\n\n    if (this.list) {\n      this.list.style.transform = 'translateY(' + dY + 'px)';\n    }\n  };\n\n  VirtualScroll.prototype.reset = function () {\n    if (this.container) {\n      this.calcScrollElementHeight();\n      this.container.scrollTop = 0;\n      this.translateTo(0);\n    }\n  };\n\n  VirtualScroll.prototype.scrollToEnd = function () {\n    if (this.container && this.list) {\n      this.calcScrollElementHeight();\n      this.container.scrollTop = this.container.scrollHeight - this.container.offsetHeight;\n      this.translateTo(this.container.scrollHeight - this.list.offsetHeight);\n    }\n  };\n\n  VirtualScroll.prototype.localScrollUp = function (e) {\n    var height = this.itemHeight;\n    var scrollTop = this.container.scrollTop;\n    var targetTranslate = this.listTranslate;\n    var items;\n    var additionalOnTop = scrollTop - targetTranslate;\n\n    if (additionalOnTop > height) {\n      return;\n    }\n\n    for (items = 0; items < this.skip; items++) {\n      if (targetTranslate + height + additionalOnTop <= scrollTop) {\n        break;\n      }\n\n      targetTranslate -= height;\n    }\n\n    targetTranslate = this.validateTranslate(targetTranslate);\n\n    if (this.skip - items <= 0 && targetTranslate >= scrollTop) {\n      this.translateTo(0);\n      this.changePage(0, e);\n      this.container.scrollTop = 0;\n      return;\n    }\n\n    if (targetTranslate !== this.listTranslate) {\n      this.translateTo(targetTranslate);\n      this.changePage(this.skip - items, e);\n    }\n  };\n\n  VirtualScroll.prototype.localScrollDown = function (e) {\n    var height = this.itemHeight;\n    var scrollTop = this.container.scrollTop;\n    var targetTranslate = this.listTranslate;\n    var itemsLenght = this.list.children.length;\n    var items;\n\n    for (items = 0; items < itemsLenght; items++) {\n      if (targetTranslate + height >= scrollTop) {\n        break;\n      }\n\n      targetTranslate += height;\n    }\n\n    targetTranslate = this.validateTranslate(targetTranslate);\n\n    if (items >= itemsLenght && this.skip + items >= this.total) {\n      this.translateTo(targetTranslate);\n      this.changePage(this.total - 1, e);\n    } else if (targetTranslate !== this.listTranslate) {\n      this.translateTo(targetTranslate);\n      this.changePage(this.skip + items, e);\n    }\n  };\n\n  VirtualScroll.prototype.scrollNonStrict = function (e) {\n    var floatItemIndex = this.total * this.prevScrollPos / this.containerHeight;\n    var itemIndex = Math.min(Math.floor(floatItemIndex), this.total - 1);\n    var targetTranslate = this.containerHeight * floatItemIndex / this.total;\n    targetTranslate = this.validateTranslate(targetTranslate);\n    this.translateTo(targetTranslate);\n    this.changePage(itemIndex, e);\n  };\n\n  VirtualScroll.prototype.scrollHandler = function (e) {\n    var scrollTop = this.container ? this.container.scrollTop : 0;\n    var prev = this.prevScrollPos;\n    this.prevScrollPos = scrollTop;\n\n    if (!this.enabled || !this.list || !this.container || this.scrollSyncing) {\n      return;\n    }\n\n    if (scrollTop - prev <= 0 && scrollTop > this.listTranslate - this.list.scrollHeight / 10) {\n      this.localScrollUp(e);\n    } else if (scrollTop - prev > 0 && scrollTop < this.listTranslate + this.list.scrollHeight * 2 / 3) {\n      this.localScrollDown(e);\n    } else {\n      this.scrollNonStrict(e);\n    }\n  };\n\n  VirtualScroll.prototype.validateTranslate = function (translate) {\n    translate = Math.max(0, translate);\n    translate = Math.min(this.containerHeight - this.list.offsetHeight, translate);\n    return translate;\n  };\n\n  return VirtualScroll;\n}();\n\nexport default VirtualScroll;","map":{"version":3,"sources":["../../../src/common/VirtualScroll.tsx"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["var maxHeightIE = 1533915;\n/**\n * @hidden\n */\nvar VirtualScroll = /** @class */ (function () {\n    function VirtualScroll() {\n        var _this = this;\n        this.containerHeight = 0;\n        this.skip = 0;\n        this.total = 0;\n        this.enabled = false;\n        this.pageSize = 0;\n        this.itemHeight = 0;\n        this.prevScrollPos = 0;\n        this.listTranslate = 0;\n        this.scrollSyncing = false;\n        this.scrollerRef = function (element) {\n            var vs = _this;\n            vs.container = element;\n            if (element) {\n                element.setAttribute('unselectable', 'on');\n                setTimeout(vs.calcScrollElementHeight.bind(vs), 0);\n            }\n        };\n        this.calcScrollElementHeight = function () {\n            _this.scrollSyncing = true;\n            var heightChanged = false;\n            _this.itemHeight = _this.list ? _this.list.children[0].offsetHeight : _this.itemHeight;\n            _this.containerHeight = Math.min(maxHeightIE, _this.itemHeight * _this.total);\n            var newHeight = _this.containerHeight;\n            if (_this.scrollElement) {\n                heightChanged = _this.scrollElement.style.height !== newHeight + 'px';\n                if (heightChanged) {\n                    _this.scrollElement.style.height = newHeight + 'px';\n                }\n            }\n            _this.scrollSyncing = false;\n            return heightChanged;\n        };\n        this.scrollHandler = this.scrollHandler.bind(this);\n    }\n    Object.defineProperty(VirtualScroll.prototype, \"translate\", {\n        get: function () {\n            return this.listTranslate;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    VirtualScroll.prototype.changePage = function (skip, e) {\n        var newSkip = Math.min(Math.max(0, skip), this.total - this.pageSize);\n        if (newSkip !== this.skip) {\n            this.PageChange({ skip: newSkip, take: this.pageSize }, e);\n        }\n    };\n    VirtualScroll.prototype.translateTo = function (dY) {\n        this.listTranslate = dY;\n        if (this.list) {\n            this.list.style.transform = 'translateY(' + dY + 'px)';\n        }\n    };\n    VirtualScroll.prototype.reset = function () {\n        if (this.container) {\n            this.calcScrollElementHeight();\n            this.container.scrollTop = 0;\n            this.translateTo(0);\n        }\n    };\n    VirtualScroll.prototype.scrollToEnd = function () {\n        if (this.container && this.list) {\n            this.calcScrollElementHeight();\n            this.container.scrollTop = this.container.scrollHeight - this.container.offsetHeight;\n            this.translateTo(this.container.scrollHeight - this.list.offsetHeight);\n        }\n    };\n    VirtualScroll.prototype.localScrollUp = function (e) {\n        var height = this.itemHeight;\n        var scrollTop = this.container.scrollTop;\n        var targetTranslate = this.listTranslate;\n        var items;\n        var additionalOnTop = scrollTop - targetTranslate;\n        if (additionalOnTop > height) {\n            return;\n        }\n        for (items = 0; items < this.skip; items++) {\n            if (targetTranslate + height + additionalOnTop <= scrollTop) {\n                break;\n            }\n            targetTranslate -= height;\n        }\n        targetTranslate = this.validateTranslate(targetTranslate);\n        if (this.skip - items <= 0 && targetTranslate >= scrollTop) {\n            this.translateTo(0);\n            this.changePage(0, e);\n            this.container.scrollTop = 0;\n            return;\n        }\n        if (targetTranslate !== this.listTranslate) {\n            this.translateTo(targetTranslate);\n            this.changePage(this.skip - items, e);\n        }\n    };\n    VirtualScroll.prototype.localScrollDown = function (e) {\n        var height = this.itemHeight;\n        var scrollTop = this.container.scrollTop;\n        var targetTranslate = this.listTranslate;\n        var itemsLenght = this.list.children.length;\n        var items;\n        for (items = 0; items < itemsLenght; items++) {\n            if (targetTranslate + height >= scrollTop) {\n                break;\n            }\n            targetTranslate += height;\n        }\n        targetTranslate = this.validateTranslate(targetTranslate);\n        if (items >= itemsLenght && this.skip + items >= this.total) {\n            this.translateTo(targetTranslate);\n            this.changePage(this.total - 1, e);\n        }\n        else if (targetTranslate !== this.listTranslate) {\n            this.translateTo(targetTranslate);\n            this.changePage(this.skip + items, e);\n        }\n    };\n    VirtualScroll.prototype.scrollNonStrict = function (e) {\n        var floatItemIndex = this.total * this.prevScrollPos / (this.containerHeight);\n        var itemIndex = Math.min(Math.floor(floatItemIndex), this.total - 1);\n        var targetTranslate = this.containerHeight * floatItemIndex / this.total;\n        targetTranslate = this.validateTranslate(targetTranslate);\n        this.translateTo(targetTranslate);\n        this.changePage(itemIndex, e);\n    };\n    VirtualScroll.prototype.scrollHandler = function (e) {\n        var scrollTop = this.container ? this.container.scrollTop : 0;\n        var prev = this.prevScrollPos;\n        this.prevScrollPos = scrollTop;\n        if (!this.enabled || !this.list || !this.container || this.scrollSyncing) {\n            return;\n        }\n        if (scrollTop - prev <= 0 && scrollTop > this.listTranslate - this.list.scrollHeight / 10) {\n            this.localScrollUp(e);\n        }\n        else if (scrollTop - prev > 0 && scrollTop < this.listTranslate + this.list.scrollHeight * 2 / 3) {\n            this.localScrollDown(e);\n        }\n        else {\n            this.scrollNonStrict(e);\n        }\n    };\n    VirtualScroll.prototype.validateTranslate = function (translate) {\n        translate = Math.max(0, translate);\n        translate = Math.min(this.containerHeight - this.list.offsetHeight, translate);\n        return translate;\n    };\n    return VirtualScroll;\n}());\nexport default VirtualScroll;\n//# sourceMappingURL=VirtualScroll.js.map"]},"metadata":{},"sourceType":"module"}