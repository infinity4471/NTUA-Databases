{"ast":null,"code":"import { isPresent } from '../utils';\nimport { compose } from '../funcs'; // tslint:enable:max-line-length\n\nvar set = function (field, target, value) {\n  target[field] = value;\n  return target;\n};\n\nvar toCamelCase = function (str) {\n  return str.replace(/(^[A-Z])/g, function (_, g1) {\n    return g1.toLowerCase();\n  });\n};\n\nvar prop = function (fieldName) {\n  return function (obj) {\n    var value = obj[fieldName];\n\n    if (isPresent(value)) {\n      return value;\n    }\n\n    return obj[toCamelCase(fieldName)];\n  };\n};\n\nvar member = prop(\"Member\");\nvar aggregateMethodName = prop(\"AggregateMethodName\");\nvar value = prop(\"Value\");\n\nvar convert = function (mapper) {\n  return function (values) {\n    return Object.keys(values).reduce(mapper.bind(null, values), {});\n  };\n};\n\nvar translateAggregate = convert(function (source, acc, field) {\n  return set(field.toLowerCase(), acc, source[field]);\n});\nvar translateAggregates = convert(function (source, acc, field) {\n  return set(field, acc, translateAggregate(source[field]));\n});\n\nvar valueOrDefault = function (value, defaultValue) {\n  return isPresent(value) ? value : defaultValue;\n};\n\nvar normalizeGroup = function (group) {\n  return {\n    aggregates: group.Aggregates || group.aggregates,\n    field: group.Member || group.member || group.field,\n    hasSubgroups: group.HasSubgroups || group.hasSubgroups || false,\n    items: group.Items || group.items,\n    value: valueOrDefault(group.Key, valueOrDefault(group.key, group.value))\n  };\n};\n\nvar translateGroup = compose(function (_a) {\n  var field = _a.field,\n      hasSubgroups = _a.hasSubgroups,\n      value = _a.value,\n      aggregates = _a.aggregates,\n      items = _a.items;\n  return {\n    aggregates: translateAggregates(aggregates),\n    field: field,\n    items: hasSubgroups ? items.map(translateGroup) : items,\n    value: value\n  };\n}, normalizeGroup); // tslint:disable:max-line-length\n\n/**\n * Converts the grouped result, which is returned into the `Data` field of the UI for ASP.NET MVC `ToDataSourceResult` method, to a comparable format.\n * @param data - The value of the `Data` field of the response.\n * @returns {GroupResult[]} - The converted result.\n */\n\nexport var translateDataSourceResultGroups = function (data) {\n  return data.map(translateGroup);\n};\n/**\n * Converts the `AggregateResults` field content, which is returned by the UI for ASP.NET MVC `ToDataSourceResult` method, to a comparable format.\n * @param data - The value of the `AggregateResults` field of the response.\n * @returns {AggregateResult} - The converted result.\n */\n// tslint:enable:max-line-length\n\nexport var translateAggregateResults = function (data) {\n  return (data || []).reduce(function (acc, x) {\n    return set(member(x), acc, set(aggregateMethodName(x).toLowerCase(), acc[member(x)] || {}, value(x)));\n  }, {});\n};","map":{"version":3,"sources":["/home/infinity/Desktop/supermarket/NTUA-Databases/app/client/node_modules/@progress/kendo-data-query/dist/es/mvc/deserialization.js"],"names":["isPresent","compose","set","field","target","value","toCamelCase","str","replace","_","g1","toLowerCase","prop","fieldName","obj","member","aggregateMethodName","convert","mapper","values","Object","keys","reduce","bind","translateAggregate","source","acc","translateAggregates","valueOrDefault","defaultValue","normalizeGroup","group","aggregates","Aggregates","Member","hasSubgroups","HasSubgroups","items","Items","Key","key","translateGroup","_a","map","translateDataSourceResultGroups","data","translateAggregateResults","x"],"mappings":"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","sourcesContent":["import { isPresent } from '../utils';\nimport { compose } from '../funcs';\n// tslint:enable:max-line-length\nvar set = function (field, target, value) {\n    target[field] = value;\n    return target;\n};\nvar toCamelCase = function (str) { return str.replace(/(^[A-Z])/g, function (_, g1) { return g1.toLowerCase(); }); };\nvar prop = function (fieldName) { return function (obj) {\n    var value = obj[fieldName];\n    if (isPresent(value)) {\n        return value;\n    }\n    return obj[toCamelCase(fieldName)];\n}; };\nvar member = prop(\"Member\");\nvar aggregateMethodName = prop(\"AggregateMethodName\");\nvar value = prop(\"Value\");\nvar convert = function (mapper) { return function (values) { return Object.keys(values).reduce(mapper.bind(null, values), {}); }; };\nvar translateAggregate = convert(function (source, acc, field) { return set(field.toLowerCase(), acc, source[field]); });\nvar translateAggregates = convert(function (source, acc, field) { return set(field, acc, translateAggregate(source[field])); });\nvar valueOrDefault = function (value, defaultValue) { return isPresent(value) ? value : defaultValue; };\nvar normalizeGroup = function (group) { return ({\n    aggregates: group.Aggregates || group.aggregates,\n    field: group.Member || group.member || group.field,\n    hasSubgroups: group.HasSubgroups || group.hasSubgroups || false,\n    items: group.Items || group.items,\n    value: valueOrDefault(group.Key, valueOrDefault(group.key, group.value))\n}); };\nvar translateGroup = compose(function (_a) {\n    var field = _a.field, hasSubgroups = _a.hasSubgroups, value = _a.value, aggregates = _a.aggregates, items = _a.items;\n    return ({\n        aggregates: translateAggregates(aggregates),\n        field: field,\n        items: hasSubgroups ? items.map(translateGroup) : items,\n        value: value\n    });\n}, normalizeGroup);\n// tslint:disable:max-line-length\n/**\n * Converts the grouped result, which is returned into the `Data` field of the UI for ASP.NET MVC `ToDataSourceResult` method, to a comparable format.\n * @param data - The value of the `Data` field of the response.\n * @returns {GroupResult[]} - The converted result.\n */\nexport var translateDataSourceResultGroups = function (data) { return data.map(translateGroup); };\n/**\n * Converts the `AggregateResults` field content, which is returned by the UI for ASP.NET MVC `ToDataSourceResult` method, to a comparable format.\n * @param data - The value of the `AggregateResults` field of the response.\n * @returns {AggregateResult} - The converted result.\n */\n// tslint:enable:max-line-length\nexport var translateAggregateResults = function (data) { return ((data || []).reduce(function (acc, x) { return set(member(x), acc, set(aggregateMethodName(x).toLowerCase(), acc[member(x)] || {}, value(x))); }, {})); };\n"]},"metadata":{},"sourceType":"module"}