{"ast":null,"code":"import { getIndex } from './../header/';\n/**\n * @hidden\n */\n\nvar CommonDragLogic =\n/** @class */\nfunction () {\n  function CommonDragLogic(columnReorder, groupReorder, columnToGroup) {\n    var _this = this;\n\n    this.reorderable = false;\n    this.groupable = false;\n    this.startColumn = -1;\n    this.startGroup = -1;\n    this.currentColumn = -1;\n    this.currentGroup = -1;\n    this.dropElementClue = null;\n    this.dragElementClue = null;\n    this.groupPanelDivElement = null;\n\n    this.refGroupPanelDiv = function (e) {\n      _this.groupPanelDivElement = e;\n    };\n\n    this.refDropElementClue = function (e) {\n      _this.dropElementClue = e;\n    };\n\n    this.refDragElementClue = function (e) {\n      _this.dragElementClue = e;\n    };\n\n    this.pressHandler = function (event, element) {\n      if (!event.isTouch) {\n        event.originalEvent.preventDefault();\n      }\n\n      var startColumn = _this.getColumnIndex(event, element);\n\n      _this.startGroup = _this.getGroupIndex(event);\n\n      if (startColumn >= 0) {\n        var col = _this.columns[startColumn];\n\n        if (col.reorderable && _this.reorderable || col.groupable && _this.groupable) {\n          _this.startColumn = startColumn;\n        }\n      }\n    };\n\n    this.dragHandler = function (event, element) {\n      if (!event.isTouch) {\n        event.originalEvent.preventDefault();\n      }\n\n      event.originalEvent.stopPropagation();\n\n      if (_this.startColumn === -1 && _this.startGroup === -1) {\n        return;\n      }\n\n      _this.currentColumn = _this.getColumnIndex(event, element);\n      _this.currentGroup = _this.getGroupIndex(event);\n\n      if (_this.groupPanelDivElement && _this.startGroup >= 0) {\n        _this.currentGroup = Math.min(_this.currentGroup, _this.groupPanelDivElement.children.length - 2);\n      }\n\n      var invalidIndex = !_this.isValid();\n\n      if (invalidIndex) {\n        _this.currentColumn = -1;\n        _this.currentGroup = -1;\n      }\n\n      var targetElement = _this.currentColumn >= 0 ? element.children[_this.columns[_this.currentColumn].index] : _this.groupPanelDivElement && _this.groupPanelDivElement.children[_this.currentGroup];\n\n      _this.updateDragElementClue(event, element, targetElement, invalidIndex);\n\n      _this.updateDropElementClue(event, element, targetElement, invalidIndex);\n    };\n\n    this.releaseHandler = function (event) {\n      var prevColumnIndex = _this.startColumn;\n      var nextColumnIndex = _this.currentColumn;\n      var prevGroupIndex = _this.startGroup;\n      var nextGroupIndex = _this.currentGroup;\n\n      if (_this.dropElementClue) {\n        _this.dropElementClue.setState({\n          visible: false\n        });\n      }\n\n      if (_this.dragElementClue) {\n        _this.dragElementClue.setState({\n          visible: false\n        });\n      }\n\n      var isValid = _this.isValid();\n\n      _this.startColumn = _this.startGroup = _this.currentColumn = _this.currentGroup = -1;\n\n      if (!isValid) {\n        return;\n      }\n\n      if (prevColumnIndex >= 0 && nextColumnIndex >= 0) {\n        _this.columnReorder(prevColumnIndex, nextColumnIndex, event.originalEvent);\n      } else if (prevGroupIndex >= 0 && nextGroupIndex >= 0) {\n        _this.groupReorder(prevGroupIndex, nextGroupIndex, event.originalEvent);\n      } else if (prevColumnIndex >= 0 && nextGroupIndex >= 0) {\n        _this.columnToGroup(prevColumnIndex, nextGroupIndex, event.originalEvent);\n      }\n    };\n\n    this.columnReorder = columnReorder;\n    this.groupReorder = groupReorder;\n    this.columnToGroup = columnToGroup;\n  }\n\n  CommonDragLogic.prototype.getColumnIndex = function (event, parent) {\n    if (!parent || parent.parentElement === this.groupPanelDivElement) {\n      return -1;\n    }\n\n    var index = getIndex(event, parent);\n\n    if (index === -1) {\n      return -1;\n    }\n\n    var _loop_1 = function (i) {\n      if (parent.parentNode.children[i] === parent) {\n        return {\n          value: this_1.columns.findIndex(function (c) {\n            return c.index === index && c.depth === i;\n          })\n        };\n      }\n    };\n\n    var this_1 = this;\n\n    for (var i = 0; i < parent.parentNode.children.length; i++) {\n      var state_1 = _loop_1(i);\n\n      if (typeof state_1 === \"object\") return state_1.value;\n    }\n\n    return -1;\n  };\n\n  CommonDragLogic.prototype.getGroupIndex = function (event) {\n    return getIndex(event, this.groupPanelDivElement);\n  };\n\n  CommonDragLogic.prototype.isValid = function () {\n    if (this.startGroup >= 0) {\n      // group can be moved into group only\n      return this.currentGroup >= 0 && this.currentGroup !== this.startGroup;\n    }\n\n    if (this.startColumn === -1) {\n      return false;\n    }\n\n    if (this.currentGroup >= 0) {\n      // column to group is possible\n      return this.columns[this.startColumn].groupable === true && this.groupable === true;\n    } // reorder is possible\n\n\n    return this.reorderable === true && this.currentColumn >= 0 && this.currentColumn !== this.startColumn && this.columns[this.startColumn].reorderable === true && this.columns[this.currentColumn].parentIndex === this.columns[this.startColumn].parentIndex;\n  };\n\n  CommonDragLogic.prototype.updateDragElementClue = function (event, element, targetElement, invalidIndex) {\n    if (!this.dragElementClue) {\n      return;\n    }\n\n    var innerText = this.startColumn >= 0 ? element.children[this.columns[this.startColumn].index].innerText : element.innerText;\n    this.dragElementClue.setState({\n      visible: true,\n      top: event.pageY + 10,\n      left: event.pageX,\n      innerText: innerText,\n      status: invalidIndex || !targetElement ? 'k-i-cancel' : 'k-i-add'\n    });\n  };\n\n  CommonDragLogic.prototype.updateDropElementClue = function (event, element, targetElement, invalidIndex) {\n    if (!this.dropElementClue) {\n      return;\n    }\n\n    if (invalidIndex || !targetElement) {\n      this.dropElementClue.setState({\n        visible: false\n      });\n      return;\n    }\n\n    var rect = targetElement.getBoundingClientRect();\n    var left = rect.left + event.pageX - event.clientX - 6;\n\n    if (this.currentColumn > this.startColumn || this.currentGroup > this.startGroup && this.startGroup !== -1) {\n      left += rect.width;\n    }\n\n    var top = rect.top + event.pageY - event.clientY;\n    this.dropElementClue.setState({\n      visible: true,\n      top: top,\n      left: left,\n      height: this.currentColumn >= 0 ? element.clientHeight : rect.height\n    });\n  };\n\n  return CommonDragLogic;\n}();\n\nexport { CommonDragLogic };","map":{"version":3,"sources":["../../../src/drag/CommonDragLogic.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["import { getIndex } from './../header/';\n/**\n * @hidden\n */\nvar CommonDragLogic = /** @class */ (function () {\n    function CommonDragLogic(columnReorder, groupReorder, columnToGroup) {\n        var _this = this;\n        this.reorderable = false;\n        this.groupable = false;\n        this.startColumn = -1;\n        this.startGroup = -1;\n        this.currentColumn = -1;\n        this.currentGroup = -1;\n        this.dropElementClue = null;\n        this.dragElementClue = null;\n        this.groupPanelDivElement = null;\n        this.refGroupPanelDiv = function (e) {\n            _this.groupPanelDivElement = e;\n        };\n        this.refDropElementClue = function (e) {\n            _this.dropElementClue = e;\n        };\n        this.refDragElementClue = function (e) {\n            _this.dragElementClue = e;\n        };\n        this.pressHandler = function (event, element) {\n            if (!event.isTouch) {\n                event.originalEvent.preventDefault();\n            }\n            var startColumn = _this.getColumnIndex(event, element);\n            _this.startGroup = _this.getGroupIndex(event);\n            if (startColumn >= 0) {\n                var col = _this.columns[startColumn];\n                if (col.reorderable && _this.reorderable || col.groupable && _this.groupable) {\n                    _this.startColumn = startColumn;\n                }\n            }\n        };\n        this.dragHandler = function (event, element) {\n            if (!event.isTouch) {\n                event.originalEvent.preventDefault();\n            }\n            event.originalEvent.stopPropagation();\n            if (_this.startColumn === -1 && _this.startGroup === -1) {\n                return;\n            }\n            _this.currentColumn = _this.getColumnIndex(event, element);\n            _this.currentGroup = _this.getGroupIndex(event);\n            if (_this.groupPanelDivElement && _this.startGroup >= 0) {\n                _this.currentGroup = Math.min(_this.currentGroup, _this.groupPanelDivElement.children.length - 2);\n            }\n            var invalidIndex = !_this.isValid();\n            if (invalidIndex) {\n                _this.currentColumn = -1;\n                _this.currentGroup = -1;\n            }\n            var targetElement = (_this.currentColumn >= 0) ?\n                element.children[_this.columns[_this.currentColumn].index] :\n                _this.groupPanelDivElement && _this.groupPanelDivElement.children[_this.currentGroup];\n            _this.updateDragElementClue(event, element, targetElement, invalidIndex);\n            _this.updateDropElementClue(event, element, targetElement, invalidIndex);\n        };\n        this.releaseHandler = function (event) {\n            var prevColumnIndex = _this.startColumn;\n            var nextColumnIndex = _this.currentColumn;\n            var prevGroupIndex = _this.startGroup;\n            var nextGroupIndex = _this.currentGroup;\n            if (_this.dropElementClue) {\n                _this.dropElementClue.setState({ visible: false });\n            }\n            if (_this.dragElementClue) {\n                _this.dragElementClue.setState({ visible: false });\n            }\n            var isValid = _this.isValid();\n            _this.startColumn = _this.startGroup = _this.currentColumn = _this.currentGroup = -1;\n            if (!isValid) {\n                return;\n            }\n            if (prevColumnIndex >= 0 && nextColumnIndex >= 0) {\n                _this.columnReorder(prevColumnIndex, nextColumnIndex, event.originalEvent);\n            }\n            else if (prevGroupIndex >= 0 && nextGroupIndex >= 0) {\n                _this.groupReorder(prevGroupIndex, nextGroupIndex, event.originalEvent);\n            }\n            else if (prevColumnIndex >= 0 && nextGroupIndex >= 0) {\n                _this.columnToGroup(prevColumnIndex, nextGroupIndex, event.originalEvent);\n            }\n        };\n        this.columnReorder = columnReorder;\n        this.groupReorder = groupReorder;\n        this.columnToGroup = columnToGroup;\n    }\n    CommonDragLogic.prototype.getColumnIndex = function (event, parent) {\n        if (!parent || (parent.parentElement === this.groupPanelDivElement)) {\n            return -1;\n        }\n        var index = getIndex(event, parent);\n        if (index === -1) {\n            return -1;\n        }\n        var _loop_1 = function (i) {\n            if (parent.parentNode.children[i] === parent) {\n                return { value: this_1.columns.findIndex(function (c) { return ((c.index === index) && (c.depth === i)); }) };\n            }\n        };\n        var this_1 = this;\n        for (var i = 0; i < parent.parentNode.children.length; i++) {\n            var state_1 = _loop_1(i);\n            if (typeof state_1 === \"object\")\n                return state_1.value;\n        }\n        return -1;\n    };\n    CommonDragLogic.prototype.getGroupIndex = function (event) {\n        return getIndex(event, this.groupPanelDivElement);\n    };\n    CommonDragLogic.prototype.isValid = function () {\n        if (this.startGroup >= 0) {\n            // group can be moved into group only\n            return this.currentGroup >= 0 && this.currentGroup !== this.startGroup;\n        }\n        if (this.startColumn === -1) {\n            return false;\n        }\n        if (this.currentGroup >= 0) {\n            // column to group is possible\n            return this.columns[this.startColumn].groupable === true && this.groupable === true;\n        }\n        // reorder is possible\n        return this.reorderable === true &&\n            this.currentColumn >= 0 &&\n            this.currentColumn !== this.startColumn &&\n            this.columns[this.startColumn].reorderable === true &&\n            this.columns[this.currentColumn].parentIndex === this.columns[this.startColumn].parentIndex;\n    };\n    CommonDragLogic.prototype.updateDragElementClue = function (event, element, targetElement, invalidIndex) {\n        if (!this.dragElementClue) {\n            return;\n        }\n        var innerText = this.startColumn >= 0 ?\n            element.children[this.columns[this.startColumn].index].innerText :\n            element.innerText;\n        this.dragElementClue.setState({\n            visible: true,\n            top: (event.pageY + 10),\n            left: event.pageX,\n            innerText: innerText,\n            status: (invalidIndex || !targetElement) ? 'k-i-cancel' : 'k-i-add'\n        });\n    };\n    CommonDragLogic.prototype.updateDropElementClue = function (event, element, targetElement, invalidIndex) {\n        if (!this.dropElementClue) {\n            return;\n        }\n        if (invalidIndex || !targetElement) {\n            this.dropElementClue.setState({ visible: false });\n            return;\n        }\n        var rect = targetElement.getBoundingClientRect();\n        var left = rect.left + event.pageX - event.clientX - 6;\n        if (this.currentColumn > this.startColumn || this.currentGroup > this.startGroup && this.startGroup !== -1) {\n            left += rect.width;\n        }\n        var top = rect.top + event.pageY - event.clientY;\n        this.dropElementClue.setState({\n            visible: true,\n            top: top,\n            left: left,\n            height: (this.currentColumn >= 0) ? element.clientHeight : rect.height\n        });\n    };\n    return CommonDragLogic;\n}());\nexport { CommonDragLogic };\n//# sourceMappingURL=CommonDragLogic.js.map"]},"metadata":{},"sourceType":"module"}