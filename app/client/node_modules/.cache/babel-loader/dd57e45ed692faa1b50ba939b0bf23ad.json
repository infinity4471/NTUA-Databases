{"ast":null,"code":"import Group from './group';\nimport Size from '../geometry/size';\nimport Rect from '../geometry/rect';\nimport Point from '../geometry/point';\nimport createTransform from '../geometry/transform';\nimport translateToPoint from '../alignment/translate-to-point';\nimport alignStart from '../alignment/align-start';\nimport alignStartReverse from '../alignment/align-start-reverse';\nvar DEFAULT_OPTIONS = {\n  alignContent: \"start\",\n  justifyContent: \"start\",\n  alignItems: \"start\",\n  spacing: 0,\n  orientation: \"horizontal\",\n  lineSpacing: 0,\n  wrap: true,\n  revers: false\n};\n\nvar forEach = function (elements, callback) {\n  elements.forEach(callback);\n};\n\nvar forEachReverse = function (elements, callback) {\n  var length = elements.length;\n\n  for (var idx = length - 1; idx >= 0; idx--) {\n    callback(elements[idx], idx);\n  }\n};\n\nvar Layout = function (Group) {\n  function Layout(rect, options) {\n    Group.call(this, Object.assign({}, DEFAULT_OPTIONS, options));\n    this._rect = rect;\n    this._fieldMap = {};\n  }\n\n  if (Group) Layout.__proto__ = Group;\n  Layout.prototype = Object.create(Group && Group.prototype);\n  Layout.prototype.constructor = Layout;\n\n  Layout.prototype.rect = function rect(value) {\n    if (value) {\n      this._rect = value;\n      return this;\n    }\n\n    return this._rect;\n  };\n\n  Layout.prototype._initMap = function _initMap() {\n    var options = this.options;\n    var fieldMap = this._fieldMap;\n\n    if (options.orientation === \"horizontal\") {\n      fieldMap.sizeField = \"width\";\n      fieldMap.groupsSizeField = \"height\";\n      fieldMap.groupAxis = \"x\";\n      fieldMap.groupsAxis = \"y\";\n    } else {\n      fieldMap.sizeField = \"height\";\n      fieldMap.groupsSizeField = \"width\";\n      fieldMap.groupAxis = \"y\";\n      fieldMap.groupsAxis = \"x\";\n    }\n\n    if (options.reverse) {\n      this.forEach = forEachReverse;\n      this.justifyAlign = alignStartReverse;\n    } else {\n      this.forEach = forEach;\n      this.justifyAlign = alignStart;\n    }\n  };\n\n  Layout.prototype.reflow = function reflow() {\n    var this$1 = this;\n\n    if (!this._rect || this.children.length === 0) {\n      return;\n    }\n\n    this._initMap();\n\n    if (this.options.transform) {\n      this.transform(null);\n    }\n\n    var options = this.options;\n    var rect = this._rect;\n\n    var ref = this._initGroups();\n\n    var groups = ref.groups;\n    var groupsSize = ref.groupsSize;\n    var ref$1 = this._fieldMap;\n    var sizeField = ref$1.sizeField;\n    var groupsSizeField = ref$1.groupsSizeField;\n    var groupAxis = ref$1.groupAxis;\n    var groupsAxis = ref$1.groupsAxis;\n    var groupOrigin = new Point();\n    var elementOrigin = new Point();\n    var size = new Size();\n    var groupStart = alignStart(groupsSize, rect, options.alignContent, groupsAxis, groupsSizeField);\n    var elementStart, group, groupBox;\n\n    var arrangeElements = function (bbox, idx) {\n      var element = group.elements[idx];\n      elementOrigin[groupAxis] = elementStart;\n      elementOrigin[groupsAxis] = alignStart(bbox.size[groupsSizeField], groupBox, options.alignItems, groupsAxis, groupsSizeField);\n      translateToPoint(elementOrigin, bbox, element);\n      elementStart += bbox.size[sizeField] + options.spacing;\n    };\n\n    for (var groupIdx = 0; groupIdx < groups.length; groupIdx++) {\n      group = groups[groupIdx];\n      groupOrigin[groupAxis] = elementStart = this$1.justifyAlign(group.size, rect, options.justifyContent, groupAxis, sizeField);\n      groupOrigin[groupsAxis] = groupStart;\n      size[sizeField] = group.size;\n      size[groupsSizeField] = group.lineSize;\n      groupBox = new Rect(groupOrigin, size);\n      this$1.forEach(group.bboxes, arrangeElements);\n      groupStart += group.lineSize + options.lineSpacing;\n    }\n\n    if (!options.wrap && group.size > rect.size[sizeField]) {\n      var scale = rect.size[sizeField] / groupBox.size[sizeField];\n      var scaledStart = groupBox.topLeft().scale(scale, scale);\n      var scaledSize = groupBox.size[groupsSizeField] * scale;\n      var newStart = alignStart(scaledSize, rect, options.alignContent, groupsAxis, groupsSizeField);\n      var transform = createTransform();\n\n      if (groupAxis === \"x\") {\n        transform.translate(rect.origin.x - scaledStart.x, newStart - scaledStart.y);\n      } else {\n        transform.translate(newStart - scaledStart.x, rect.origin.y - scaledStart.y);\n      }\n\n      transform.scale(scale, scale);\n      this.transform(transform);\n    }\n  };\n\n  Layout.prototype._initGroups = function _initGroups() {\n    var this$1 = this;\n    var ref = this;\n    var options = ref.options;\n    var children = ref.children;\n    var lineSpacing = options.lineSpacing;\n    var wrap = options.wrap;\n    var spacing = options.spacing;\n    var sizeField = this._fieldMap.sizeField;\n\n    var group = this._newGroup();\n\n    var groups = [];\n\n    var addGroup = function () {\n      groups.push(group);\n      groupsSize += group.lineSize + lineSpacing;\n    };\n\n    var groupsSize = -lineSpacing;\n\n    for (var idx = 0; idx < children.length; idx++) {\n      var element = children[idx];\n      var bbox = children[idx].clippedBBox();\n\n      if (element.visible() && bbox) {\n        if (wrap && group.size + bbox.size[sizeField] + spacing > this$1._rect.size[sizeField]) {\n          if (group.bboxes.length === 0) {\n            this$1._addToGroup(group, bbox, element);\n\n            addGroup();\n            group = this$1._newGroup();\n          } else {\n            addGroup();\n            group = this$1._newGroup();\n\n            this$1._addToGroup(group, bbox, element);\n          }\n        } else {\n          this$1._addToGroup(group, bbox, element);\n        }\n      }\n    }\n\n    if (group.bboxes.length) {\n      addGroup();\n    }\n\n    return {\n      groups: groups,\n      groupsSize: groupsSize\n    };\n  };\n\n  Layout.prototype._addToGroup = function _addToGroup(group, bbox, element) {\n    group.size += bbox.size[this._fieldMap.sizeField] + this.options.spacing;\n    group.lineSize = Math.max(bbox.size[this._fieldMap.groupsSizeField], group.lineSize);\n    group.bboxes.push(bbox);\n    group.elements.push(element);\n  };\n\n  Layout.prototype._newGroup = function _newGroup() {\n    return {\n      lineSize: 0,\n      size: -this.options.spacing,\n      bboxes: [],\n      elements: []\n    };\n  };\n\n  return Layout;\n}(Group);\n\nexport default Layout;","map":{"version":3,"sources":["/home/infinity/Desktop/supermarket/NTUA-Databases/app/client/node_modules/@progress/kendo-drawing/dist/es/shapes/layout.js"],"names":["Group","Size","Rect","Point","createTransform","translateToPoint","alignStart","alignStartReverse","DEFAULT_OPTIONS","alignContent","justifyContent","alignItems","spacing","orientation","lineSpacing","wrap","revers","forEach","elements","callback","forEachReverse","length","idx","Layout","rect","options","call","Object","assign","_rect","_fieldMap","__proto__","prototype","create","constructor","value","_initMap","fieldMap","sizeField","groupsSizeField","groupAxis","groupsAxis","reverse","justifyAlign","reflow","this$1","children","transform","ref","_initGroups","groups","groupsSize","ref$1","groupOrigin","elementOrigin","size","groupStart","elementStart","group","groupBox","arrangeElements","bbox","element","groupIdx","lineSize","bboxes","scale","scaledStart","topLeft","scaledSize","newStart","translate","origin","x","y","_newGroup","addGroup","push","clippedBBox","visible","_addToGroup","Math","max"],"mappings":"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","sourcesContent":["import Group from './group';\nimport Size from '../geometry/size';\nimport Rect from '../geometry/rect';\nimport Point from '../geometry/point';\nimport createTransform from '../geometry/transform';\nimport translateToPoint from '../alignment/translate-to-point';\nimport alignStart from '../alignment/align-start';\nimport alignStartReverse from '../alignment/align-start-reverse';\n\nvar DEFAULT_OPTIONS = {\n    alignContent: \"start\",\n    justifyContent: \"start\",\n    alignItems: \"start\",\n    spacing: 0,\n    orientation: \"horizontal\",\n    lineSpacing: 0,\n    wrap: true,\n    revers: false\n};\n\nvar forEach = function (elements, callback) {\n    elements.forEach(callback);\n};\n\nvar forEachReverse = function (elements, callback) {\n    var length = elements.length;\n\n    for (var idx = length - 1; idx >= 0; idx--) {\n        callback(elements[idx], idx);\n    }\n};\n\nvar Layout = (function (Group) {\n    function Layout(rect, options) {\n        Group.call(this, Object.assign({}, DEFAULT_OPTIONS, options));\n        this._rect = rect;\n        this._fieldMap = {};\n    }\n\n    if ( Group ) Layout.__proto__ = Group;\n    Layout.prototype = Object.create( Group && Group.prototype );\n    Layout.prototype.constructor = Layout;\n\n    Layout.prototype.rect = function rect (value) {\n        if (value) {\n            this._rect = value;\n            return this;\n        }\n\n        return this._rect;\n    };\n\n    Layout.prototype._initMap = function _initMap () {\n        var options = this.options;\n        var fieldMap = this._fieldMap;\n        if (options.orientation === \"horizontal\") {\n            fieldMap.sizeField = \"width\";\n            fieldMap.groupsSizeField = \"height\";\n            fieldMap.groupAxis = \"x\";\n            fieldMap.groupsAxis = \"y\";\n        } else {\n            fieldMap.sizeField = \"height\";\n            fieldMap.groupsSizeField = \"width\";\n            fieldMap.groupAxis = \"y\";\n            fieldMap.groupsAxis = \"x\";\n        }\n\n        if (options.reverse) {\n            this.forEach = forEachReverse;\n            this.justifyAlign = alignStartReverse;\n        } else {\n            this.forEach = forEach;\n            this.justifyAlign = alignStart;\n        }\n    };\n\n    Layout.prototype.reflow = function reflow () {\n        var this$1 = this;\n\n        if (!this._rect || this.children.length === 0) {\n            return;\n        }\n        this._initMap();\n\n        if (this.options.transform) {\n            this.transform(null);\n        }\n\n        var options = this.options;\n        var rect = this._rect;\n        var ref = this._initGroups();\n        var groups = ref.groups;\n        var groupsSize = ref.groupsSize;\n        var ref$1 = this._fieldMap;\n        var sizeField = ref$1.sizeField;\n        var groupsSizeField = ref$1.groupsSizeField;\n        var groupAxis = ref$1.groupAxis;\n        var groupsAxis = ref$1.groupsAxis;\n        var groupOrigin = new Point();\n        var elementOrigin = new Point();\n        var size = new Size();\n        var groupStart = alignStart(groupsSize, rect, options.alignContent, groupsAxis, groupsSizeField);\n        var elementStart, group, groupBox;\n\n        var arrangeElements = function (bbox, idx) {\n            var element = group.elements[idx];\n\n            elementOrigin[groupAxis] = elementStart;\n            elementOrigin[groupsAxis] = alignStart(bbox.size[groupsSizeField], groupBox, options.alignItems, groupsAxis, groupsSizeField);\n            translateToPoint(elementOrigin, bbox, element);\n            elementStart += bbox.size[sizeField] + options.spacing;\n        };\n\n        for (var groupIdx = 0; groupIdx < groups.length; groupIdx++) {\n            group = groups[groupIdx];\n            groupOrigin[groupAxis] = elementStart = this$1.justifyAlign(group.size, rect, options.justifyContent, groupAxis, sizeField);\n            groupOrigin[groupsAxis] = groupStart;\n            size[sizeField] = group.size;\n            size[groupsSizeField] = group.lineSize;\n            groupBox = new Rect(groupOrigin, size);\n            this$1.forEach(group.bboxes, arrangeElements);\n\n            groupStart += group.lineSize + options.lineSpacing;\n        }\n\n        if (!options.wrap && group.size > rect.size[sizeField]) {\n            var scale = rect.size[sizeField] / groupBox.size[sizeField];\n            var scaledStart = groupBox.topLeft().scale(scale, scale);\n            var scaledSize = groupBox.size[groupsSizeField] * scale;\n            var newStart = alignStart(scaledSize, rect, options.alignContent, groupsAxis, groupsSizeField);\n            var transform = createTransform();\n            if (groupAxis === \"x\") {\n                transform.translate(rect.origin.x - scaledStart.x, newStart - scaledStart.y);\n            } else {\n                transform.translate(newStart - scaledStart.x, rect.origin.y - scaledStart.y);\n            }\n            transform.scale(scale, scale);\n\n            this.transform(transform);\n        }\n    };\n\n    Layout.prototype._initGroups = function _initGroups () {\n        var this$1 = this;\n\n        var ref = this;\n        var options = ref.options;\n        var children = ref.children;\n        var lineSpacing = options.lineSpacing;\n        var wrap = options.wrap;\n        var spacing = options.spacing;\n        var sizeField = this._fieldMap.sizeField;\n        var group = this._newGroup();\n        var groups = [];\n        var addGroup = function() {\n            groups.push(group);\n            groupsSize += group.lineSize + lineSpacing;\n        };\n        var groupsSize = -lineSpacing;\n\n        for (var idx = 0; idx < children.length; idx++) {\n            var element = children[idx];\n            var bbox = children[idx].clippedBBox();\n            if (element.visible() && bbox) {\n                if (wrap && group.size + bbox.size[sizeField] + spacing > this$1._rect.size[sizeField]) {\n                    if (group.bboxes.length === 0) {\n                        this$1._addToGroup(group, bbox, element);\n                        addGroup();\n                        group = this$1._newGroup();\n                    } else {\n                        addGroup();\n                        group = this$1._newGroup();\n                        this$1._addToGroup(group, bbox, element);\n                    }\n                } else {\n                    this$1._addToGroup(group, bbox, element);\n                }\n            }\n        }\n\n        if (group.bboxes.length) {\n            addGroup();\n        }\n\n        return {\n            groups: groups,\n            groupsSize: groupsSize\n        };\n    };\n\n    Layout.prototype._addToGroup = function _addToGroup (group, bbox, element) {\n        group.size += bbox.size[this._fieldMap.sizeField] + this.options.spacing;\n        group.lineSize = Math.max(bbox.size[this._fieldMap.groupsSizeField], group.lineSize);\n        group.bboxes.push(bbox);\n        group.elements.push(element);\n    };\n\n    Layout.prototype._newGroup = function _newGroup () {\n        return {\n            lineSize: 0,\n            size: -this.options.spacing,\n            bboxes: [],\n            elements: []\n        };\n    };\n\n    return Layout;\n}(Group));\n\nexport default Layout;"]},"metadata":{},"sourceType":"module"}